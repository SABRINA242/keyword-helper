(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var fn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _f(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Nf={exports:{}},hs={},If={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $o=Symbol.for("react.element"),Jm=Symbol.for("react.portal"),Xm=Symbol.for("react.fragment"),Zm=Symbol.for("react.strict_mode"),Qm=Symbol.for("react.profiler"),eg=Symbol.for("react.provider"),tg=Symbol.for("react.context"),ng=Symbol.for("react.forward_ref"),rg=Symbol.for("react.suspense"),og=Symbol.for("react.memo"),ig=Symbol.for("react.lazy"),Lu=Symbol.iterator;function sg(t){return t===null||typeof t!="object"?null:(t=Lu&&t[Lu]||t["@@iterator"],typeof t=="function"?t:null)}var bf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Af=Object.assign,Rf={};function Wr(t,e,n){this.props=t,this.context=e,this.refs=Rf,this.updater=n||bf}Wr.prototype.isReactComponent={};Wr.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function kf(){}kf.prototype=Wr.prototype;function wl(t,e,n){this.props=t,this.context=e,this.refs=Rf,this.updater=n||bf}var Cl=wl.prototype=new kf;Cl.constructor=wl;Af(Cl,Wr.prototype);Cl.isPureReactComponent=!0;var Du=Array.isArray,Pf=Object.prototype.hasOwnProperty,_l={current:null},Mf={key:!0,ref:!0,__self:!0,__source:!0};function Lf(t,e,n){var r,o={},i=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(i=""+e.key),e)Pf.call(e,r)&&!Mf.hasOwnProperty(r)&&(o[r]=e[r]);var a=arguments.length-2;if(a===1)o.children=n;else if(1<a){for(var u=Array(a),c=0;c<a;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)o[r]===void 0&&(o[r]=a[r]);return{$$typeof:$o,type:t,key:i,ref:s,props:o,_owner:_l.current}}function ag(t,e){return{$$typeof:$o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Nl(t){return typeof t=="object"&&t!==null&&t.$$typeof===$o}function lg(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ou=/\/+/g;function Fs(t,e){return typeof t=="object"&&t!==null&&t.key!=null?lg(""+t.key):e.toString(36)}function Ei(t,e,n,r,o){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case $o:case Jm:s=!0}}if(s)return s=t,o=o(s),t=r===""?"."+Fs(s,0):r,Du(o)?(n="",t!=null&&(n=t.replace(Ou,"$&/")+"/"),Ei(o,e,n,"",function(c){return c})):o!=null&&(Nl(o)&&(o=ag(o,n+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(Ou,"$&/")+"/")+t)),e.push(o)),1;if(s=0,r=r===""?".":r+":",Du(t))for(var a=0;a<t.length;a++){i=t[a];var u=r+Fs(i,a);s+=Ei(i,e,n,u,o)}else if(u=sg(t),typeof u=="function")for(t=u.call(t),a=0;!(i=t.next()).done;)i=i.value,u=r+Fs(i,a++),s+=Ei(i,e,n,u,o);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Jo(t,e,n){if(t==null)return t;var r=[],o=0;return Ei(t,r,"","",function(i){return e.call(n,i,o++)}),r}function ug(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var yt={current:null},Ti={transition:null},cg={ReactCurrentDispatcher:yt,ReactCurrentBatchConfig:Ti,ReactCurrentOwner:_l};function Df(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:Jo,forEach:function(t,e,n){Jo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Jo(t,function(){e++}),e},toArray:function(t){return Jo(t,function(e){return e})||[]},only:function(t){if(!Nl(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ae.Component=Wr;Ae.Fragment=Xm;Ae.Profiler=Qm;Ae.PureComponent=wl;Ae.StrictMode=Zm;Ae.Suspense=rg;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cg;Ae.act=Df;Ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Af({},t.props),o=t.key,i=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,s=_l.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(u in e)Pf.call(e,u)&&!Mf.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var c=0;c<u;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:$o,type:t.type,key:o,ref:i,props:r,_owner:s}};Ae.createContext=function(t){return t={$$typeof:tg,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:eg,_context:t},t.Consumer=t};Ae.createElement=Lf;Ae.createFactory=function(t){var e=Lf.bind(null,t);return e.type=t,e};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(t){return{$$typeof:ng,render:t}};Ae.isValidElement=Nl;Ae.lazy=function(t){return{$$typeof:ig,_payload:{_status:-1,_result:t},_init:ug}};Ae.memo=function(t,e){return{$$typeof:og,type:t,compare:e===void 0?null:e}};Ae.startTransition=function(t){var e=Ti.transition;Ti.transition={};try{t()}finally{Ti.transition=e}};Ae.unstable_act=Df;Ae.useCallback=function(t,e){return yt.current.useCallback(t,e)};Ae.useContext=function(t){return yt.current.useContext(t)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(t){return yt.current.useDeferredValue(t)};Ae.useEffect=function(t,e){return yt.current.useEffect(t,e)};Ae.useId=function(){return yt.current.useId()};Ae.useImperativeHandle=function(t,e,n){return yt.current.useImperativeHandle(t,e,n)};Ae.useInsertionEffect=function(t,e){return yt.current.useInsertionEffect(t,e)};Ae.useLayoutEffect=function(t,e){return yt.current.useLayoutEffect(t,e)};Ae.useMemo=function(t,e){return yt.current.useMemo(t,e)};Ae.useReducer=function(t,e,n){return yt.current.useReducer(t,e,n)};Ae.useRef=function(t){return yt.current.useRef(t)};Ae.useState=function(t){return yt.current.useState(t)};Ae.useSyncExternalStore=function(t,e,n){return yt.current.useSyncExternalStore(t,e,n)};Ae.useTransition=function(){return yt.current.useTransition()};Ae.version="18.3.1";If.exports=Ae;var ne=If.exports;const Of=_f(ne);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dg=ne,fg=Symbol.for("react.element"),hg=Symbol.for("react.fragment"),pg=Object.prototype.hasOwnProperty,mg=dg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gg={key:!0,ref:!0,__self:!0,__source:!0};function Uf(t,e,n){var r,o={},i=null,s=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)pg.call(e,r)&&!gg.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:fg,type:t,key:i,ref:s,props:o,_owner:mg.current}}hs.Fragment=hg;hs.jsx=Uf;hs.jsxs=Uf;Nf.exports=hs;var h=Nf.exports,ma={},Ff={exports:{}},kt={},Gf={exports:{}},Bf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Y,L){var Z=Y.length;Y.push(L);e:for(;0<Z;){var G=Z-1>>>1,B=Y[G];if(0<o(B,L))Y[G]=L,Y[Z]=B,Z=G;else break e}}function n(Y){return Y.length===0?null:Y[0]}function r(Y){if(Y.length===0)return null;var L=Y[0],Z=Y.pop();if(Z!==L){Y[0]=Z;e:for(var G=0,B=Y.length,me=B>>>1;G<me;){var de=2*(G+1)-1,re=Y[de],_e=de+1,Ie=Y[_e];if(0>o(re,Z))_e<B&&0>o(Ie,re)?(Y[G]=Ie,Y[_e]=Z,G=_e):(Y[G]=re,Y[de]=Z,G=de);else if(_e<B&&0>o(Ie,Z))Y[G]=Ie,Y[_e]=Z,G=_e;else break e}}return L}function o(Y,L){var Z=Y.sortIndex-L.sortIndex;return Z!==0?Z:Y.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,a=s.now();t.unstable_now=function(){return s.now()-a}}var u=[],c=[],f=1,m=null,p=3,g=!1,E=!1,v=!1,T=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Y){for(var L=n(c);L!==null;){if(L.callback===null)r(c);else if(L.startTime<=Y)r(c),L.sortIndex=L.expirationTime,e(u,L);else break;L=n(c)}}function _(Y){if(v=!1,w(Y),!E)if(n(u)!==null)E=!0,ue(b);else{var L=n(c);L!==null&&$(_,L.startTime-Y)}}function b(Y,L){E=!1,v&&(v=!1,y(F),F=-1),g=!0;var Z=p;try{for(w(L),m=n(u);m!==null&&(!(m.expirationTime>L)||Y&&!K());){var G=m.callback;if(typeof G=="function"){m.callback=null,p=m.priorityLevel;var B=G(m.expirationTime<=L);L=t.unstable_now(),typeof B=="function"?m.callback=B:m===n(u)&&r(u),w(L)}else r(u);m=n(u)}if(m!==null)var me=!0;else{var de=n(c);de!==null&&$(_,de.startTime-L),me=!1}return me}finally{m=null,p=Z,g=!1}}var M=!1,R=null,F=-1,D=5,V=-1;function K(){return!(t.unstable_now()-V<D)}function A(){if(R!==null){var Y=t.unstable_now();V=Y;var L=!0;try{L=R(!0,Y)}finally{L?z():(M=!1,R=null)}}else M=!1}var z;if(typeof x=="function")z=function(){x(A)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,q=C.port2;C.port1.onmessage=A,z=function(){q.postMessage(null)}}else z=function(){T(A,0)};function ue(Y){R=Y,M||(M=!0,z())}function $(Y,L){F=T(function(){Y(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_continueExecution=function(){E||g||(E=!0,ue(b))},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Y){switch(p){case 1:case 2:case 3:var L=3;break;default:L=p}var Z=p;p=L;try{return Y()}finally{p=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Y,L){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Z=p;p=Y;try{return L()}finally{p=Z}},t.unstable_scheduleCallback=function(Y,L,Z){var G=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?G+Z:G):Z=G,Y){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Z+B,Y={id:f++,callback:L,priorityLevel:Y,startTime:Z,expirationTime:B,sortIndex:-1},Z>G?(Y.sortIndex=Z,e(c,Y),n(u)===null&&Y===n(c)&&(v?(y(F),F=-1):v=!0,$(_,Z-G))):(Y.sortIndex=B,e(u,Y),E||g||(E=!0,ue(b))),Y},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(Y){var L=p;return function(){var Z=p;p=L;try{return Y.apply(this,arguments)}finally{p=Z}}}})(Bf);Gf.exports=Bf;var yg=Gf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vg=ne,Rt=yg;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hf=new Set,Io={};function lr(t,e){Gr(t,e),Gr(t+"Capture",e)}function Gr(t,e){for(Io[t]=e,t=0;t<e.length;t++)Hf.add(e[t])}var gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ga=Object.prototype.hasOwnProperty,xg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Uu={},Fu={};function Sg(t){return ga.call(Fu,t)?!0:ga.call(Uu,t)?!1:xg.test(t)?Fu[t]=!0:(Uu[t]=!0,!1)}function Eg(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Tg(t,e,n,r){if(e===null||typeof e>"u"||Eg(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function vt(t,e,n,r,o,i,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=s}var it={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){it[t]=new vt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];it[e]=new vt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){it[t]=new vt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){it[t]=new vt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){it[t]=new vt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){it[t]=new vt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){it[t]=new vt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){it[t]=new vt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){it[t]=new vt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Il=/[\-:]([a-z])/g;function bl(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Il,bl);it[e]=new vt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Il,bl);it[e]=new vt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Il,bl);it[e]=new vt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){it[t]=new vt(t,1,!1,t.toLowerCase(),null,!1,!1)});it.xlinkHref=new vt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){it[t]=new vt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Al(t,e,n,r){var o=it.hasOwnProperty(e)?it[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Tg(e,n,o,r)&&(n=null),r||o===null?Sg(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var En=vg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xo=Symbol.for("react.element"),mr=Symbol.for("react.portal"),gr=Symbol.for("react.fragment"),Rl=Symbol.for("react.strict_mode"),ya=Symbol.for("react.profiler"),Vf=Symbol.for("react.provider"),zf=Symbol.for("react.context"),kl=Symbol.for("react.forward_ref"),va=Symbol.for("react.suspense"),xa=Symbol.for("react.suspense_list"),Pl=Symbol.for("react.memo"),_n=Symbol.for("react.lazy"),$f=Symbol.for("react.offscreen"),Gu=Symbol.iterator;function eo(t){return t===null||typeof t!="object"?null:(t=Gu&&t[Gu]||t["@@iterator"],typeof t=="function"?t:null)}var je=Object.assign,Gs;function co(t){if(Gs===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Gs=e&&e[1]||""}return`
`+Gs+t}var Bs=!1;function Hs(t,e){if(!t||Bs)return"";Bs=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),i=r.stack.split(`
`),s=o.length-1,a=i.length-1;1<=s&&0<=a&&o[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==i[a]){if(s!==1||a!==1)do if(s--,a--,0>a||o[s]!==i[a]){var u=`
`+o[s].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=s&&0<=a);break}}}finally{Bs=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?co(t):""}function wg(t){switch(t.tag){case 5:return co(t.type);case 16:return co("Lazy");case 13:return co("Suspense");case 19:return co("SuspenseList");case 0:case 2:case 15:return t=Hs(t.type,!1),t;case 11:return t=Hs(t.type.render,!1),t;case 1:return t=Hs(t.type,!0),t;default:return""}}function Sa(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case gr:return"Fragment";case mr:return"Portal";case ya:return"Profiler";case Rl:return"StrictMode";case va:return"Suspense";case xa:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case zf:return(t.displayName||"Context")+".Consumer";case Vf:return(t._context.displayName||"Context")+".Provider";case kl:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Pl:return e=t.displayName||null,e!==null?e:Sa(t.type)||"Memo";case _n:e=t._payload,t=t._init;try{return Sa(t(e))}catch{}}return null}function Cg(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sa(e);case 8:return e===Rl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Bn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function jf(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _g(t){var e=jf(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(s){r=""+s,i.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zo(t){t._valueTracker||(t._valueTracker=_g(t))}function Wf(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=jf(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Oi(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ea(t,e){var n=e.checked;return je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Bu(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Bn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qf(t,e){e=e.checked,e!=null&&Al(t,"checked",e,!1)}function Ta(t,e){qf(t,e);var n=Bn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?wa(t,e.type,n):e.hasOwnProperty("defaultValue")&&wa(t,e.type,Bn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Hu(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function wa(t,e,n){(e!=="number"||Oi(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var fo=Array.isArray;function kr(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Bn(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function Ca(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Vu(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ae(92));if(fo(n)){if(1<n.length)throw Error(ae(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Bn(n)}}function Yf(t,e){var n=Bn(e.value),r=Bn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function zu(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Kf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _a(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Kf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qo,Jf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qo=Qo||document.createElement("div"),Qo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ng=["Webkit","ms","Moz","O"];Object.keys(vo).forEach(function(t){Ng.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vo[e]=vo[t]})});function Xf(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vo.hasOwnProperty(t)&&vo[t]?(""+e).trim():e+"px"}function Zf(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=Xf(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var Ig=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Na(t,e){if(e){if(Ig[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function Ia(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ba=null;function Ml(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Aa=null,Pr=null,Mr=null;function $u(t){if(t=qo(t)){if(typeof Aa!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=vs(e),Aa(t.stateNode,t.type,e))}}function Qf(t){Pr?Mr?Mr.push(t):Mr=[t]:Pr=t}function eh(){if(Pr){var t=Pr,e=Mr;if(Mr=Pr=null,$u(t),e)for(t=0;t<e.length;t++)$u(e[t])}}function th(t,e){return t(e)}function nh(){}var Vs=!1;function rh(t,e,n){if(Vs)return t(e,n);Vs=!0;try{return th(t,e,n)}finally{Vs=!1,(Pr!==null||Mr!==null)&&(nh(),eh())}}function Ao(t,e){var n=t.stateNode;if(n===null)return null;var r=vs(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ae(231,e,typeof n));return n}var Ra=!1;if(gn)try{var to={};Object.defineProperty(to,"passive",{get:function(){Ra=!0}}),window.addEventListener("test",to,to),window.removeEventListener("test",to,to)}catch{Ra=!1}function bg(t,e,n,r,o,i,s,a,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(f){this.onError(f)}}var xo=!1,Ui=null,Fi=!1,ka=null,Ag={onError:function(t){xo=!0,Ui=t}};function Rg(t,e,n,r,o,i,s,a,u){xo=!1,Ui=null,bg.apply(Ag,arguments)}function kg(t,e,n,r,o,i,s,a,u){if(Rg.apply(this,arguments),xo){if(xo){var c=Ui;xo=!1,Ui=null}else throw Error(ae(198));Fi||(Fi=!0,ka=c)}}function ur(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function oh(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ju(t){if(ur(t)!==t)throw Error(ae(188))}function Pg(t){var e=t.alternate;if(!e){if(e=ur(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return ju(o),t;if(i===r)return ju(o),e;i=i.sibling}throw Error(ae(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,a=o.child;a;){if(a===n){s=!0,n=o,r=i;break}if(a===r){s=!0,r=o,n=i;break}a=a.sibling}if(!s){for(a=i.child;a;){if(a===n){s=!0,n=i,r=o;break}if(a===r){s=!0,r=i,n=o;break}a=a.sibling}if(!s)throw Error(ae(189))}}if(n.alternate!==r)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?t:e}function ih(t){return t=Pg(t),t!==null?sh(t):null}function sh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=sh(t);if(e!==null)return e;t=t.sibling}return null}var ah=Rt.unstable_scheduleCallback,Wu=Rt.unstable_cancelCallback,Mg=Rt.unstable_shouldYield,Lg=Rt.unstable_requestPaint,qe=Rt.unstable_now,Dg=Rt.unstable_getCurrentPriorityLevel,Ll=Rt.unstable_ImmediatePriority,lh=Rt.unstable_UserBlockingPriority,Gi=Rt.unstable_NormalPriority,Og=Rt.unstable_LowPriority,uh=Rt.unstable_IdlePriority,ps=null,an=null;function Ug(t){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(ps,t,void 0,(t.current.flags&128)===128)}catch{}}var Yt=Math.clz32?Math.clz32:Bg,Fg=Math.log,Gg=Math.LN2;function Bg(t){return t>>>=0,t===0?32:31-(Fg(t)/Gg|0)|0}var ei=64,ti=4194304;function ho(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bi(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,i=t.pingedLanes,s=n&268435455;if(s!==0){var a=s&~o;a!==0?r=ho(a):(i&=s,i!==0&&(r=ho(i)))}else s=n&~o,s!==0?r=ho(s):i!==0&&(r=ho(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yt(e),o=1<<n,r|=t[n],e&=~o;return r}function Hg(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vg(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,i=t.pendingLanes;0<i;){var s=31-Yt(i),a=1<<s,u=o[s];u===-1?(!(a&n)||a&r)&&(o[s]=Hg(a,e)):u<=e&&(t.expiredLanes|=a),i&=~a}}function Pa(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ch(){var t=ei;return ei<<=1,!(ei&4194240)&&(ei=64),t}function zs(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function jo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yt(e),t[e]=n}function zg(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-Yt(n),i=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~i}}function Dl(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yt(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var De=0;function dh(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var fh,Ol,hh,ph,mh,Ma=!1,ni=[],Pn=null,Mn=null,Ln=null,Ro=new Map,ko=new Map,In=[],$g="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qu(t,e){switch(t){case"focusin":case"focusout":Pn=null;break;case"dragenter":case"dragleave":Mn=null;break;case"mouseover":case"mouseout":Ln=null;break;case"pointerover":case"pointerout":Ro.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ko.delete(e.pointerId)}}function no(t,e,n,r,o,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=qo(e),e!==null&&Ol(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function jg(t,e,n,r,o){switch(e){case"focusin":return Pn=no(Pn,t,e,n,r,o),!0;case"dragenter":return Mn=no(Mn,t,e,n,r,o),!0;case"mouseover":return Ln=no(Ln,t,e,n,r,o),!0;case"pointerover":var i=o.pointerId;return Ro.set(i,no(Ro.get(i)||null,t,e,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,ko.set(i,no(ko.get(i)||null,t,e,n,r,o)),!0}return!1}function gh(t){var e=Zn(t.target);if(e!==null){var n=ur(e);if(n!==null){if(e=n.tag,e===13){if(e=oh(n),e!==null){t.blockedOn=e,mh(t.priority,function(){hh(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wi(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=La(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ba=r,n.target.dispatchEvent(r),ba=null}else return e=qo(n),e!==null&&Ol(e),t.blockedOn=n,!1;e.shift()}return!0}function Yu(t,e,n){wi(t)&&n.delete(e)}function Wg(){Ma=!1,Pn!==null&&wi(Pn)&&(Pn=null),Mn!==null&&wi(Mn)&&(Mn=null),Ln!==null&&wi(Ln)&&(Ln=null),Ro.forEach(Yu),ko.forEach(Yu)}function ro(t,e){t.blockedOn===e&&(t.blockedOn=null,Ma||(Ma=!0,Rt.unstable_scheduleCallback(Rt.unstable_NormalPriority,Wg)))}function Po(t){function e(o){return ro(o,t)}if(0<ni.length){ro(ni[0],t);for(var n=1;n<ni.length;n++){var r=ni[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Pn!==null&&ro(Pn,t),Mn!==null&&ro(Mn,t),Ln!==null&&ro(Ln,t),Ro.forEach(e),ko.forEach(e),n=0;n<In.length;n++)r=In[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<In.length&&(n=In[0],n.blockedOn===null);)gh(n),n.blockedOn===null&&In.shift()}var Lr=En.ReactCurrentBatchConfig,Hi=!0;function qg(t,e,n,r){var o=De,i=Lr.transition;Lr.transition=null;try{De=1,Ul(t,e,n,r)}finally{De=o,Lr.transition=i}}function Yg(t,e,n,r){var o=De,i=Lr.transition;Lr.transition=null;try{De=4,Ul(t,e,n,r)}finally{De=o,Lr.transition=i}}function Ul(t,e,n,r){if(Hi){var o=La(t,e,n,r);if(o===null)Qs(t,e,r,Vi,n),qu(t,r);else if(jg(o,t,e,n,r))r.stopPropagation();else if(qu(t,r),e&4&&-1<$g.indexOf(t)){for(;o!==null;){var i=qo(o);if(i!==null&&fh(i),i=La(t,e,n,r),i===null&&Qs(t,e,r,Vi,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else Qs(t,e,r,null,n)}}var Vi=null;function La(t,e,n,r){if(Vi=null,t=Ml(r),t=Zn(t),t!==null)if(e=ur(t),e===null)t=null;else if(n=e.tag,n===13){if(t=oh(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Vi=t,null}function yh(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Dg()){case Ll:return 1;case lh:return 4;case Gi:case Og:return 16;case uh:return 536870912;default:return 16}default:return 16}}var An=null,Fl=null,Ci=null;function vh(){if(Ci)return Ci;var t,e=Fl,n=e.length,r,o="value"in An?An.value:An.textContent,i=o.length;for(t=0;t<n&&e[t]===o[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===o[i-r];r++);return Ci=o.slice(t,1<r?1-r:void 0)}function _i(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ri(){return!0}function Ku(){return!1}function Pt(t){function e(n,r,o,i,s){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ri:Ku,this.isPropagationStopped=Ku,this}return je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ri)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ri)},persist:function(){},isPersistent:ri}),e}var qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gl=Pt(qr),Wo=je({},qr,{view:0,detail:0}),Kg=Pt(Wo),$s,js,oo,ms=je({},Wo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==oo&&(oo&&t.type==="mousemove"?($s=t.screenX-oo.screenX,js=t.screenY-oo.screenY):js=$s=0,oo=t),$s)},movementY:function(t){return"movementY"in t?t.movementY:js}}),Ju=Pt(ms),Jg=je({},ms,{dataTransfer:0}),Xg=Pt(Jg),Zg=je({},Wo,{relatedTarget:0}),Ws=Pt(Zg),Qg=je({},qr,{animationName:0,elapsedTime:0,pseudoElement:0}),e0=Pt(Qg),t0=je({},qr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),n0=Pt(t0),r0=je({},qr,{data:0}),Xu=Pt(r0),o0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},s0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function a0(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=s0[t])?!!e[t]:!1}function Bl(){return a0}var l0=je({},Wo,{key:function(t){if(t.key){var e=o0[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=_i(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?i0[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bl,charCode:function(t){return t.type==="keypress"?_i(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?_i(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),u0=Pt(l0),c0=je({},ms,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zu=Pt(c0),d0=je({},Wo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bl}),f0=Pt(d0),h0=je({},qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),p0=Pt(h0),m0=je({},ms,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),g0=Pt(m0),y0=[9,13,27,32],Hl=gn&&"CompositionEvent"in window,So=null;gn&&"documentMode"in document&&(So=document.documentMode);var v0=gn&&"TextEvent"in window&&!So,xh=gn&&(!Hl||So&&8<So&&11>=So),Qu=" ",ec=!1;function Sh(t,e){switch(t){case"keyup":return y0.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Eh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var yr=!1;function x0(t,e){switch(t){case"compositionend":return Eh(e);case"keypress":return e.which!==32?null:(ec=!0,Qu);case"textInput":return t=e.data,t===Qu&&ec?null:t;default:return null}}function S0(t,e){if(yr)return t==="compositionend"||!Hl&&Sh(t,e)?(t=vh(),Ci=Fl=An=null,yr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return xh&&e.locale!=="ko"?null:e.data;default:return null}}var E0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!E0[t.type]:e==="textarea"}function Th(t,e,n,r){Qf(r),e=zi(e,"onChange"),0<e.length&&(n=new Gl("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Eo=null,Mo=null;function T0(t){Mh(t,0)}function gs(t){var e=Sr(t);if(Wf(e))return t}function w0(t,e){if(t==="change")return e}var wh=!1;if(gn){var qs;if(gn){var Ys="oninput"in document;if(!Ys){var nc=document.createElement("div");nc.setAttribute("oninput","return;"),Ys=typeof nc.oninput=="function"}qs=Ys}else qs=!1;wh=qs&&(!document.documentMode||9<document.documentMode)}function rc(){Eo&&(Eo.detachEvent("onpropertychange",Ch),Mo=Eo=null)}function Ch(t){if(t.propertyName==="value"&&gs(Mo)){var e=[];Th(e,Mo,t,Ml(t)),rh(T0,e)}}function C0(t,e,n){t==="focusin"?(rc(),Eo=e,Mo=n,Eo.attachEvent("onpropertychange",Ch)):t==="focusout"&&rc()}function _0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return gs(Mo)}function N0(t,e){if(t==="click")return gs(e)}function I0(t,e){if(t==="input"||t==="change")return gs(e)}function b0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zt=typeof Object.is=="function"?Object.is:b0;function Lo(t,e){if(Zt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!ga.call(e,o)||!Zt(t[o],e[o]))return!1}return!0}function oc(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ic(t,e){var n=oc(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=oc(n)}}function _h(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?_h(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Nh(){for(var t=window,e=Oi();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Oi(t.document)}return e}function Vl(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function A0(t){var e=Nh(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&_h(n.ownerDocument.documentElement,n)){if(r!==null&&Vl(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!t.extend&&i>r&&(o=r,r=i,i=o),o=ic(n,i);var s=ic(n,r);o&&s&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var R0=gn&&"documentMode"in document&&11>=document.documentMode,vr=null,Da=null,To=null,Oa=!1;function sc(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Oa||vr==null||vr!==Oi(r)||(r=vr,"selectionStart"in r&&Vl(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),To&&Lo(To,r)||(To=r,r=zi(Da,"onSelect"),0<r.length&&(e=new Gl("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=vr)))}function oi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xr={animationend:oi("Animation","AnimationEnd"),animationiteration:oi("Animation","AnimationIteration"),animationstart:oi("Animation","AnimationStart"),transitionend:oi("Transition","TransitionEnd")},Ks={},Ih={};gn&&(Ih=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);function ys(t){if(Ks[t])return Ks[t];if(!xr[t])return t;var e=xr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ih)return Ks[t]=e[n];return t}var bh=ys("animationend"),Ah=ys("animationiteration"),Rh=ys("animationstart"),kh=ys("transitionend"),Ph=new Map,ac="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(t,e){Ph.set(t,e),lr(e,[t])}for(var Js=0;Js<ac.length;Js++){var Xs=ac[Js],k0=Xs.toLowerCase(),P0=Xs[0].toUpperCase()+Xs.slice(1);zn(k0,"on"+P0)}zn(bh,"onAnimationEnd");zn(Ah,"onAnimationIteration");zn(Rh,"onAnimationStart");zn("dblclick","onDoubleClick");zn("focusin","onFocus");zn("focusout","onBlur");zn(kh,"onTransitionEnd");Gr("onMouseEnter",["mouseout","mouseover"]);Gr("onMouseLeave",["mouseout","mouseover"]);Gr("onPointerEnter",["pointerout","pointerover"]);Gr("onPointerLeave",["pointerout","pointerover"]);lr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));lr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));lr("onBeforeInput",["compositionend","keypress","textInput","paste"]);lr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));lr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));lr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M0=new Set("cancel close invalid load scroll toggle".split(" ").concat(po));function lc(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,kg(r,e,void 0,t),t.currentTarget=null}function Mh(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],u=a.instance,c=a.currentTarget;if(a=a.listener,u!==i&&o.isPropagationStopped())break e;lc(o,a,c),i=u}else for(s=0;s<r.length;s++){if(a=r[s],u=a.instance,c=a.currentTarget,a=a.listener,u!==i&&o.isPropagationStopped())break e;lc(o,a,c),i=u}}}if(Fi)throw t=ka,Fi=!1,ka=null,t}function Fe(t,e){var n=e[Ha];n===void 0&&(n=e[Ha]=new Set);var r=t+"__bubble";n.has(r)||(Lh(e,t,2,!1),n.add(r))}function Zs(t,e,n){var r=0;e&&(r|=4),Lh(n,t,r,e)}var ii="_reactListening"+Math.random().toString(36).slice(2);function Do(t){if(!t[ii]){t[ii]=!0,Hf.forEach(function(n){n!=="selectionchange"&&(M0.has(n)||Zs(n,!1,t),Zs(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ii]||(e[ii]=!0,Zs("selectionchange",!1,e))}}function Lh(t,e,n,r){switch(yh(e)){case 1:var o=qg;break;case 4:o=Yg;break;default:o=Ul}n=o.bind(null,e,n,t),o=void 0,!Ra||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function Qs(t,e,n,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===o||a.nodeType===8&&a.parentNode===o)break;if(s===4)for(s=r.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;s=s.return}for(;a!==null;){if(s=Zn(a),s===null)return;if(u=s.tag,u===5||u===6){r=i=s;continue e}a=a.parentNode}}r=r.return}rh(function(){var c=i,f=Ml(n),m=[];e:{var p=Ph.get(t);if(p!==void 0){var g=Gl,E=t;switch(t){case"keypress":if(_i(n)===0)break e;case"keydown":case"keyup":g=u0;break;case"focusin":E="focus",g=Ws;break;case"focusout":E="blur",g=Ws;break;case"beforeblur":case"afterblur":g=Ws;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Ju;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Xg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=f0;break;case bh:case Ah:case Rh:g=e0;break;case kh:g=p0;break;case"scroll":g=Kg;break;case"wheel":g=g0;break;case"copy":case"cut":case"paste":g=n0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Zu}var v=(e&4)!==0,T=!v&&t==="scroll",y=v?p!==null?p+"Capture":null:p;v=[];for(var x=c,w;x!==null;){w=x;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,y!==null&&(_=Ao(x,y),_!=null&&v.push(Oo(x,_,w)))),T)break;x=x.return}0<v.length&&(p=new g(p,E,null,n,f),m.push({event:p,listeners:v}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==ba&&(E=n.relatedTarget||n.fromElement)&&(Zn(E)||E[yn]))break e;if((g||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,g?(E=n.relatedTarget||n.toElement,g=c,E=E?Zn(E):null,E!==null&&(T=ur(E),E!==T||E.tag!==5&&E.tag!==6)&&(E=null)):(g=null,E=c),g!==E)){if(v=Ju,_="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(v=Zu,_="onPointerLeave",y="onPointerEnter",x="pointer"),T=g==null?p:Sr(g),w=E==null?p:Sr(E),p=new v(_,x+"leave",g,n,f),p.target=T,p.relatedTarget=w,_=null,Zn(f)===c&&(v=new v(y,x+"enter",E,n,f),v.target=w,v.relatedTarget=T,_=v),T=_,g&&E)t:{for(v=g,y=E,x=0,w=v;w;w=hr(w))x++;for(w=0,_=y;_;_=hr(_))w++;for(;0<x-w;)v=hr(v),x--;for(;0<w-x;)y=hr(y),w--;for(;x--;){if(v===y||y!==null&&v===y.alternate)break t;v=hr(v),y=hr(y)}v=null}else v=null;g!==null&&uc(m,p,g,v,!1),E!==null&&T!==null&&uc(m,T,E,v,!0)}}e:{if(p=c?Sr(c):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var b=w0;else if(tc(p))if(wh)b=I0;else{b=_0;var M=C0}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(b=N0);if(b&&(b=b(t,c))){Th(m,b,n,f);break e}M&&M(t,p,c),t==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&wa(p,"number",p.value)}switch(M=c?Sr(c):window,t){case"focusin":(tc(M)||M.contentEditable==="true")&&(vr=M,Da=c,To=null);break;case"focusout":To=Da=vr=null;break;case"mousedown":Oa=!0;break;case"contextmenu":case"mouseup":case"dragend":Oa=!1,sc(m,n,f);break;case"selectionchange":if(R0)break;case"keydown":case"keyup":sc(m,n,f)}var R;if(Hl)e:{switch(t){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else yr?Sh(t,n)&&(F="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(F="onCompositionStart");F&&(xh&&n.locale!=="ko"&&(yr||F!=="onCompositionStart"?F==="onCompositionEnd"&&yr&&(R=vh()):(An=f,Fl="value"in An?An.value:An.textContent,yr=!0)),M=zi(c,F),0<M.length&&(F=new Xu(F,t,null,n,f),m.push({event:F,listeners:M}),R?F.data=R:(R=Eh(n),R!==null&&(F.data=R)))),(R=v0?x0(t,n):S0(t,n))&&(c=zi(c,"onBeforeInput"),0<c.length&&(f=new Xu("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:c}),f.data=R))}Mh(m,e)})}function Oo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function zi(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=Ao(t,n),i!=null&&r.unshift(Oo(t,i,o)),i=Ao(t,e),i!=null&&r.push(Oo(t,i,o))),t=t.return}return r}function hr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function uc(t,e,n,r,o){for(var i=e._reactName,s=[];n!==null&&n!==r;){var a=n,u=a.alternate,c=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&c!==null&&(a=c,o?(u=Ao(n,i),u!=null&&s.unshift(Oo(n,u,a))):o||(u=Ao(n,i),u!=null&&s.push(Oo(n,u,a)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var L0=/\r\n?/g,D0=/\u0000|\uFFFD/g;function cc(t){return(typeof t=="string"?t:""+t).replace(L0,`
`).replace(D0,"")}function si(t,e,n){if(e=cc(e),cc(t)!==e&&n)throw Error(ae(425))}function $i(){}var Ua=null,Fa=null;function Ga(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ba=typeof setTimeout=="function"?setTimeout:void 0,O0=typeof clearTimeout=="function"?clearTimeout:void 0,dc=typeof Promise=="function"?Promise:void 0,U0=typeof queueMicrotask=="function"?queueMicrotask:typeof dc<"u"?function(t){return dc.resolve(null).then(t).catch(F0)}:Ba;function F0(t){setTimeout(function(){throw t})}function ea(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),Po(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Po(e)}function Dn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function fc(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Yr=Math.random().toString(36).slice(2),sn="__reactFiber$"+Yr,Uo="__reactProps$"+Yr,yn="__reactContainer$"+Yr,Ha="__reactEvents$"+Yr,G0="__reactListeners$"+Yr,B0="__reactHandles$"+Yr;function Zn(t){var e=t[sn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[yn]||n[sn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=fc(t);t!==null;){if(n=t[sn])return n;t=fc(t)}return e}t=n,n=t.parentNode}return null}function qo(t){return t=t[sn]||t[yn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Sr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function vs(t){return t[Uo]||null}var Va=[],Er=-1;function $n(t){return{current:t}}function Ge(t){0>Er||(t.current=Va[Er],Va[Er]=null,Er--)}function Ue(t,e){Er++,Va[Er]=t.current,t.current=e}var Hn={},dt=$n(Hn),wt=$n(!1),rr=Hn;function Br(t,e){var n=t.type.contextTypes;if(!n)return Hn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Ct(t){return t=t.childContextTypes,t!=null}function ji(){Ge(wt),Ge(dt)}function hc(t,e,n){if(dt.current!==Hn)throw Error(ae(168));Ue(dt,e),Ue(wt,n)}function Dh(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(ae(108,Cg(t)||"Unknown",o));return je({},n,r)}function Wi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Hn,rr=dt.current,Ue(dt,t),Ue(wt,wt.current),!0}function pc(t,e,n){var r=t.stateNode;if(!r)throw Error(ae(169));n?(t=Dh(t,e,rr),r.__reactInternalMemoizedMergedChildContext=t,Ge(wt),Ge(dt),Ue(dt,t)):Ge(wt),Ue(wt,n)}var dn=null,xs=!1,ta=!1;function Oh(t){dn===null?dn=[t]:dn.push(t)}function H0(t){xs=!0,Oh(t)}function jn(){if(!ta&&dn!==null){ta=!0;var t=0,e=De;try{var n=dn;for(De=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}dn=null,xs=!1}catch(o){throw dn!==null&&(dn=dn.slice(t+1)),ah(Ll,jn),o}finally{De=e,ta=!1}}return null}var Tr=[],wr=0,qi=null,Yi=0,Dt=[],Ot=0,or=null,hn=1,pn="";function Kn(t,e){Tr[wr++]=Yi,Tr[wr++]=qi,qi=t,Yi=e}function Uh(t,e,n){Dt[Ot++]=hn,Dt[Ot++]=pn,Dt[Ot++]=or,or=t;var r=hn;t=pn;var o=32-Yt(r)-1;r&=~(1<<o),n+=1;var i=32-Yt(e)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,hn=1<<32-Yt(e)+o|n<<o|r,pn=i+t}else hn=1<<i|n<<o|r,pn=t}function zl(t){t.return!==null&&(Kn(t,1),Uh(t,1,0))}function $l(t){for(;t===qi;)qi=Tr[--wr],Tr[wr]=null,Yi=Tr[--wr],Tr[wr]=null;for(;t===or;)or=Dt[--Ot],Dt[Ot]=null,pn=Dt[--Ot],Dt[Ot]=null,hn=Dt[--Ot],Dt[Ot]=null}var At=null,bt=null,He=!1,qt=null;function Fh(t,e){var n=Ut(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function mc(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,At=t,bt=Dn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,At=t,bt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=or!==null?{id:hn,overflow:pn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ut(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,At=t,bt=null,!0):!1;default:return!1}}function za(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $a(t){if(He){var e=bt;if(e){var n=e;if(!mc(t,e)){if(za(t))throw Error(ae(418));e=Dn(n.nextSibling);var r=At;e&&mc(t,e)?Fh(r,n):(t.flags=t.flags&-4097|2,He=!1,At=t)}}else{if(za(t))throw Error(ae(418));t.flags=t.flags&-4097|2,He=!1,At=t}}}function gc(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;At=t}function ai(t){if(t!==At)return!1;if(!He)return gc(t),He=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ga(t.type,t.memoizedProps)),e&&(e=bt)){if(za(t))throw Gh(),Error(ae(418));for(;e;)Fh(t,e),e=Dn(e.nextSibling)}if(gc(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){bt=Dn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}bt=null}}else bt=At?Dn(t.stateNode.nextSibling):null;return!0}function Gh(){for(var t=bt;t;)t=Dn(t.nextSibling)}function Hr(){bt=At=null,He=!1}function jl(t){qt===null?qt=[t]:qt.push(t)}var V0=En.ReactCurrentBatchConfig;function io(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var r=n.stateNode}if(!r)throw Error(ae(147,t));var o=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(s){var a=o.refs;s===null?delete a[i]:a[i]=s},e._stringRef=i,e)}if(typeof t!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,t))}return t}function li(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function yc(t){var e=t._init;return e(t._payload)}function Bh(t){function e(y,x){if(t){var w=y.deletions;w===null?(y.deletions=[x],y.flags|=16):w.push(x)}}function n(y,x){if(!t)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function r(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function o(y,x){return y=Gn(y,x),y.index=0,y.sibling=null,y}function i(y,x,w){return y.index=w,t?(w=y.alternate,w!==null?(w=w.index,w<x?(y.flags|=2,x):w):(y.flags|=2,x)):(y.flags|=1048576,x)}function s(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,x,w,_){return x===null||x.tag!==6?(x=la(w,y.mode,_),x.return=y,x):(x=o(x,w),x.return=y,x)}function u(y,x,w,_){var b=w.type;return b===gr?f(y,x,w.props.children,_,w.key):x!==null&&(x.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===_n&&yc(b)===x.type)?(_=o(x,w.props),_.ref=io(y,x,w),_.return=y,_):(_=Pi(w.type,w.key,w.props,null,y.mode,_),_.ref=io(y,x,w),_.return=y,_)}function c(y,x,w,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=ua(w,y.mode,_),x.return=y,x):(x=o(x,w.children||[]),x.return=y,x)}function f(y,x,w,_,b){return x===null||x.tag!==7?(x=nr(w,y.mode,_,b),x.return=y,x):(x=o(x,w),x.return=y,x)}function m(y,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=la(""+x,y.mode,w),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Xo:return w=Pi(x.type,x.key,x.props,null,y.mode,w),w.ref=io(y,null,x),w.return=y,w;case mr:return x=ua(x,y.mode,w),x.return=y,x;case _n:var _=x._init;return m(y,_(x._payload),w)}if(fo(x)||eo(x))return x=nr(x,y.mode,w,null),x.return=y,x;li(y,x)}return null}function p(y,x,w,_){var b=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:a(y,x,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Xo:return w.key===b?u(y,x,w,_):null;case mr:return w.key===b?c(y,x,w,_):null;case _n:return b=w._init,p(y,x,b(w._payload),_)}if(fo(w)||eo(w))return b!==null?null:f(y,x,w,_,null);li(y,w)}return null}function g(y,x,w,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(w)||null,a(x,y,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Xo:return y=y.get(_.key===null?w:_.key)||null,u(x,y,_,b);case mr:return y=y.get(_.key===null?w:_.key)||null,c(x,y,_,b);case _n:var M=_._init;return g(y,x,w,M(_._payload),b)}if(fo(_)||eo(_))return y=y.get(w)||null,f(x,y,_,b,null);li(x,_)}return null}function E(y,x,w,_){for(var b=null,M=null,R=x,F=x=0,D=null;R!==null&&F<w.length;F++){R.index>F?(D=R,R=null):D=R.sibling;var V=p(y,R,w[F],_);if(V===null){R===null&&(R=D);break}t&&R&&V.alternate===null&&e(y,R),x=i(V,x,F),M===null?b=V:M.sibling=V,M=V,R=D}if(F===w.length)return n(y,R),He&&Kn(y,F),b;if(R===null){for(;F<w.length;F++)R=m(y,w[F],_),R!==null&&(x=i(R,x,F),M===null?b=R:M.sibling=R,M=R);return He&&Kn(y,F),b}for(R=r(y,R);F<w.length;F++)D=g(R,y,F,w[F],_),D!==null&&(t&&D.alternate!==null&&R.delete(D.key===null?F:D.key),x=i(D,x,F),M===null?b=D:M.sibling=D,M=D);return t&&R.forEach(function(K){return e(y,K)}),He&&Kn(y,F),b}function v(y,x,w,_){var b=eo(w);if(typeof b!="function")throw Error(ae(150));if(w=b.call(w),w==null)throw Error(ae(151));for(var M=b=null,R=x,F=x=0,D=null,V=w.next();R!==null&&!V.done;F++,V=w.next()){R.index>F?(D=R,R=null):D=R.sibling;var K=p(y,R,V.value,_);if(K===null){R===null&&(R=D);break}t&&R&&K.alternate===null&&e(y,R),x=i(K,x,F),M===null?b=K:M.sibling=K,M=K,R=D}if(V.done)return n(y,R),He&&Kn(y,F),b;if(R===null){for(;!V.done;F++,V=w.next())V=m(y,V.value,_),V!==null&&(x=i(V,x,F),M===null?b=V:M.sibling=V,M=V);return He&&Kn(y,F),b}for(R=r(y,R);!V.done;F++,V=w.next())V=g(R,y,F,V.value,_),V!==null&&(t&&V.alternate!==null&&R.delete(V.key===null?F:V.key),x=i(V,x,F),M===null?b=V:M.sibling=V,M=V);return t&&R.forEach(function(A){return e(y,A)}),He&&Kn(y,F),b}function T(y,x,w,_){if(typeof w=="object"&&w!==null&&w.type===gr&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Xo:e:{for(var b=w.key,M=x;M!==null;){if(M.key===b){if(b=w.type,b===gr){if(M.tag===7){n(y,M.sibling),x=o(M,w.props.children),x.return=y,y=x;break e}}else if(M.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===_n&&yc(b)===M.type){n(y,M.sibling),x=o(M,w.props),x.ref=io(y,M,w),x.return=y,y=x;break e}n(y,M);break}else e(y,M);M=M.sibling}w.type===gr?(x=nr(w.props.children,y.mode,_,w.key),x.return=y,y=x):(_=Pi(w.type,w.key,w.props,null,y.mode,_),_.ref=io(y,x,w),_.return=y,y=_)}return s(y);case mr:e:{for(M=w.key;x!==null;){if(x.key===M)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(y,x.sibling),x=o(x,w.children||[]),x.return=y,y=x;break e}else{n(y,x);break}else e(y,x);x=x.sibling}x=ua(w,y.mode,_),x.return=y,y=x}return s(y);case _n:return M=w._init,T(y,x,M(w._payload),_)}if(fo(w))return E(y,x,w,_);if(eo(w))return v(y,x,w,_);li(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(y,x.sibling),x=o(x,w),x.return=y,y=x):(n(y,x),x=la(w,y.mode,_),x.return=y,y=x),s(y)):n(y,x)}return T}var Vr=Bh(!0),Hh=Bh(!1),Ki=$n(null),Ji=null,Cr=null,Wl=null;function ql(){Wl=Cr=Ji=null}function Yl(t){var e=Ki.current;Ge(Ki),t._currentValue=e}function ja(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Dr(t,e){Ji=t,Wl=Cr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Tt=!0),t.firstContext=null)}function Bt(t){var e=t._currentValue;if(Wl!==t)if(t={context:t,memoizedValue:e,next:null},Cr===null){if(Ji===null)throw Error(ae(308));Cr=t,Ji.dependencies={lanes:0,firstContext:t}}else Cr=Cr.next=t;return e}var Qn=null;function Kl(t){Qn===null?Qn=[t]:Qn.push(t)}function Vh(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,Kl(e)):(n.next=o.next,o.next=n),e.interleaved=n,vn(t,r)}function vn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Nn=!1;function Jl(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zh(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function On(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,vn(t,n)}return o=r.interleaved,o===null?(e.next=e,Kl(r)):(e.next=o.next,o.next=e),r.interleaved=e,vn(t,n)}function Ni(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Dl(t,n)}}function vc(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=s:i=i.next=s,n=n.next}while(n!==null);i===null?o=i=e:i=i.next=e}else o=i=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Xi(t,e,n,r){var o=t.updateQueue;Nn=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(a!==null){o.shared.pending=null;var u=a,c=u.next;u.next=null,s===null?i=c:s.next=c,s=u;var f=t.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==s&&(a===null?f.firstBaseUpdate=c:a.next=c,f.lastBaseUpdate=u))}if(i!==null){var m=o.baseState;s=0,f=c=u=null,a=i;do{var p=a.lane,g=a.eventTime;if((r&p)===p){f!==null&&(f=f.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,v=a;switch(p=e,g=n,v.tag){case 1:if(E=v.payload,typeof E=="function"){m=E.call(g,m,p);break e}m=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=v.payload,p=typeof E=="function"?E.call(g,m,p):E,p==null)break e;m=je({},m,p);break e;case 2:Nn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=o.effects,p===null?o.effects=[a]:p.push(a))}else g={eventTime:g,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(c=f=g,u=m):f=f.next=g,s|=p;if(a=a.next,a===null){if(a=o.shared.pending,a===null)break;p=a,a=p.next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}while(!0);if(f===null&&(u=m),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=f,e=o.shared.interleaved,e!==null){o=e;do s|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);sr|=s,t.lanes=s,t.memoizedState=m}}function xc(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(ae(191,o));o.call(r)}}}var Yo={},ln=$n(Yo),Fo=$n(Yo),Go=$n(Yo);function er(t){if(t===Yo)throw Error(ae(174));return t}function Xl(t,e){switch(Ue(Go,e),Ue(Fo,t),Ue(ln,Yo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_a(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=_a(e,t)}Ge(ln),Ue(ln,e)}function zr(){Ge(ln),Ge(Fo),Ge(Go)}function $h(t){er(Go.current);var e=er(ln.current),n=_a(e,t.type);e!==n&&(Ue(Fo,t),Ue(ln,n))}function Zl(t){Fo.current===t&&(Ge(ln),Ge(Fo))}var ze=$n(0);function Zi(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var na=[];function Ql(){for(var t=0;t<na.length;t++)na[t]._workInProgressVersionPrimary=null;na.length=0}var Ii=En.ReactCurrentDispatcher,ra=En.ReactCurrentBatchConfig,ir=0,$e=null,Je=null,Qe=null,Qi=!1,wo=!1,Bo=0,z0=0;function at(){throw Error(ae(321))}function eu(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Zt(t[n],e[n]))return!1;return!0}function tu(t,e,n,r,o,i){if(ir=i,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ii.current=t===null||t.memoizedState===null?q0:Y0,t=n(r,o),wo){i=0;do{if(wo=!1,Bo=0,25<=i)throw Error(ae(301));i+=1,Qe=Je=null,e.updateQueue=null,Ii.current=K0,t=n(r,o)}while(wo)}if(Ii.current=es,e=Je!==null&&Je.next!==null,ir=0,Qe=Je=$e=null,Qi=!1,e)throw Error(ae(300));return t}function nu(){var t=Bo!==0;return Bo=0,t}function on(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qe===null?$e.memoizedState=Qe=t:Qe=Qe.next=t,Qe}function Ht(){if(Je===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=Je.next;var e=Qe===null?$e.memoizedState:Qe.next;if(e!==null)Qe=e,Je=t;else{if(t===null)throw Error(ae(310));Je=t,t={memoizedState:Je.memoizedState,baseState:Je.baseState,baseQueue:Je.baseQueue,queue:Je.queue,next:null},Qe===null?$e.memoizedState=Qe=t:Qe=Qe.next=t}return Qe}function Ho(t,e){return typeof e=="function"?e(t):e}function oa(t){var e=Ht(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=Je,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var a=s=null,u=null,c=i;do{var f=c.lane;if((ir&f)===f)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var m={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(a=u=m,s=r):u=u.next=m,$e.lanes|=f,sr|=f}c=c.next}while(c!==null&&c!==i);u===null?s=r:u.next=a,Zt(r,e.memoizedState)||(Tt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do i=o.lane,$e.lanes|=i,sr|=i,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ia(t){var e=Ht(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,i=e.memoizedState;if(o!==null){n.pending=null;var s=o=o.next;do i=t(i,s.action),s=s.next;while(s!==o);Zt(i,e.memoizedState)||(Tt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function jh(){}function Wh(t,e){var n=$e,r=Ht(),o=e(),i=!Zt(r.memoizedState,o);if(i&&(r.memoizedState=o,Tt=!0),r=r.queue,ru(Kh.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Qe!==null&&Qe.memoizedState.tag&1){if(n.flags|=2048,Vo(9,Yh.bind(null,n,r,o,e),void 0,null),et===null)throw Error(ae(349));ir&30||qh(n,e,o)}return o}function qh(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Yh(t,e,n,r){e.value=n,e.getSnapshot=r,Jh(e)&&Xh(t)}function Kh(t,e,n){return n(function(){Jh(e)&&Xh(t)})}function Jh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zt(t,n)}catch{return!0}}function Xh(t){var e=vn(t,1);e!==null&&Kt(e,t,1,-1)}function Sc(t){var e=on();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ho,lastRenderedState:t},e.queue=t,t=t.dispatch=W0.bind(null,$e,t),[e.memoizedState,t]}function Vo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Zh(){return Ht().memoizedState}function bi(t,e,n,r){var o=on();$e.flags|=t,o.memoizedState=Vo(1|e,n,void 0,r===void 0?null:r)}function Ss(t,e,n,r){var o=Ht();r=r===void 0?null:r;var i=void 0;if(Je!==null){var s=Je.memoizedState;if(i=s.destroy,r!==null&&eu(r,s.deps)){o.memoizedState=Vo(e,n,i,r);return}}$e.flags|=t,o.memoizedState=Vo(1|e,n,i,r)}function Ec(t,e){return bi(8390656,8,t,e)}function ru(t,e){return Ss(2048,8,t,e)}function Qh(t,e){return Ss(4,2,t,e)}function ep(t,e){return Ss(4,4,t,e)}function tp(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function np(t,e,n){return n=n!=null?n.concat([t]):null,Ss(4,4,tp.bind(null,e,t),n)}function ou(){}function rp(t,e){var n=Ht();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&eu(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function op(t,e){var n=Ht();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&eu(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ip(t,e,n){return ir&21?(Zt(n,e)||(n=ch(),$e.lanes|=n,sr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Tt=!0),t.memoizedState=n)}function $0(t,e){var n=De;De=n!==0&&4>n?n:4,t(!0);var r=ra.transition;ra.transition={};try{t(!1),e()}finally{De=n,ra.transition=r}}function sp(){return Ht().memoizedState}function j0(t,e,n){var r=Fn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ap(t))lp(e,n);else if(n=Vh(t,e,n,r),n!==null){var o=mt();Kt(n,t,r,o),up(n,e,r)}}function W0(t,e,n){var r=Fn(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ap(t))lp(e,o);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var s=e.lastRenderedState,a=i(s,n);if(o.hasEagerState=!0,o.eagerState=a,Zt(a,s)){var u=e.interleaved;u===null?(o.next=o,Kl(e)):(o.next=u.next,u.next=o),e.interleaved=o;return}}catch{}finally{}n=Vh(t,e,o,r),n!==null&&(o=mt(),Kt(n,t,r,o),up(n,e,r))}}function ap(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function lp(t,e){wo=Qi=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function up(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Dl(t,n)}}var es={readContext:Bt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},q0={readContext:Bt,useCallback:function(t,e){return on().memoizedState=[t,e===void 0?null:e],t},useContext:Bt,useEffect:Ec,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,bi(4194308,4,tp.bind(null,e,t),n)},useLayoutEffect:function(t,e){return bi(4194308,4,t,e)},useInsertionEffect:function(t,e){return bi(4,2,t,e)},useMemo:function(t,e){var n=on();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=on();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=j0.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=on();return t={current:t},e.memoizedState=t},useState:Sc,useDebugValue:ou,useDeferredValue:function(t){return on().memoizedState=t},useTransition:function(){var t=Sc(!1),e=t[0];return t=$0.bind(null,t[1]),on().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$e,o=on();if(He){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=e(),et===null)throw Error(ae(349));ir&30||qh(r,e,n)}o.memoizedState=n;var i={value:n,getSnapshot:e};return o.queue=i,Ec(Kh.bind(null,r,i,t),[t]),r.flags|=2048,Vo(9,Yh.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=on(),e=et.identifierPrefix;if(He){var n=pn,r=hn;n=(r&~(1<<32-Yt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=z0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Y0={readContext:Bt,useCallback:rp,useContext:Bt,useEffect:ru,useImperativeHandle:np,useInsertionEffect:Qh,useLayoutEffect:ep,useMemo:op,useReducer:oa,useRef:Zh,useState:function(){return oa(Ho)},useDebugValue:ou,useDeferredValue:function(t){var e=Ht();return ip(e,Je.memoizedState,t)},useTransition:function(){var t=oa(Ho)[0],e=Ht().memoizedState;return[t,e]},useMutableSource:jh,useSyncExternalStore:Wh,useId:sp,unstable_isNewReconciler:!1},K0={readContext:Bt,useCallback:rp,useContext:Bt,useEffect:ru,useImperativeHandle:np,useInsertionEffect:Qh,useLayoutEffect:ep,useMemo:op,useReducer:ia,useRef:Zh,useState:function(){return ia(Ho)},useDebugValue:ou,useDeferredValue:function(t){var e=Ht();return Je===null?e.memoizedState=t:ip(e,Je.memoizedState,t)},useTransition:function(){var t=ia(Ho)[0],e=Ht().memoizedState;return[t,e]},useMutableSource:jh,useSyncExternalStore:Wh,useId:sp,unstable_isNewReconciler:!1};function jt(t,e){if(t&&t.defaultProps){e=je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Wa(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Es={isMounted:function(t){return(t=t._reactInternals)?ur(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=mt(),o=Fn(t),i=mn(r,o);i.payload=e,n!=null&&(i.callback=n),e=On(t,i,o),e!==null&&(Kt(e,t,o,r),Ni(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=mt(),o=Fn(t),i=mn(r,o);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=On(t,i,o),e!==null&&(Kt(e,t,o,r),Ni(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=mt(),r=Fn(t),o=mn(n,r);o.tag=2,e!=null&&(o.callback=e),e=On(t,o,r),e!==null&&(Kt(e,t,r,n),Ni(e,t,r))}};function Tc(t,e,n,r,o,i,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,s):e.prototype&&e.prototype.isPureReactComponent?!Lo(n,r)||!Lo(o,i):!0}function cp(t,e,n){var r=!1,o=Hn,i=e.contextType;return typeof i=="object"&&i!==null?i=Bt(i):(o=Ct(e)?rr:dt.current,r=e.contextTypes,i=(r=r!=null)?Br(t,o):Hn),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Es,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=i),e}function wc(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Es.enqueueReplaceState(e,e.state,null)}function qa(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},Jl(t);var i=e.contextType;typeof i=="object"&&i!==null?o.context=Bt(i):(i=Ct(e)?rr:dt.current,o.context=Br(t,i)),o.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Wa(t,e,i,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&Es.enqueueReplaceState(o,o.state,null),Xi(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function $r(t,e){try{var n="",r=e;do n+=wg(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:o,digest:null}}function sa(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ya(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var J0=typeof WeakMap=="function"?WeakMap:Map;function dp(t,e,n){n=mn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ns||(ns=!0,ol=r),Ya(t,e)},n}function fp(t,e,n){n=mn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){Ya(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ya(t,e),typeof r!="function"&&(Un===null?Un=new Set([this]):Un.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Cc(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new J0;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=cy.bind(null,t,e,n),e.then(t,t))}function _c(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Nc(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=mn(-1,1),e.tag=2,On(n,e,1))),n.lanes|=1),t)}var X0=En.ReactCurrentOwner,Tt=!1;function pt(t,e,n,r){e.child=t===null?Hh(e,null,n,r):Vr(e,t.child,n,r)}function Ic(t,e,n,r,o){n=n.render;var i=e.ref;return Dr(e,o),r=tu(t,e,n,r,i,o),n=nu(),t!==null&&!Tt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,xn(t,e,o)):(He&&n&&zl(e),e.flags|=1,pt(t,e,r,o),e.child)}function bc(t,e,n,r,o){if(t===null){var i=n.type;return typeof i=="function"&&!fu(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,hp(t,e,i,r,o)):(t=Pi(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&o)){var s=i.memoizedProps;if(n=n.compare,n=n!==null?n:Lo,n(s,r)&&t.ref===e.ref)return xn(t,e,o)}return e.flags|=1,t=Gn(i,r),t.ref=e.ref,t.return=e,e.child=t}function hp(t,e,n,r,o){if(t!==null){var i=t.memoizedProps;if(Lo(i,r)&&t.ref===e.ref)if(Tt=!1,e.pendingProps=r=i,(t.lanes&o)!==0)t.flags&131072&&(Tt=!0);else return e.lanes=t.lanes,xn(t,e,o)}return Ka(t,e,n,r,o)}function pp(t,e,n){var r=e.pendingProps,o=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ue(Nr,It),It|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ue(Nr,It),It|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ue(Nr,It),It|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ue(Nr,It),It|=r;return pt(t,e,o,n),e.child}function mp(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ka(t,e,n,r,o){var i=Ct(n)?rr:dt.current;return i=Br(e,i),Dr(e,o),n=tu(t,e,n,r,i,o),r=nu(),t!==null&&!Tt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,xn(t,e,o)):(He&&r&&zl(e),e.flags|=1,pt(t,e,n,o),e.child)}function Ac(t,e,n,r,o){if(Ct(n)){var i=!0;Wi(e)}else i=!1;if(Dr(e,o),e.stateNode===null)Ai(t,e),cp(e,n,r),qa(e,n,r,o),r=!0;else if(t===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var u=s.context,c=n.contextType;typeof c=="object"&&c!==null?c=Bt(c):(c=Ct(n)?rr:dt.current,c=Br(e,c));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function";m||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||u!==c)&&wc(e,s,r,c),Nn=!1;var p=e.memoizedState;s.state=p,Xi(e,r,s,o),u=e.memoizedState,a!==r||p!==u||wt.current||Nn?(typeof f=="function"&&(Wa(e,n,f,r),u=e.memoizedState),(a=Nn||Tc(e,n,a,r,p,u,c))?(m||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),s.props=r,s.state=u,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,zh(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:jt(e.type,a),s.props=c,m=e.pendingProps,p=s.context,u=n.contextType,typeof u=="object"&&u!==null?u=Bt(u):(u=Ct(n)?rr:dt.current,u=Br(e,u));var g=n.getDerivedStateFromProps;(f=typeof g=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==m||p!==u)&&wc(e,s,r,u),Nn=!1,p=e.memoizedState,s.state=p,Xi(e,r,s,o);var E=e.memoizedState;a!==m||p!==E||wt.current||Nn?(typeof g=="function"&&(Wa(e,n,g,r),E=e.memoizedState),(c=Nn||Tc(e,n,c,r,p,E,u)||!1)?(f||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,E,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,E,u)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),s.props=r,s.state=E,s.context=u,r=c):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Ja(t,e,n,r,i,o)}function Ja(t,e,n,r,o,i){mp(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return o&&pc(e,n,!1),xn(t,e,i);r=e.stateNode,X0.current=e;var a=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=Vr(e,t.child,null,i),e.child=Vr(e,null,a,i)):pt(t,e,a,i),e.memoizedState=r.state,o&&pc(e,n,!0),e.child}function gp(t){var e=t.stateNode;e.pendingContext?hc(t,e.pendingContext,e.pendingContext!==e.context):e.context&&hc(t,e.context,!1),Xl(t,e.containerInfo)}function Rc(t,e,n,r,o){return Hr(),jl(o),e.flags|=256,pt(t,e,n,r),e.child}var Xa={dehydrated:null,treeContext:null,retryLane:0};function Za(t){return{baseLanes:t,cachePool:null,transitions:null}}function yp(t,e,n){var r=e.pendingProps,o=ze.current,i=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(o&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),Ue(ze,o&1),t===null)return $a(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,i?(r=e.mode,i=e.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Cs(s,r,0,null),t=nr(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Za(n),e.memoizedState=Xa,t):iu(e,s));if(o=t.memoizedState,o!==null&&(a=o.dehydrated,a!==null))return Z0(t,e,s,r,a,o,n);if(i){i=r.fallback,s=e.mode,o=t.child,a=o.sibling;var u={mode:"hidden",children:r.children};return!(s&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Gn(o,u),r.subtreeFlags=o.subtreeFlags&14680064),a!==null?i=Gn(a,i):(i=nr(i,s,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,s=t.child.memoizedState,s=s===null?Za(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=t.childLanes&~n,e.memoizedState=Xa,r}return i=t.child,t=i.sibling,r=Gn(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function iu(t,e){return e=Cs({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ui(t,e,n,r){return r!==null&&jl(r),Vr(e,t.child,null,n),t=iu(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Z0(t,e,n,r,o,i,s){if(n)return e.flags&256?(e.flags&=-257,r=sa(Error(ae(422))),ui(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=Cs({mode:"visible",children:r.children},o,0,null),i=nr(i,o,s,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Vr(e,t.child,null,s),e.child.memoizedState=Za(s),e.memoizedState=Xa,i);if(!(e.mode&1))return ui(t,e,s,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(ae(419)),r=sa(i,r,void 0),ui(t,e,s,r)}if(a=(s&t.childLanes)!==0,Tt||a){if(r=et,r!==null){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|s)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,vn(t,o),Kt(r,t,o,-1))}return du(),r=sa(Error(ae(421))),ui(t,e,s,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=dy.bind(null,t),o._reactRetry=e,null):(t=i.treeContext,bt=Dn(o.nextSibling),At=e,He=!0,qt=null,t!==null&&(Dt[Ot++]=hn,Dt[Ot++]=pn,Dt[Ot++]=or,hn=t.id,pn=t.overflow,or=e),e=iu(e,r.children),e.flags|=4096,e)}function kc(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ja(t.return,e,n)}function aa(t,e,n,r,o){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function vp(t,e,n){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(pt(t,e,r.children,n),r=ze.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&kc(t,n,e);else if(t.tag===19)kc(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ue(ze,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&Zi(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),aa(e,!1,o,n,i);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&Zi(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}aa(e,!0,n,null,i);break;case"together":aa(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ai(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),sr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,n=Gn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Gn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Q0(t,e,n){switch(e.tag){case 3:gp(e),Hr();break;case 5:$h(e);break;case 1:Ct(e.type)&&Wi(e);break;case 4:Xl(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;Ue(Ki,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ue(ze,ze.current&1),e.flags|=128,null):n&e.child.childLanes?yp(t,e,n):(Ue(ze,ze.current&1),t=xn(t,e,n),t!==null?t.sibling:null);Ue(ze,ze.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return vp(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ue(ze,ze.current),r)break;return null;case 22:case 23:return e.lanes=0,pp(t,e,n)}return xn(t,e,n)}var xp,Qa,Sp,Ep;xp=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Qa=function(){};Sp=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,er(ln.current);var i=null;switch(n){case"input":o=Ea(t,o),r=Ea(t,r),i=[];break;case"select":o=je({},o,{value:void 0}),r=je({},r,{value:void 0}),i=[];break;case"textarea":o=Ca(t,o),r=Ca(t,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=$i)}Na(n,r);var s;n=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var a=o[c];for(s in a)a.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Io.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(a=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&u!==a&&(u!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&a[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Io.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Fe("scroll",t),i||a===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};Ep=function(t,e,n,r){n!==r&&(e.flags|=4)};function so(t,e){if(!He)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function lt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ey(t,e,n){var r=e.pendingProps;switch($l(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(e),null;case 1:return Ct(e.type)&&ji(),lt(e),null;case 3:return r=e.stateNode,zr(),Ge(wt),Ge(dt),Ql(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ai(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,qt!==null&&(al(qt),qt=null))),Qa(t,e),lt(e),null;case 5:Zl(e);var o=er(Go.current);if(n=e.type,t!==null&&e.stateNode!=null)Sp(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ae(166));return lt(e),null}if(t=er(ln.current),ai(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[sn]=e,r[Uo]=i,t=(e.mode&1)!==0,n){case"dialog":Fe("cancel",r),Fe("close",r);break;case"iframe":case"object":case"embed":Fe("load",r);break;case"video":case"audio":for(o=0;o<po.length;o++)Fe(po[o],r);break;case"source":Fe("error",r);break;case"img":case"image":case"link":Fe("error",r),Fe("load",r);break;case"details":Fe("toggle",r);break;case"input":Bu(r,i),Fe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Fe("invalid",r);break;case"textarea":Vu(r,i),Fe("invalid",r)}Na(n,i),o=null;for(var s in i)if(i.hasOwnProperty(s)){var a=i[s];s==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&si(r.textContent,a,t),o=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&si(r.textContent,a,t),o=["children",""+a]):Io.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Fe("scroll",r)}switch(n){case"input":Zo(r),Hu(r,i,!0);break;case"textarea":Zo(r),zu(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=$i)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Kf(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[sn]=e,t[Uo]=r,xp(t,e,!1,!1),e.stateNode=t;e:{switch(s=Ia(n,r),n){case"dialog":Fe("cancel",t),Fe("close",t),o=r;break;case"iframe":case"object":case"embed":Fe("load",t),o=r;break;case"video":case"audio":for(o=0;o<po.length;o++)Fe(po[o],t);o=r;break;case"source":Fe("error",t),o=r;break;case"img":case"image":case"link":Fe("error",t),Fe("load",t),o=r;break;case"details":Fe("toggle",t),o=r;break;case"input":Bu(t,r),o=Ea(t,r),Fe("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=je({},r,{value:void 0}),Fe("invalid",t);break;case"textarea":Vu(t,r),o=Ca(t,r),Fe("invalid",t);break;default:o=r}Na(n,o),a=o;for(i in a)if(a.hasOwnProperty(i)){var u=a[i];i==="style"?Zf(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Jf(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&bo(t,u):typeof u=="number"&&bo(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Io.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Fe("scroll",t):u!=null&&Al(t,i,u,s))}switch(n){case"input":Zo(t),Hu(t,r,!1);break;case"textarea":Zo(t),zu(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Bn(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?kr(t,!!r.multiple,i,!1):r.defaultValue!=null&&kr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=$i)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return lt(e),null;case 6:if(t&&e.stateNode!=null)Ep(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ae(166));if(n=er(Go.current),er(ln.current),ai(e)){if(r=e.stateNode,n=e.memoizedProps,r[sn]=e,(i=r.nodeValue!==n)&&(t=At,t!==null))switch(t.tag){case 3:si(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&si(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[sn]=e,e.stateNode=r}return lt(e),null;case 13:if(Ge(ze),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(He&&bt!==null&&e.mode&1&&!(e.flags&128))Gh(),Hr(),e.flags|=98560,i=!1;else if(i=ai(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(ae(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ae(317));i[sn]=e}else Hr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;lt(e),i=!1}else qt!==null&&(al(qt),qt=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ze.current&1?Xe===0&&(Xe=3):du())),e.updateQueue!==null&&(e.flags|=4),lt(e),null);case 4:return zr(),Qa(t,e),t===null&&Do(e.stateNode.containerInfo),lt(e),null;case 10:return Yl(e.type._context),lt(e),null;case 17:return Ct(e.type)&&ji(),lt(e),null;case 19:if(Ge(ze),i=e.memoizedState,i===null)return lt(e),null;if(r=(e.flags&128)!==0,s=i.rendering,s===null)if(r)so(i,!1);else{if(Xe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Zi(t),s!==null){for(e.flags|=128,so(i,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,t=s.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ue(ze,ze.current&1|2),e.child}t=t.sibling}i.tail!==null&&qe()>jr&&(e.flags|=128,r=!0,so(i,!1),e.lanes=4194304)}else{if(!r)if(t=Zi(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),so(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!He)return lt(e),null}else 2*qe()-i.renderingStartTime>jr&&n!==1073741824&&(e.flags|=128,r=!0,so(i,!1),e.lanes=4194304);i.isBackwards?(s.sibling=e.child,e.child=s):(n=i.last,n!==null?n.sibling=s:e.child=s,i.last=s)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=qe(),e.sibling=null,n=ze.current,Ue(ze,r?n&1|2:n&1),e):(lt(e),null);case 22:case 23:return cu(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?It&1073741824&&(lt(e),e.subtreeFlags&6&&(e.flags|=8192)):lt(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function ty(t,e){switch($l(e),e.tag){case 1:return Ct(e.type)&&ji(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zr(),Ge(wt),Ge(dt),Ql(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Zl(e),null;case 13:if(Ge(ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));Hr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ge(ze),null;case 4:return zr(),null;case 10:return Yl(e.type._context),null;case 22:case 23:return cu(),null;case 24:return null;default:return null}}var ci=!1,ut=!1,ny=typeof WeakSet=="function"?WeakSet:Set,Se=null;function _r(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){We(t,e,r)}else n.current=null}function el(t,e,n){try{n()}catch(r){We(t,e,r)}}var Pc=!1;function ry(t,e){if(Ua=Hi,t=Nh(),Vl(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var s=0,a=-1,u=-1,c=0,f=0,m=t,p=null;t:for(;;){for(var g;m!==n||o!==0&&m.nodeType!==3||(a=s+o),m!==i||r!==0&&m.nodeType!==3||(u=s+r),m.nodeType===3&&(s+=m.nodeValue.length),(g=m.firstChild)!==null;)p=m,m=g;for(;;){if(m===t)break t;if(p===n&&++c===o&&(a=s),p===i&&++f===r&&(u=s),(g=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=g}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fa={focusedElem:t,selectionRange:n},Hi=!1,Se=e;Se!==null;)if(e=Se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Se=t;else for(;Se!==null;){e=Se;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var v=E.memoizedProps,T=E.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?v:jt(e.type,v),T);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(_){We(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,Se=t;break}Se=e.return}return E=Pc,Pc=!1,E}function Co(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var i=o.destroy;o.destroy=void 0,i!==void 0&&el(e,n,i)}o=o.next}while(o!==r)}}function Ts(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function tl(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Tp(t){var e=t.alternate;e!==null&&(t.alternate=null,Tp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[sn],delete e[Uo],delete e[Ha],delete e[G0],delete e[B0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function wp(t){return t.tag===5||t.tag===3||t.tag===4}function Mc(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||wp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function nl(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=$i));else if(r!==4&&(t=t.child,t!==null))for(nl(t,e,n),t=t.sibling;t!==null;)nl(t,e,n),t=t.sibling}function rl(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(rl(t,e,n),t=t.sibling;t!==null;)rl(t,e,n),t=t.sibling}var rt=null,Wt=!1;function Cn(t,e,n){for(n=n.child;n!==null;)Cp(t,e,n),n=n.sibling}function Cp(t,e,n){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(ps,n)}catch{}switch(n.tag){case 5:ut||_r(n,e);case 6:var r=rt,o=Wt;rt=null,Cn(t,e,n),rt=r,Wt=o,rt!==null&&(Wt?(t=rt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):rt.removeChild(n.stateNode));break;case 18:rt!==null&&(Wt?(t=rt,n=n.stateNode,t.nodeType===8?ea(t.parentNode,n):t.nodeType===1&&ea(t,n),Po(t)):ea(rt,n.stateNode));break;case 4:r=rt,o=Wt,rt=n.stateNode.containerInfo,Wt=!0,Cn(t,e,n),rt=r,Wt=o;break;case 0:case 11:case 14:case 15:if(!ut&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&el(n,e,s),o=o.next}while(o!==r)}Cn(t,e,n);break;case 1:if(!ut&&(_r(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){We(n,e,a)}Cn(t,e,n);break;case 21:Cn(t,e,n);break;case 22:n.mode&1?(ut=(r=ut)||n.memoizedState!==null,Cn(t,e,n),ut=r):Cn(t,e,n);break;default:Cn(t,e,n)}}function Lc(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ny),e.forEach(function(r){var o=fy.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function $t(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=t,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:rt=a.stateNode,Wt=!1;break e;case 3:rt=a.stateNode.containerInfo,Wt=!0;break e;case 4:rt=a.stateNode.containerInfo,Wt=!0;break e}a=a.return}if(rt===null)throw Error(ae(160));Cp(i,s,o),rt=null,Wt=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(c){We(o,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)_p(e,t),e=e.sibling}function _p(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if($t(e,t),rn(t),r&4){try{Co(3,t,t.return),Ts(3,t)}catch(v){We(t,t.return,v)}try{Co(5,t,t.return)}catch(v){We(t,t.return,v)}}break;case 1:$t(e,t),rn(t),r&512&&n!==null&&_r(n,n.return);break;case 5:if($t(e,t),rn(t),r&512&&n!==null&&_r(n,n.return),t.flags&32){var o=t.stateNode;try{bo(o,"")}catch(v){We(t,t.return,v)}}if(r&4&&(o=t.stateNode,o!=null)){var i=t.memoizedProps,s=n!==null?n.memoizedProps:i,a=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&qf(o,i),Ia(a,s);var c=Ia(a,i);for(s=0;s<u.length;s+=2){var f=u[s],m=u[s+1];f==="style"?Zf(o,m):f==="dangerouslySetInnerHTML"?Jf(o,m):f==="children"?bo(o,m):Al(o,f,m,c)}switch(a){case"input":Ta(o,i);break;case"textarea":Yf(o,i);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?kr(o,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?kr(o,!!i.multiple,i.defaultValue,!0):kr(o,!!i.multiple,i.multiple?[]:"",!1))}o[Uo]=i}catch(v){We(t,t.return,v)}}break;case 6:if($t(e,t),rn(t),r&4){if(t.stateNode===null)throw Error(ae(162));o=t.stateNode,i=t.memoizedProps;try{o.nodeValue=i}catch(v){We(t,t.return,v)}}break;case 3:if($t(e,t),rn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Po(e.containerInfo)}catch(v){We(t,t.return,v)}break;case 4:$t(e,t),rn(t);break;case 13:$t(e,t),rn(t),o=t.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(lu=qe())),r&4&&Lc(t);break;case 22:if(f=n!==null&&n.memoizedState!==null,t.mode&1?(ut=(c=ut)||f,$t(e,t),ut=c):$t(e,t),rn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!f&&t.mode&1)for(Se=t,f=t.child;f!==null;){for(m=Se=f;Se!==null;){switch(p=Se,g=p.child,p.tag){case 0:case 11:case 14:case 15:Co(4,p,p.return);break;case 1:_r(p,p.return);var E=p.stateNode;if(typeof E.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(v){We(r,n,v)}}break;case 5:_r(p,p.return);break;case 22:if(p.memoizedState!==null){Oc(m);continue}}g!==null?(g.return=p,Se=g):Oc(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{o=m.stateNode,c?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,u=m.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=Xf("display",s))}catch(v){We(t,t.return,v)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=c?"":m.memoizedProps}catch(v){We(t,t.return,v)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:$t(e,t),rn(t),r&4&&Lc(t);break;case 21:break;default:$t(e,t),rn(t)}}function rn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(wp(n)){var r=n;break e}n=n.return}throw Error(ae(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(bo(o,""),r.flags&=-33);var i=Mc(t);rl(t,i,o);break;case 3:case 4:var s=r.stateNode.containerInfo,a=Mc(t);nl(t,a,s);break;default:throw Error(ae(161))}}catch(u){We(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oy(t,e,n){Se=t,Np(t)}function Np(t,e,n){for(var r=(t.mode&1)!==0;Se!==null;){var o=Se,i=o.child;if(o.tag===22&&r){var s=o.memoizedState!==null||ci;if(!s){var a=o.alternate,u=a!==null&&a.memoizedState!==null||ut;a=ci;var c=ut;if(ci=s,(ut=u)&&!c)for(Se=o;Se!==null;)s=Se,u=s.child,s.tag===22&&s.memoizedState!==null?Uc(o):u!==null?(u.return=s,Se=u):Uc(o);for(;i!==null;)Se=i,Np(i),i=i.sibling;Se=o,ci=a,ut=c}Dc(t)}else o.subtreeFlags&8772&&i!==null?(i.return=o,Se=i):Dc(t)}}function Dc(t){for(;Se!==null;){var e=Se;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ut||Ts(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ut)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:jt(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&xc(e,i,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}xc(e,s,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&Po(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}ut||e.flags&512&&tl(e)}catch(p){We(e,e.return,p)}}if(e===t){Se=null;break}if(n=e.sibling,n!==null){n.return=e.return,Se=n;break}Se=e.return}}function Oc(t){for(;Se!==null;){var e=Se;if(e===t){Se=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Se=n;break}Se=e.return}}function Uc(t){for(;Se!==null;){var e=Se;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ts(4,e)}catch(u){We(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(u){We(e,o,u)}}var i=e.return;try{tl(e)}catch(u){We(e,i,u)}break;case 5:var s=e.return;try{tl(e)}catch(u){We(e,s,u)}}}catch(u){We(e,e.return,u)}if(e===t){Se=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Se=a;break}Se=e.return}}var iy=Math.ceil,ts=En.ReactCurrentDispatcher,su=En.ReactCurrentOwner,Ft=En.ReactCurrentBatchConfig,Re=0,et=null,Ye=null,ot=0,It=0,Nr=$n(0),Xe=0,zo=null,sr=0,ws=0,au=0,_o=null,Et=null,lu=0,jr=1/0,cn=null,ns=!1,ol=null,Un=null,di=!1,Rn=null,rs=0,No=0,il=null,Ri=-1,ki=0;function mt(){return Re&6?qe():Ri!==-1?Ri:Ri=qe()}function Fn(t){return t.mode&1?Re&2&&ot!==0?ot&-ot:V0.transition!==null?(ki===0&&(ki=ch()),ki):(t=De,t!==0||(t=window.event,t=t===void 0?16:yh(t.type)),t):1}function Kt(t,e,n,r){if(50<No)throw No=0,il=null,Error(ae(185));jo(t,n,r),(!(Re&2)||t!==et)&&(t===et&&(!(Re&2)&&(ws|=n),Xe===4&&bn(t,ot)),_t(t,r),n===1&&Re===0&&!(e.mode&1)&&(jr=qe()+500,xs&&jn()))}function _t(t,e){var n=t.callbackNode;Vg(t,e);var r=Bi(t,t===et?ot:0);if(r===0)n!==null&&Wu(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Wu(n),e===1)t.tag===0?H0(Fc.bind(null,t)):Oh(Fc.bind(null,t)),U0(function(){!(Re&6)&&jn()}),n=null;else{switch(dh(r)){case 1:n=Ll;break;case 4:n=lh;break;case 16:n=Gi;break;case 536870912:n=uh;break;default:n=Gi}n=Lp(n,Ip.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ip(t,e){if(Ri=-1,ki=0,Re&6)throw Error(ae(327));var n=t.callbackNode;if(Or()&&t.callbackNode!==n)return null;var r=Bi(t,t===et?ot:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=os(t,r);else{e=r;var o=Re;Re|=2;var i=Ap();(et!==t||ot!==e)&&(cn=null,jr=qe()+500,tr(t,e));do try{ly();break}catch(a){bp(t,a)}while(!0);ql(),ts.current=i,Re=o,Ye!==null?e=0:(et=null,ot=0,e=Xe)}if(e!==0){if(e===2&&(o=Pa(t),o!==0&&(r=o,e=sl(t,o))),e===1)throw n=zo,tr(t,0),bn(t,r),_t(t,qe()),n;if(e===6)bn(t,r);else{if(o=t.current.alternate,!(r&30)&&!sy(o)&&(e=os(t,r),e===2&&(i=Pa(t),i!==0&&(r=i,e=sl(t,i))),e===1))throw n=zo,tr(t,0),bn(t,r),_t(t,qe()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(ae(345));case 2:Jn(t,Et,cn);break;case 3:if(bn(t,r),(r&130023424)===r&&(e=lu+500-qe(),10<e)){if(Bi(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){mt(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Ba(Jn.bind(null,t,Et,cn),e);break}Jn(t,Et,cn);break;case 4:if(bn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var s=31-Yt(r);i=1<<s,s=e[s],s>o&&(o=s),r&=~i}if(r=o,r=qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*iy(r/1960))-r,10<r){t.timeoutHandle=Ba(Jn.bind(null,t,Et,cn),r);break}Jn(t,Et,cn);break;case 5:Jn(t,Et,cn);break;default:throw Error(ae(329))}}}return _t(t,qe()),t.callbackNode===n?Ip.bind(null,t):null}function sl(t,e){var n=_o;return t.current.memoizedState.isDehydrated&&(tr(t,e).flags|=256),t=os(t,e),t!==2&&(e=Et,Et=n,e!==null&&al(e)),t}function al(t){Et===null?Et=t:Et.push.apply(Et,t)}function sy(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!Zt(i(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bn(t,e){for(e&=~au,e&=~ws,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yt(e),r=1<<n;t[n]=-1,e&=~r}}function Fc(t){if(Re&6)throw Error(ae(327));Or();var e=Bi(t,0);if(!(e&1))return _t(t,qe()),null;var n=os(t,e);if(t.tag!==0&&n===2){var r=Pa(t);r!==0&&(e=r,n=sl(t,r))}if(n===1)throw n=zo,tr(t,0),bn(t,e),_t(t,qe()),n;if(n===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Jn(t,Et,cn),_t(t,qe()),null}function uu(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(jr=qe()+500,xs&&jn())}}function ar(t){Rn!==null&&Rn.tag===0&&!(Re&6)&&Or();var e=Re;Re|=1;var n=Ft.transition,r=De;try{if(Ft.transition=null,De=1,t)return t()}finally{De=r,Ft.transition=n,Re=e,!(Re&6)&&jn()}}function cu(){It=Nr.current,Ge(Nr)}function tr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,O0(n)),Ye!==null)for(n=Ye.return;n!==null;){var r=n;switch($l(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ji();break;case 3:zr(),Ge(wt),Ge(dt),Ql();break;case 5:Zl(r);break;case 4:zr();break;case 13:Ge(ze);break;case 19:Ge(ze);break;case 10:Yl(r.type._context);break;case 22:case 23:cu()}n=n.return}if(et=t,Ye=t=Gn(t.current,null),ot=It=e,Xe=0,zo=null,au=ws=sr=0,Et=_o=null,Qn!==null){for(e=0;e<Qn.length;e++)if(n=Qn[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var s=i.next;i.next=o,r.next=s}n.pending=r}Qn=null}return t}function bp(t,e){do{var n=Ye;try{if(ql(),Ii.current=es,Qi){for(var r=$e.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Qi=!1}if(ir=0,Qe=Je=$e=null,wo=!1,Bo=0,su.current=null,n===null||n.return===null){Xe=1,zo=e,Ye=null;break}e:{var i=t,s=n.return,a=n,u=e;if(e=ot,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,f=a,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var g=_c(s);if(g!==null){g.flags&=-257,Nc(g,s,a,i,e),g.mode&1&&Cc(i,c,e),e=g,u=c;var E=e.updateQueue;if(E===null){var v=new Set;v.add(u),e.updateQueue=v}else E.add(u);break e}else{if(!(e&1)){Cc(i,c,e),du();break e}u=Error(ae(426))}}else if(He&&a.mode&1){var T=_c(s);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Nc(T,s,a,i,e),jl($r(u,a));break e}}i=u=$r(u,a),Xe!==4&&(Xe=2),_o===null?_o=[i]:_o.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=dp(i,u,e);vc(i,y);break e;case 1:a=u;var x=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Un===null||!Un.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var _=fp(i,a,e);vc(i,_);break e}}i=i.return}while(i!==null)}kp(n)}catch(b){e=b,Ye===n&&n!==null&&(Ye=n=n.return);continue}break}while(!0)}function Ap(){var t=ts.current;return ts.current=es,t===null?es:t}function du(){(Xe===0||Xe===3||Xe===2)&&(Xe=4),et===null||!(sr&268435455)&&!(ws&268435455)||bn(et,ot)}function os(t,e){var n=Re;Re|=2;var r=Ap();(et!==t||ot!==e)&&(cn=null,tr(t,e));do try{ay();break}catch(o){bp(t,o)}while(!0);if(ql(),Re=n,ts.current=r,Ye!==null)throw Error(ae(261));return et=null,ot=0,Xe}function ay(){for(;Ye!==null;)Rp(Ye)}function ly(){for(;Ye!==null&&!Mg();)Rp(Ye)}function Rp(t){var e=Mp(t.alternate,t,It);t.memoizedProps=t.pendingProps,e===null?kp(t):Ye=e,su.current=null}function kp(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ty(n,e),n!==null){n.flags&=32767,Ye=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Xe=6,Ye=null;return}}else if(n=ey(n,e,It),n!==null){Ye=n;return}if(e=e.sibling,e!==null){Ye=e;return}Ye=e=t}while(e!==null);Xe===0&&(Xe=5)}function Jn(t,e,n){var r=De,o=Ft.transition;try{Ft.transition=null,De=1,uy(t,e,n,r)}finally{Ft.transition=o,De=r}return null}function uy(t,e,n,r){do Or();while(Rn!==null);if(Re&6)throw Error(ae(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(zg(t,i),t===et&&(Ye=et=null,ot=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||di||(di=!0,Lp(Gi,function(){return Or(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Ft.transition,Ft.transition=null;var s=De;De=1;var a=Re;Re|=4,su.current=null,ry(t,n),_p(n,t),A0(Fa),Hi=!!Ua,Fa=Ua=null,t.current=n,oy(n),Lg(),Re=a,De=s,Ft.transition=i}else t.current=n;if(di&&(di=!1,Rn=t,rs=o),i=t.pendingLanes,i===0&&(Un=null),Ug(n.stateNode),_t(t,qe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ns)throw ns=!1,t=ol,ol=null,t;return rs&1&&t.tag!==0&&Or(),i=t.pendingLanes,i&1?t===il?No++:(No=0,il=t):No=0,jn(),null}function Or(){if(Rn!==null){var t=dh(rs),e=Ft.transition,n=De;try{if(Ft.transition=null,De=16>t?16:t,Rn===null)var r=!1;else{if(t=Rn,Rn=null,rs=0,Re&6)throw Error(ae(331));var o=Re;for(Re|=4,Se=t.current;Se!==null;){var i=Se,s=i.child;if(Se.flags&16){var a=i.deletions;if(a!==null){for(var u=0;u<a.length;u++){var c=a[u];for(Se=c;Se!==null;){var f=Se;switch(f.tag){case 0:case 11:case 15:Co(8,f,i)}var m=f.child;if(m!==null)m.return=f,Se=m;else for(;Se!==null;){f=Se;var p=f.sibling,g=f.return;if(Tp(f),f===c){Se=null;break}if(p!==null){p.return=g,Se=p;break}Se=g}}}var E=i.alternate;if(E!==null){var v=E.child;if(v!==null){E.child=null;do{var T=v.sibling;v.sibling=null,v=T}while(v!==null)}}Se=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,Se=s;else e:for(;Se!==null;){if(i=Se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Co(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,Se=y;break e}Se=i.return}}var x=t.current;for(Se=x;Se!==null;){s=Se;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,Se=w;else e:for(s=x;Se!==null;){if(a=Se,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ts(9,a)}}catch(b){We(a,a.return,b)}if(a===s){Se=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,Se=_;break e}Se=a.return}}if(Re=o,jn(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(ps,t)}catch{}r=!0}return r}finally{De=n,Ft.transition=e}}return!1}function Gc(t,e,n){e=$r(n,e),e=dp(t,e,1),t=On(t,e,1),e=mt(),t!==null&&(jo(t,1,e),_t(t,e))}function We(t,e,n){if(t.tag===3)Gc(t,t,n);else for(;e!==null;){if(e.tag===3){Gc(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Un===null||!Un.has(r))){t=$r(n,t),t=fp(e,t,1),e=On(e,t,1),t=mt(),e!==null&&(jo(e,1,t),_t(e,t));break}}e=e.return}}function cy(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=mt(),t.pingedLanes|=t.suspendedLanes&n,et===t&&(ot&n)===n&&(Xe===4||Xe===3&&(ot&130023424)===ot&&500>qe()-lu?tr(t,0):au|=n),_t(t,e)}function Pp(t,e){e===0&&(t.mode&1?(e=ti,ti<<=1,!(ti&130023424)&&(ti=4194304)):e=1);var n=mt();t=vn(t,e),t!==null&&(jo(t,e,n),_t(t,n))}function dy(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Pp(t,n)}function fy(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ae(314))}r!==null&&r.delete(e),Pp(t,n)}var Mp;Mp=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||wt.current)Tt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Tt=!1,Q0(t,e,n);Tt=!!(t.flags&131072)}else Tt=!1,He&&e.flags&1048576&&Uh(e,Yi,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ai(t,e),t=e.pendingProps;var o=Br(e,dt.current);Dr(e,n),o=tu(null,e,r,t,o,n);var i=nu();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ct(r)?(i=!0,Wi(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Jl(e),o.updater=Es,e.stateNode=o,o._reactInternals=e,qa(e,r,t,n),e=Ja(null,e,r,!0,i,n)):(e.tag=0,He&&i&&zl(e),pt(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ai(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=py(r),t=jt(r,t),o){case 0:e=Ka(null,e,r,t,n);break e;case 1:e=Ac(null,e,r,t,n);break e;case 11:e=Ic(null,e,r,t,n);break e;case 14:e=bc(null,e,r,jt(r.type,t),n);break e}throw Error(ae(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:jt(r,o),Ka(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:jt(r,o),Ac(t,e,r,o,n);case 3:e:{if(gp(e),t===null)throw Error(ae(387));r=e.pendingProps,i=e.memoizedState,o=i.element,zh(t,e),Xi(e,r,null,n);var s=e.memoizedState;if(r=s.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=$r(Error(ae(423)),e),e=Rc(t,e,r,n,o);break e}else if(r!==o){o=$r(Error(ae(424)),e),e=Rc(t,e,r,n,o);break e}else for(bt=Dn(e.stateNode.containerInfo.firstChild),At=e,He=!0,qt=null,n=Hh(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hr(),r===o){e=xn(t,e,n);break e}pt(t,e,r,n)}e=e.child}return e;case 5:return $h(e),t===null&&$a(e),r=e.type,o=e.pendingProps,i=t!==null?t.memoizedProps:null,s=o.children,Ga(r,o)?s=null:i!==null&&Ga(r,i)&&(e.flags|=32),mp(t,e),pt(t,e,s,n),e.child;case 6:return t===null&&$a(e),null;case 13:return yp(t,e,n);case 4:return Xl(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Vr(e,null,r,n):pt(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:jt(r,o),Ic(t,e,r,o,n);case 7:return pt(t,e,e.pendingProps,n),e.child;case 8:return pt(t,e,e.pendingProps.children,n),e.child;case 12:return pt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,s=o.value,Ue(Ki,r._currentValue),r._currentValue=s,i!==null)if(Zt(i.value,s)){if(i.children===o.children&&!wt.current){e=xn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){s=i.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=mn(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?u.next=u:(u.next=f.next,f.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),ja(i.return,n,e),a.lanes|=n;break}u=u.next}}else if(i.tag===10)s=i.type===e.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(ae(341));s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),ja(s,n,e),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===e){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}pt(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,Dr(e,n),o=Bt(o),r=r(o),e.flags|=1,pt(t,e,r,n),e.child;case 14:return r=e.type,o=jt(r,e.pendingProps),o=jt(r.type,o),bc(t,e,r,o,n);case 15:return hp(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:jt(r,o),Ai(t,e),e.tag=1,Ct(r)?(t=!0,Wi(e)):t=!1,Dr(e,n),cp(e,r,o),qa(e,r,o,n),Ja(null,e,r,!0,t,n);case 19:return vp(t,e,n);case 22:return pp(t,e,n)}throw Error(ae(156,e.tag))};function Lp(t,e){return ah(t,e)}function hy(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ut(t,e,n,r){return new hy(t,e,n,r)}function fu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function py(t){if(typeof t=="function")return fu(t)?1:0;if(t!=null){if(t=t.$$typeof,t===kl)return 11;if(t===Pl)return 14}return 2}function Gn(t,e){var n=t.alternate;return n===null?(n=Ut(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Pi(t,e,n,r,o,i){var s=2;if(r=t,typeof t=="function")fu(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case gr:return nr(n.children,o,i,e);case Rl:s=8,o|=8;break;case ya:return t=Ut(12,n,e,o|2),t.elementType=ya,t.lanes=i,t;case va:return t=Ut(13,n,e,o),t.elementType=va,t.lanes=i,t;case xa:return t=Ut(19,n,e,o),t.elementType=xa,t.lanes=i,t;case $f:return Cs(n,o,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Vf:s=10;break e;case zf:s=9;break e;case kl:s=11;break e;case Pl:s=14;break e;case _n:s=16,r=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=Ut(s,n,e,o),e.elementType=t,e.type=r,e.lanes=i,e}function nr(t,e,n,r){return t=Ut(7,t,r,e),t.lanes=n,t}function Cs(t,e,n,r){return t=Ut(22,t,r,e),t.elementType=$f,t.lanes=n,t.stateNode={isHidden:!1},t}function la(t,e,n){return t=Ut(6,t,null,e),t.lanes=n,t}function ua(t,e,n){return e=Ut(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function my(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zs(0),this.expirationTimes=zs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zs(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function hu(t,e,n,r,o,i,s,a,u){return t=new my(t,e,n,a,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ut(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jl(i),t}function gy(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Dp(t){if(!t)return Hn;t=t._reactInternals;e:{if(ur(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ct(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var n=t.type;if(Ct(n))return Dh(t,n,e)}return e}function Op(t,e,n,r,o,i,s,a,u){return t=hu(n,r,!0,t,o,i,s,a,u),t.context=Dp(null),n=t.current,r=mt(),o=Fn(n),i=mn(r,o),i.callback=e??null,On(n,i,o),t.current.lanes=o,jo(t,o,r),_t(t,r),t}function _s(t,e,n,r){var o=e.current,i=mt(),s=Fn(o);return n=Dp(n),e.context===null?e.context=n:e.pendingContext=n,e=mn(i,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=On(o,e,s),t!==null&&(Kt(t,o,s,i),Ni(t,o,s)),s}function is(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Bc(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function pu(t,e){Bc(t,e),(t=t.alternate)&&Bc(t,e)}function yy(){return null}var Up=typeof reportError=="function"?reportError:function(t){console.error(t)};function mu(t){this._internalRoot=t}Ns.prototype.render=mu.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));_s(t,e,null,null)};Ns.prototype.unmount=mu.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ar(function(){_s(null,t,null,null)}),e[yn]=null}};function Ns(t){this._internalRoot=t}Ns.prototype.unstable_scheduleHydration=function(t){if(t){var e=ph();t={blockedOn:null,target:t,priority:e};for(var n=0;n<In.length&&e!==0&&e<In[n].priority;n++);In.splice(n,0,t),n===0&&gh(t)}};function gu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Is(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hc(){}function vy(t,e,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var c=is(s);i.call(c)}}var s=Op(e,r,t,0,null,!1,!1,"",Hc);return t._reactRootContainer=s,t[yn]=s.current,Do(t.nodeType===8?t.parentNode:t),ar(),s}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var a=r;r=function(){var c=is(u);a.call(c)}}var u=hu(t,0,!1,null,null,!1,!1,"",Hc);return t._reactRootContainer=u,t[yn]=u.current,Do(t.nodeType===8?t.parentNode:t),ar(function(){_s(e,u,n,r)}),u}function bs(t,e,n,r,o){var i=n._reactRootContainer;if(i){var s=i;if(typeof o=="function"){var a=o;o=function(){var u=is(s);a.call(u)}}_s(e,s,t,o)}else s=vy(n,e,t,o,r);return is(s)}fh=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ho(e.pendingLanes);n!==0&&(Dl(e,n|1),_t(e,qe()),!(Re&6)&&(jr=qe()+500,jn()))}break;case 13:ar(function(){var r=vn(t,1);if(r!==null){var o=mt();Kt(r,t,1,o)}}),pu(t,1)}};Ol=function(t){if(t.tag===13){var e=vn(t,134217728);if(e!==null){var n=mt();Kt(e,t,134217728,n)}pu(t,134217728)}};hh=function(t){if(t.tag===13){var e=Fn(t),n=vn(t,e);if(n!==null){var r=mt();Kt(n,t,e,r)}pu(t,e)}};ph=function(){return De};mh=function(t,e){var n=De;try{return De=t,e()}finally{De=n}};Aa=function(t,e,n){switch(e){case"input":if(Ta(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=vs(r);if(!o)throw Error(ae(90));Wf(r),Ta(r,o)}}}break;case"textarea":Yf(t,n);break;case"select":e=n.value,e!=null&&kr(t,!!n.multiple,e,!1)}};th=uu;nh=ar;var xy={usingClientEntryPoint:!1,Events:[qo,Sr,vs,Qf,eh,uu]},ao={findFiberByHostInstance:Zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sy={bundleType:ao.bundleType,version:ao.version,rendererPackageName:ao.rendererPackageName,rendererConfig:ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:En.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ih(t),t===null?null:t.stateNode},findFiberByHostInstance:ao.findFiberByHostInstance||yy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fi.isDisabled&&fi.supportsFiber)try{ps=fi.inject(Sy),an=fi}catch{}}kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xy;kt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gu(e))throw Error(ae(200));return gy(t,e,null,n)};kt.createRoot=function(t,e){if(!gu(t))throw Error(ae(299));var n=!1,r="",o=Up;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=hu(t,1,!1,null,null,n,!1,r,o),t[yn]=e.current,Do(t.nodeType===8?t.parentNode:t),new mu(e)};kt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=ih(e),t=t===null?null:t.stateNode,t};kt.flushSync=function(t){return ar(t)};kt.hydrate=function(t,e,n){if(!Is(e))throw Error(ae(200));return bs(null,t,e,!0,n)};kt.hydrateRoot=function(t,e,n){if(!gu(t))throw Error(ae(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",s=Up;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=Op(e,null,t,1,n??null,o,!1,i,s),t[yn]=e.current,Do(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new Ns(e)};kt.render=function(t,e,n){if(!Is(e))throw Error(ae(200));return bs(null,t,e,!1,n)};kt.unmountComponentAtNode=function(t){if(!Is(t))throw Error(ae(40));return t._reactRootContainer?(ar(function(){bs(null,null,t,!1,function(){t._reactRootContainer=null,t[yn]=null})}),!0):!1};kt.unstable_batchedUpdates=uu;kt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Is(n))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return bs(t,e,n,!1,r)};kt.version="18.3.1-next-f1338f8080-20240426";function Fp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Fp)}catch(t){console.error(t)}}Fp(),Ff.exports=kt;var Ey=Ff.exports,Vc=Ey;ma.createRoot=Vc.createRoot,ma.hydrateRoot=Vc.hydrateRoot;let hi;const Ty=new Uint8Array(16);function wy(){if(!hi&&(hi=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!hi))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return hi(Ty)}const nt=[];for(let t=0;t<256;++t)nt.push((t+256).toString(16).slice(1));function Cy(t,e=0){return nt[t[e+0]]+nt[t[e+1]]+nt[t[e+2]]+nt[t[e+3]]+"-"+nt[t[e+4]]+nt[t[e+5]]+"-"+nt[t[e+6]]+nt[t[e+7]]+"-"+nt[t[e+8]]+nt[t[e+9]]+"-"+nt[t[e+10]]+nt[t[e+11]]+nt[t[e+12]]+nt[t[e+13]]+nt[t[e+14]]+nt[t[e+15]]}const _y=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),zc={randomUUID:_y};function ca(t,e,n){if(zc.randomUUID&&!t)return zc.randomUUID();t=t||{};const r=t.random||(t.rng||wy)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Cy(r)}const Ny="SintongBangtongDB",Vn="projects",yu=()=>new Promise((t,e)=>{if(typeof window>"u"||!window.indexedDB){e(new Error("IndexedDB is not supported"));return}const n=indexedDB.open(Ny,1);n.onupgradeneeded=r=>{const o=r.target.result;o.objectStoreNames.contains(Vn)||o.createObjectStore(Vn)},n.onsuccess=()=>t(n.result),n.onerror=()=>e(n.error)}),mo=async(t,e)=>{try{const n=await yu();return new Promise((r,o)=>{const a=n.transaction(Vn,"readwrite").objectStore(Vn).put(e,t);a.onsuccess=()=>r(),a.onerror=()=>o(a.error)})}catch(n){console.error("IndexedDB Save Error:",n)}},go=async t=>{try{const e=await yu();return new Promise((n,r)=>{const s=e.transaction(Vn,"readonly").objectStore(Vn).get(t);s.onsuccess=()=>n(s.result),s.onerror=()=>r(s.error)})}catch(e){return console.error("IndexedDB Load Error:",e),null}},Mi=async t=>{try{const e=await yu();return new Promise((n,r)=>{const s=e.transaction(Vn,"readwrite").objectStore(Vn).delete(t);s.onsuccess=()=>n(),s.onerror=()=>r(s.error)})}catch(e){console.error("IndexedDB Delete Error:",e)}},Gp=ne.createContext(void 0),$c=`[  ]
1. :    . (  ,      )
2.   ():
   -   **()  ** . (     ).
   -       .
   -  :  ** **. (   ).
   -  : , ,   .
3.   ():
   -    .   .
   -  :  (),   /, , ,  .
   -   .`,Iy=({children:t})=>{const[e,n]=ne.useState(""),[r,o]=ne.useState(""),[i,s]=ne.useState([]),[a,u]=ne.useState("webtoon"),[c,f]=ne.useState("16:9"),[m,p]=ne.useState([]),[g,E]=ne.useState([]),[v,T]=ne.useState([]),[y,x]=ne.useState([]),[w,_]=ne.useState(!0),[b,M]=ne.useState($c),[R,F]=ne.useState({}),[D,V]=ne.useState(!1),[K,A]=ne.useState(null),[z,C]=ne.useState(null);ne.useEffect(()=>{if(i.length>0){const ve=i.map(ee=>`[${ee.title}]
${ee.content}`).join(`

`);o(ve)}},[i]),ne.useEffect(()=>{(async()=>{const ee=localStorage.getItem("sb_api_key");ee&&n(ee);try{let le=await go("currentProject");if(!le){const te=localStorage.getItem("sb_project_data");if(te)try{le=JSON.parse(te)}catch(xe){console.error("Failed to parse LocalStorage data",xe)}}le&&(o(le.script||""),le.scriptSegments&&le.scriptSegments.length>0?s(le.scriptSegments):le.script&&!le.scriptSegments&&s([{id:ca(),title:" ",content:le.script}]),u(le.selectedStyle||"webtoon"),p(le.scenes||[]),E(le.characters||[]),T(le.referenceImages||[]),x(le.props||[]),le.globalAspectRatio&&f(le.globalAspectRatio),le.globalScenePrompt&&M(le.globalScenePrompt))}catch(le){console.error("Load failed",le)}finally{V(!0)}})()},[]);const q=ve=>{o(ve),i.length===0&&s([{id:ca(),title:" ",content:ve}])},ue=(ve,ee)=>{const le={id:ca(),title:ve,content:ee};s(te=>[...te,le])},$=ve=>{s(ee=>ee.filter(le=>le.id!==ve))},Y=(ve,ee)=>{s(le=>le.map(te=>te.id===ve?{...te,content:ee}:te))},L=()=>{s([]),o("")},Z=()=>{mo("currentProject",{script:r,scriptSegments:i,selectedStyle:a,scenes:m,characters:g,referenceImages:v,props:y,globalAspectRatio:c,globalScenePrompt:b,userOptions:R}).catch(ee=>{console.warn("Failed to save to IndexedDB",ee),B("   (   )","error")})};ne.useEffect(()=>{if(!D)return;const ve=setTimeout(Z,2e3);return()=>clearTimeout(ve)},[r,i,a,m,g,v,y,c,b,R,D]),ne.useEffect(()=>{e&&localStorage.setItem("sb_api_key",e)},[e]);const G=async()=>{o(""),s([]),p([]),E([]),T([]),x([]),M($c),F({}),localStorage.removeItem("sb_project_data"),await Mi("currentProject"),B(" . (  )","success")},B=(ve,ee="success")=>{A({message:ve,type:ee})},me=()=>A(null),de=ve=>C(ve),re=()=>C(null),_e=(ve,ee)=>{F(le=>({...le,[ve]:[...le[ve]||[],ee]})),B(`  '${ee.label}'() .`,"success")},Ie=(ve,ee)=>{F(le=>({...le,[ve]:(le[ve]||[]).filter(te=>te.label!==ee)})),B(` '${ee}'() .`,"success")};return h.jsx(Gp.Provider,{value:{apiKey:e,setApiKey:n,script:r,setScript:q,scriptSegments:i,addScriptSegment:ue,removeScriptSegment:$,updateScriptSegment:Y,clearScriptSegments:L,selectedStyle:a,setSelectedStyle:u,globalAspectRatio:c,setGlobalAspectRatio:f,scenes:m,setScenes:p,characters:g,setCharacters:E,referenceImages:v,setReferenceImages:T,props:y,setProps:x,isContinuityMode:w,setIsContinuityMode:_,globalScenePrompt:b,setGlobalScenePrompt:M,userOptions:R,addUserOption:_e,removeUserOption:Ie,saveProject:Z,resetProject:G,toast:K,showToast:B,closeToast:me,modalConfig:z,openModal:de,closeModal:re},children:t})},Qt=()=>{const t=ne.useContext(Gp);if(!t)throw new Error("useProject must be used within a ProjectProvider");return t};var by={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Ay,Ry;function ky(){return{geminiUrl:Ay,vertexUrl:Ry}}function Py(t,e,n,r){var o,i;if(!(t!=null&&t.baseUrl)){const s=ky();return e?(o=s.vertexUrl)!==null&&o!==void 0?o:n:(i=s.geminiUrl)!==null&&i!==void 0?i:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tn{}function ge(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const i=e[o];return i!=null?String(i):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function d(t,e,n){for(let i=0;i<e.length-1;i++){const s=e[i];if(s.endsWith("[]")){const a=s.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(t[a])){const u=t[a];if(Array.isArray(n))for(let c=0;c<u.length;c++){const f=u[c];d(f,e.slice(i+1),n[c])}else for(const c of u)d(c,e.slice(i+1),n)}return}else if(s.endsWith("[0]")){const a=s.slice(0,-3);a in t||(t[a]=[{}]);const u=t[a];d(u[0],e.slice(i+1),n);return}(!t[s]||typeof t[s]!="object")&&(t[s]={}),t=t[s]}const r=e[e.length-1],o=t[r];if(o!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===o)return;if(typeof o=="object"&&typeof n=="object"&&o!==null&&n!==null)Object.assign(o,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function l(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const o=e[r];if(o.endsWith("[]")){const i=o.slice(0,-2);if(i in t){const s=t[i];return Array.isArray(s)?s.map(a=>l(a,e.slice(r+1),n)):n}else return n}else t=t[o]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function My(t,e){for(const[n,r]of Object.entries(e)){const o=n.split("."),i=r.split("."),s=new Set;let a=-1;for(let u=0;u<o.length;u++)if(o[u]==="*"){a=u;break}if(a!==-1&&i.length>a)for(let u=a;u<i.length;u++){const c=i[u];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&s.add(c)}ll(t,o,i,0,s)}}function ll(t,e,n,r,o){if(r>=e.length||typeof t!="object"||t===null)return;const i=e[r];if(i.endsWith("[]")){const s=i.slice(0,-2),a=t;if(s in a&&Array.isArray(a[s]))for(const u of a[s])ll(u,e,n,r+1,o)}else if(i==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const s=t,a=Object.keys(s).filter(c=>!c.startsWith("_")&&!o.has(c)),u={};for(const c of a)u[c]=s[c];for(const[c,f]of Object.entries(u)){const m=[];for(const p of n.slice(r))p==="*"?m.push(c):m.push(p);d(s,m,f)}for(const c of a)delete s[c]}}else{const s=t;i in s&&ll(s[i],e,n,r+1,o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vu(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ly(t){const e={},n=l(t,["operationName"]);n!=null&&d(e,["operationName"],n);const r=l(t,["resourceName"]);return r!=null&&d(e,["_url","resourceName"],r),e}function Dy(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["metadata"]);r!=null&&d(e,["metadata"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);i!=null&&d(e,["error"],i);const s=l(t,["response","generateVideoResponse"]);return s!=null&&d(e,["response"],Uy(s)),e}function Oy(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["metadata"]);r!=null&&d(e,["metadata"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);i!=null&&d(e,["error"],i);const s=l(t,["response"]);return s!=null&&d(e,["response"],Fy(s)),e}function Uy(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Gy(s))),d(e,["generatedVideos"],i)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);const o=l(t,["raiMediaFilteredReasons"]);return o!=null&&d(e,["raiMediaFilteredReasons"],o),e}function Fy(t){const e={},n=l(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>By(s))),d(e,["generatedVideos"],i)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);const o=l(t,["raiMediaFilteredReasons"]);return o!=null&&d(e,["raiMediaFilteredReasons"],o),e}function Gy(t){const e={},n=l(t,["video"]);return n!=null&&d(e,["video"],Wy(n)),e}function By(t){const e={},n=l(t,["_self"]);return n!=null&&d(e,["video"],qy(n)),e}function Hy(t){const e={},n=l(t,["operationName"]);return n!=null&&d(e,["_url","operationName"],n),e}function Vy(t){const e={},n=l(t,["operationName"]);return n!=null&&d(e,["_url","operationName"],n),e}function zy(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["metadata"]);r!=null&&d(e,["metadata"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);i!=null&&d(e,["error"],i);const s=l(t,["response"]);return s!=null&&d(e,["response"],$y(s)),e}function $y(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["parent"]);r!=null&&d(e,["parent"],r);const o=l(t,["documentName"]);return o!=null&&d(e,["documentName"],o),e}function Bp(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["metadata"]);r!=null&&d(e,["metadata"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);i!=null&&d(e,["error"],i);const s=l(t,["response"]);return s!=null&&d(e,["response"],jy(s)),e}function jy(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["parent"]);r!=null&&d(e,["parent"],r);const o=l(t,["documentName"]);return o!=null&&d(e,["documentName"],o),e}function Wy(t){const e={},n=l(t,["uri"]);n!=null&&d(e,["uri"],n);const r=l(t,["encodedVideo"]);r!=null&&d(e,["videoBytes"],vu(r));const o=l(t,["encoding"]);return o!=null&&d(e,["mimeType"],o),e}function qy(t){const e={},n=l(t,["gcsUri"]);n!=null&&d(e,["uri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&d(e,["videoBytes"],vu(r));const o=l(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var jc;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(jc||(jc={}));var Wc;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Wc||(Wc={}));var qc;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(qc||(qc={}));var kn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(kn||(kn={}));var Yc;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Yc||(Yc={}));var Kc;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Kc||(Kc={}));var Jc;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Jc||(Jc={}));var Xc;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Xc||(Xc={}));var Zc;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Zc||(Zc={}));var Qc;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(Qc||(Qc={}));var Ir;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(Ir||(Ir={}));var ed;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(ed||(ed={}));var br;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(br||(br={}));var td;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(td||(td={}));var nd;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(nd||(nd={}));var rd;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(rd||(rd={}));var od;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(od||(od={}));var id;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(id||(id={}));var sd;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(sd||(sd={}));var ss;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(ss||(ss={}));var ad;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ad||(ad={}));var ld;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(ld||(ld={}));var ud;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ud||(ud={}));var ul;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(ul||(ul={}));var cd;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(cd||(cd={}));var dd;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(dd||(dd={}));var fd;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(fd||(fd={}));var hd;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(hd||(hd={}));var pd;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(pd||(pd={}));var md;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(md||(md={}));var gd;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(gd||(gd={}));var yd;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(yd||(yd={}));var vd;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(vd||(vd={}));var xd;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(xd||(xd={}));var Sd;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Sd||(Sd={}));var Ed;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Ed||(Ed={}));var Td;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Td||(Td={}));var wd;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(wd||(wd={}));var Cd;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Cd||(Cd={}));var _d;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(_d||(_d={}));var Nd;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Nd||(Nd={}));var Id;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Id||(Id={}));var bd;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(bd||(bd={}));var Ad;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(Ad||(Ad={}));var Rd;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Rd||(Rd={}));var kd;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(kd||(kd={}));var Pd;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Pd||(Pd={}));var Md;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Md||(Md={}));var Ld;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Ld||(Ld={}));var Dd;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Dd||(Dd={}));var Od;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Od||(Od={}));var Ud;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Ud||(Ud={}));var Fd;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Fd||(Fd={}));var Gd;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Gd||(Gd={}));var Bd;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Bd||(Bd={}));var Ar;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Ar||(Ar={}));class cl{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class lo{get text(){var e,n,r,o,i,s,a,u;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",f=!1;const m=[];for(const p of(u=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&u!==void 0?u:[]){for(const[g,E]of Object.entries(p))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(E!==null||E!==void 0)&&m.push(g);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,c+=p.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?c:void 0}get data(){var e,n,r,o,i,s,a,u;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const f=[];for(const m of(u=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&u!==void 0?u:[]){for(const[p,g]of Object.entries(m))p!=="inlineData"&&(g!==null||g!==void 0)&&f.push(p);m.inlineData&&typeof m.inlineData.data=="string"&&(c+=atob(m.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,n,r,o,i,s,a,u;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(u=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||u===void 0?void 0:u.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,n,r,o,i,s,a,u,c;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(u=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||u===void 0?void 0:u.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,n,r,o,i,s,a,u,c;if(((o=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(u=(a=(s=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||u===void 0?void 0:u.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(c=f==null?void 0:f[0])===null||c===void 0?void 0:c.output}}class Hd{}class Vd{}class Yy{}class Ky{}class Jy{}class Xy{}class zd{}class $d{}class jd{}class Zy{}class as{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new as;let o;const i=e;return n?o=Oy(i):o=Dy(i),Object.assign(r,o),r}}class Wd{}class qd{}class Yd{}class Kd{}class Qy{}class ev{}class tv{}class xu{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new xu,i=zy(e);return Object.assign(r,i),r}}class nv{}class rv{}class ov{}class Jd{}class iv{get text(){var e,n,r;let o="",i=!1;const s=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,c]of Object.entries(a))u!=="text"&&u!=="thought"&&c!==null&&s.push(u);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;i=!0,o+=a.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?o:void 0}get data(){var e,n,r;let o="";const i=[];for(const s of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,u]of Object.entries(s))a!=="inlineData"&&u!==null&&i.push(a);s.inlineData&&typeof s.inlineData.data=="string"&&(o+=atob(s.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class sv{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Su{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Su,i=Bp(e);return Object.assign(r,i),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ke(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Hp(t,e){const n=ke(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function Vp(t){return Array.isArray(t)?t.map(e=>ls(e)):[ls(t)]}function ls(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function zp(t){const e=ls(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function $p(t){const e=ls(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Xd(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function jp(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Xd(e)):[Xd(t)]}function dl(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Zd(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Qd(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ct(t){if(t==null)throw new Error("ContentUnion is required");return dl(t)?t:{role:"user",parts:jp(t)}}function Eu(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=ct(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=ct(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ct(n)):[ct(e)]}function Gt(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Zd(t)||Qd(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ct(t)]}const e=[],n=[],r=dl(t[0]);for(const o of t){const i=dl(o);if(i!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(i)e.push(o);else{if(Zd(o)||Qd(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(o)}}return r||e.push({role:"user",parts:jp(n)}),e}function av(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(kn).includes(n[0].toUpperCase())?n[0].toUpperCase():kn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(kn).includes(r.toUpperCase())?r.toUpperCase():kn.TYPE_UNSPECIFIED})}}function Ur(t){const e={},n=["items"],r=["anyOf"],o=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=t.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,t=i[1]):i[1].type==="null"&&(e.nullable=!0,t=i[0])),t.type instanceof Array&&av(t.type,e);for(const[s,a]of Object.entries(t))if(a!=null)if(s=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(kn).includes(a.toUpperCase())?a.toUpperCase():kn.TYPE_UNSPECIFIED}else if(n.includes(s))e[s]=Ur(a);else if(r.includes(s)){const u=[];for(const c of a){if(c.type=="null"){e.nullable=!0;continue}u.push(Ur(c))}e[s]=u}else if(o.includes(s)){const u={};for(const[c,f]of Object.entries(a))u[c]=Ur(f);e[s]=u}else{if(s==="additionalProperties")continue;e[s]=a}return e}function Tu(t){return Ur(t)}function wu(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Cu(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Kr(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ur(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ur(e.response));return t}function Jr(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function lv(t,e,n,r=1){const o=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:o?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:o?`${n}/${e}`:e}function wn(t,e){if(typeof e!="string")throw new Error("name must be a string");return lv(t,e,"cachedContents")}function Wp(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Wn(t){return vu(t)}function uv(t){return t!=null&&typeof t=="object"&&"name"in t}function cv(t){return t!=null&&typeof t=="object"&&"video"in t}function dv(t){return t!=null&&typeof t=="object"&&"uri"in t}function qp(t){var e;let n;if(uv(t)&&(n=t.name),!(dv(t)&&(n=t.uri,n===void 0))&&!(cv(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const o=n.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${n}`);n=o[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Yp(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function Kp(t){for(const e of["models","tunedModels","publisherModels"])if(fv(t,e))return t[e];return[]}function fv(t,e){return t!==null&&typeof t=="object"&&e in t}function hv(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function pv(t,e={}){const n=[],r=new Set;for(const o of t){const i=o.name;if(r.has(i))throw new Error(`Duplicate function name ${i} found in MCP tools. Please ensure function names are unique.`);r.add(i);const s=hv(o,e);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function Jp(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,o=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(o>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function mv(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Xp(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const o=n.inlinedResponses;if(!Array.isArray(o)||o.length===0)return t;let i=!1;for(const s of o){if(typeof s!="object"||s===null)continue;const u=s.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){i=!0;break}}return i&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Xr(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Zp(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gv(t){const e={},n=l(t,["responsesFile"]);n!=null&&d(e,["fileName"],n);const r=l(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Jv(s))),d(e,["inlinedResponses"],i)}const o=l(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["inlinedEmbedContentResponses"],i)}return e}function yv(t){const e={},n=l(t,["predictionsFormat"]);n!=null&&d(e,["format"],n);const r=l(t,["gcsDestination","outputUriPrefix"]);r!=null&&d(e,["gcsUri"],r);const o=l(t,["bigqueryDestination","outputUri"]);return o!=null&&d(e,["bigqueryUri"],o),e}function vv(t){const e={},n=l(t,["format"]);n!=null&&d(e,["predictionsFormat"],n);const r=l(t,["gcsUri"]);r!=null&&d(e,["gcsDestination","outputUriPrefix"],r);const o=l(t,["bigqueryUri"]);if(o!=null&&d(e,["bigqueryDestination","outputUri"],o),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(l(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Li(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["metadata","displayName"]);r!=null&&d(e,["displayName"],r);const o=l(t,["metadata","state"]);o!=null&&d(e,["state"],Zp(o));const i=l(t,["metadata","createTime"]);i!=null&&d(e,["createTime"],i);const s=l(t,["metadata","endTime"]);s!=null&&d(e,["endTime"],s);const a=l(t,["metadata","updateTime"]);a!=null&&d(e,["updateTime"],a);const u=l(t,["metadata","model"]);u!=null&&d(e,["model"],u);const c=l(t,["metadata","output"]);return c!=null&&d(e,["dest"],gv(Xp(c))),e}function fl(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["displayName"]);r!=null&&d(e,["displayName"],r);const o=l(t,["state"]);o!=null&&d(e,["state"],Zp(o));const i=l(t,["error"]);i!=null&&d(e,["error"],i);const s=l(t,["createTime"]);s!=null&&d(e,["createTime"],s);const a=l(t,["startTime"]);a!=null&&d(e,["startTime"],a);const u=l(t,["endTime"]);u!=null&&d(e,["endTime"],u);const c=l(t,["updateTime"]);c!=null&&d(e,["updateTime"],c);const f=l(t,["model"]);f!=null&&d(e,["model"],f);const m=l(t,["inputConfig"]);m!=null&&d(e,["src"],xv(m));const p=l(t,["outputConfig"]);p!=null&&d(e,["dest"],yv(Xp(p)));const g=l(t,["completionStats"]);return g!=null&&d(e,["completionStats"],g),e}function xv(t){const e={},n=l(t,["instancesFormat"]);n!=null&&d(e,["format"],n);const r=l(t,["gcsSource","uris"]);r!=null&&d(e,["gcsUri"],r);const o=l(t,["bigquerySource","inputUri"]);return o!=null&&d(e,["bigqueryUri"],o),e}function Sv(t,e){const n={};if(l(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=l(e,["fileName"]);r!=null&&d(n,["fileName"],r);const o=l(e,["inlinedRequests"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>Kv(t,s))),d(n,["requests","requests"],i)}return n}function Ev(t){const e={},n=l(t,["format"]);n!=null&&d(e,["instancesFormat"],n);const r=l(t,["gcsUri"]);r!=null&&d(e,["gcsSource","uris"],r);const o=l(t,["bigqueryUri"]);if(o!=null&&d(e,["bigquerySource","inputUri"],o),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Tv(t){const e={},n=l(t,["data"]);if(n!=null&&d(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function wv(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],Xr(t,r)),n}function Cv(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],Xr(t,r)),n}function _v(t){const e={},n=l(t,["content"]);n!=null&&d(e,["content"],n);const r=l(t,["citationMetadata"]);r!=null&&d(e,["citationMetadata"],Nv(r));const o=l(t,["tokenCount"]);o!=null&&d(e,["tokenCount"],o);const i=l(t,["finishReason"]);i!=null&&d(e,["finishReason"],i);const s=l(t,["avgLogprobs"]);s!=null&&d(e,["avgLogprobs"],s);const a=l(t,["groundingMetadata"]);a!=null&&d(e,["groundingMetadata"],a);const u=l(t,["index"]);u!=null&&d(e,["index"],u);const c=l(t,["logprobsResult"]);c!=null&&d(e,["logprobsResult"],c);const f=l(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>g)),d(e,["safetyRatings"],p)}const m=l(t,["urlContextMetadata"]);return m!=null&&d(e,["urlContextMetadata"],m),e}function Nv(t){const e={},n=l(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>o)),d(e,["citations"],r)}return e}function Qp(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>rx(i))),d(e,["parts"],o)}const r=l(t,["role"]);return r!=null&&d(e,["role"],r),e}function Iv(t,e){const n={},r=l(t,["displayName"]);if(e!==void 0&&r!=null&&d(e,["batch","displayName"],r),l(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function bv(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);const o=l(t,["dest"]);return e!==void 0&&o!=null&&d(e,["outputConfig"],vv(mv(o))),n}function ef(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["src"]);o!=null&&d(n,["batch","inputConfig"],Sv(t,Jp(t,o)));const i=l(e,["config"]);return i!=null&&Iv(i,n),n}function Av(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["model"],ke(t,r));const o=l(e,["src"]);o!=null&&d(n,["inputConfig"],Ev(Jp(t,o)));const i=l(e,["config"]);return i!=null&&bv(i,n),n}function Rv(t,e){const n={},r=l(t,["displayName"]);return e!==void 0&&r!=null&&d(e,["batch","displayName"],r),n}function kv(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["src"]);o!=null&&d(n,["batch","inputConfig"],Fv(t,o));const i=l(e,["config"]);return i!=null&&Rv(i,n),n}function Pv(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],Xr(t,r)),n}function Mv(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],Xr(t,r)),n}function Lv(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);return i!=null&&d(e,["error"],i),e}function Dv(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);return i!=null&&d(e,["error"],i),e}function Ov(t,e){const n={},r=l(e,["contents"]);if(r!=null){let i=Eu(t,r);Array.isArray(i)&&(i=i.map(s=>s)),d(n,["requests[]","request","content"],i)}const o=l(e,["config"]);return o!=null&&(d(n,["_self"],Uv(o,n)),My(n,{"requests[].*":"requests[].request.*"})),n}function Uv(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&d(e,["requests[]","taskType"],r);const o=l(t,["title"]);e!==void 0&&o!=null&&d(e,["requests[]","title"],o);const i=l(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&d(e,["requests[]","outputDimensionality"],i),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Fv(t,e){const n={},r=l(e,["fileName"]);r!=null&&d(n,["file_name"],r);const o=l(e,["inlinedRequests"]);return o!=null&&d(n,["requests"],Ov(t,o)),n}function Gv(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Bv(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const r=l(t,["args"]);r!=null&&d(e,["args"],r);const o=l(t,["name"]);if(o!=null&&d(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Hv(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);if(r!=null&&d(e,["allowedFunctionNames"],r),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Vv(t,e,n){const r={},o=l(e,["systemInstruction"]);n!==void 0&&o!=null&&d(n,["systemInstruction"],Qp(ct(o)));const i=l(e,["temperature"]);i!=null&&d(r,["temperature"],i);const s=l(e,["topP"]);s!=null&&d(r,["topP"],s);const a=l(e,["topK"]);a!=null&&d(r,["topK"],a);const u=l(e,["candidateCount"]);u!=null&&d(r,["candidateCount"],u);const c=l(e,["maxOutputTokens"]);c!=null&&d(r,["maxOutputTokens"],c);const f=l(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);const m=l(e,["responseLogprobs"]);m!=null&&d(r,["responseLogprobs"],m);const p=l(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);const g=l(e,["presencePenalty"]);g!=null&&d(r,["presencePenalty"],g);const E=l(e,["frequencyPenalty"]);E!=null&&d(r,["frequencyPenalty"],E);const v=l(e,["seed"]);v!=null&&d(r,["seed"],v);const T=l(e,["responseMimeType"]);T!=null&&d(r,["responseMimeType"],T);const y=l(e,["responseSchema"]);y!=null&&d(r,["responseSchema"],Tu(y));const x=l(e,["responseJsonSchema"]);if(x!=null&&d(r,["responseJsonSchema"],x),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=l(e,["safetySettings"]);if(n!==void 0&&w!=null){let z=w;Array.isArray(z)&&(z=z.map(C=>ox(C))),d(n,["safetySettings"],z)}const _=l(e,["tools"]);if(n!==void 0&&_!=null){let z=Jr(_);Array.isArray(z)&&(z=z.map(C=>sx(Kr(C)))),d(n,["tools"],z)}const b=l(e,["toolConfig"]);if(n!==void 0&&b!=null&&d(n,["toolConfig"],ix(b)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=l(e,["cachedContent"]);n!==void 0&&M!=null&&d(n,["cachedContent"],wn(t,M));const R=l(e,["responseModalities"]);R!=null&&d(r,["responseModalities"],R);const F=l(e,["mediaResolution"]);F!=null&&d(r,["mediaResolution"],F);const D=l(e,["speechConfig"]);if(D!=null&&d(r,["speechConfig"],wu(D)),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const V=l(e,["thinkingConfig"]);V!=null&&d(r,["thinkingConfig"],V);const K=l(e,["imageConfig"]);K!=null&&d(r,["imageConfig"],Yv(K));const A=l(e,["enableEnhancedCivicAnswers"]);return A!=null&&d(r,["enableEnhancedCivicAnswers"],A),r}function zv(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>_v(c))),d(e,["candidates"],u)}const o=l(t,["modelVersion"]);o!=null&&d(e,["modelVersion"],o);const i=l(t,["promptFeedback"]);i!=null&&d(e,["promptFeedback"],i);const s=l(t,["responseId"]);s!=null&&d(e,["responseId"],s);const a=l(t,["usageMetadata"]);return a!=null&&d(e,["usageMetadata"],a),e}function $v(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],Xr(t,r)),n}function jv(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],Xr(t,r)),n}function Wv(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function qv(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function Yv(t){const e={},n=l(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);const r=l(t,["imageSize"]);if(r!=null&&d(e,["imageSize"],r),l(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(l(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Kv(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["request","model"],ke(t,r));const o=l(e,["contents"]);if(o!=null){let a=Gt(o);Array.isArray(a)&&(a=a.map(u=>Qp(u))),d(n,["request","contents"],a)}const i=l(e,["metadata"]);i!=null&&d(n,["metadata"],i);const s=l(e,["config"]);return s!=null&&d(n,["request","generationConfig"],Vv(t,s,l(n,["request"],{}))),n}function Jv(t){const e={},n=l(t,["response"]);n!=null&&d(e,["response"],zv(n));const r=l(t,["error"]);return r!=null&&d(e,["error"],r),e}function Xv(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const o=l(t,["pageToken"]);if(e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),l(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function Zv(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const o=l(t,["pageToken"]);e!==void 0&&o!=null&&d(e,["_query","pageToken"],o);const i=l(t,["filter"]);return e!==void 0&&i!=null&&d(e,["_query","filter"],i),n}function Qv(t){const e={},n=l(t,["config"]);return n!=null&&Xv(n,e),e}function ex(t){const e={},n=l(t,["config"]);return n!=null&&Zv(n,e),e}function tx(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["operations"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>Li(s))),d(e,["batchJobs"],i)}return e}function nx(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["batchPredictionJobs"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>fl(s))),d(e,["batchJobs"],i)}return e}function rx(t){const e={},n=l(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const o=l(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);const i=l(t,["fileData"]);i!=null&&d(e,["fileData"],Gv(i));const s=l(t,["functionCall"]);s!=null&&d(e,["functionCall"],Bv(s));const a=l(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&d(e,["inlineData"],Tv(u));const c=l(t,["text"]);c!=null&&d(e,["text"],c);const f=l(t,["thought"]);f!=null&&d(e,["thought"],f);const m=l(t,["thoughtSignature"]);m!=null&&d(e,["thoughtSignature"],m);const p=l(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function ox(t){const e={},n=l(t,["category"]);if(n!=null&&d(e,["category"],n),l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=l(t,["threshold"]);return r!=null&&d(e,["threshold"],r),e}function ix(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&d(e,["functionCallingConfig"],Hv(n));const r=l(t,["retrievalConfig"]);return r!=null&&d(e,["retrievalConfig"],r),e}function sx(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),d(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearchRetrieval"]);r!=null&&d(e,["googleSearchRetrieval"],r);const o=l(t,["computerUse"]);o!=null&&d(e,["computerUse"],o);const i=l(t,["fileSearch"]);i!=null&&d(e,["fileSearch"],i);const s=l(t,["codeExecution"]);if(s!=null&&d(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],Wv(a));const u=l(t,["googleSearch"]);u!=null&&d(e,["googleSearch"],qv(u));const c=l(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Sn;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(Sn||(Sn={}));class cr{constructor(e,n,r,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,o)}init(e,n,r){var o,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!r||Object.keys(r).length===0?s={config:{}}:typeof r=="object"?s=Object.assign({},r):s=r,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(i=(o=s.config)===null||o===void 0?void 0:o.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ax extends Tn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new cr(Sn.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=ef(this.apiClient,e),r=n._url,o=ge("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,u=a.requests,c=[];for(const f of u){const m=Object.assign({},f);if(m.systemInstruction){const p=m.systemInstruction;delete m.systemInstruction;const g=m.request;g.systemInstruction=p,m.request=g}c.push(m)}return a.requests=c,delete n.config,delete n._url,delete n._query,{path:o,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},o=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${o}`),r.dest===void 0){const i=this.getGcsUri(e),s=this.getBigqueryUri(e);if(i)i.endsWith(".jsonl")?r.dest=`${i.slice(0,-6)}/dest`:r.dest=`${i}_dest_${o}`;else if(s)r.dest=`${s}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=Av(this.apiClient,e);return a=ge("batchPredictionJobs",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>fl(f))}else{const c=ef(this.apiClient,e);return a=ge("{model}:batchGenerateContent",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Li(f))}}async createEmbeddingsInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=kv(this.apiClient,e);return i=ge("{model}:asyncBatchEmbedContent",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>Li(u))}}async get(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=jv(this.apiClient,e);return a=ge("batchPredictionJobs/{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>fl(f))}else{const c=$v(this.apiClient,e);return a=ge("batches/{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>Li(f))}}async cancel(e){var n,r,o,i;let s="",a={};if(this.apiClient.isVertexAI()){const u=Cv(this.apiClient,e);s=ge("batchPredictionJobs/{name}:cancel",u._url),a=u._query,delete u._url,delete u._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const u=wv(this.apiClient,e);s=ge("batches/{name}:cancel",u._url),a=u._query,delete u._url,delete u._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=ex(e);return a=ge("batchPredictionJobs",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=nx(f),p=new Jd;return Object.assign(p,m),p})}else{const c=Qv(e);return a=ge("batches",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=tx(f),p=new Jd;return Object.assign(p,m),p})}}async delete(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=Mv(this.apiClient,e);return a=ge("batchPredictionJobs/{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>Dv(f))}else{const c=Pv(this.apiClient,e);return a=ge("batches/{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>Lv(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lx(t){const e={},n=l(t,["data"]);if(n!=null&&d(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function tf(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>kx(i))),d(e,["parts"],o)}const r=l(t,["role"]);return r!=null&&d(e,["role"],r),e}function ux(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);const o=l(t,["expireTime"]);e!==void 0&&o!=null&&d(e,["expireTime"],o);const i=l(t,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let f=Gt(s);Array.isArray(f)&&(f=f.map(m=>tf(m))),d(e,["contents"],f)}const a=l(t,["systemInstruction"]);e!==void 0&&a!=null&&d(e,["systemInstruction"],tf(ct(a)));const u=l(t,["tools"]);if(e!==void 0&&u!=null){let f=u;Array.isArray(f)&&(f=f.map(m=>Mx(m))),d(e,["tools"],f)}const c=l(t,["toolConfig"]);if(e!==void 0&&c!=null&&d(e,["toolConfig"],Px(c)),l(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function cx(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);const o=l(t,["expireTime"]);e!==void 0&&o!=null&&d(e,["expireTime"],o);const i=l(t,["displayName"]);e!==void 0&&i!=null&&d(e,["displayName"],i);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let m=Gt(s);Array.isArray(m)&&(m=m.map(p=>p)),d(e,["contents"],m)}const a=l(t,["systemInstruction"]);e!==void 0&&a!=null&&d(e,["systemInstruction"],ct(a));const u=l(t,["tools"]);if(e!==void 0&&u!=null){let m=u;Array.isArray(m)&&(m=m.map(p=>Lx(p))),d(e,["tools"],m)}const c=l(t,["toolConfig"]);e!==void 0&&c!=null&&d(e,["toolConfig"],c);const f=l(t,["kmsKeyName"]);return e!==void 0&&f!=null&&d(e,["encryption_spec","kmsKeyName"],f),n}function dx(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["model"],Hp(t,r));const o=l(e,["config"]);return o!=null&&ux(o,n),n}function fx(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["model"],Hp(t,r));const o=l(e,["config"]);return o!=null&&cx(o,n),n}function hx(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],wn(t,r)),n}function px(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],wn(t,r)),n}function mx(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function gx(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function yx(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function vx(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const r=l(t,["args"]);r!=null&&d(e,["args"],r);const o=l(t,["name"]);if(o!=null&&d(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function xx(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);if(r!=null&&d(e,["allowedFunctionNames"],r),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Sx(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&d(e,["description"],n);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["parameters"]);o!=null&&d(e,["parameters"],o);const i=l(t,["parametersJsonSchema"]);i!=null&&d(e,["parametersJsonSchema"],i);const s=l(t,["response"]);s!=null&&d(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&d(e,["responseJsonSchema"],a),e}function Ex(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],wn(t,r)),n}function Tx(t,e){const n={},r=l(e,["name"]);return r!=null&&d(n,["_url","name"],wn(t,r)),n}function wx(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function Cx(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function _x(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function Nx(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function Ix(t){const e={},n=l(t,["config"]);return n!=null&&_x(n,e),e}function bx(t){const e={},n=l(t,["config"]);return n!=null&&Nx(n,e),e}function Ax(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["cachedContents"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["cachedContents"],i)}return e}function Rx(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["cachedContents"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["cachedContents"],i)}return e}function kx(t){const e={},n=l(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const o=l(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);const i=l(t,["fileData"]);i!=null&&d(e,["fileData"],yx(i));const s=l(t,["functionCall"]);s!=null&&d(e,["functionCall"],vx(s));const a=l(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&d(e,["inlineData"],lx(u));const c=l(t,["text"]);c!=null&&d(e,["text"],c);const f=l(t,["thought"]);f!=null&&d(e,["thought"],f);const m=l(t,["thoughtSignature"]);m!=null&&d(e,["thoughtSignature"],m);const p=l(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function Px(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&d(e,["functionCallingConfig"],xx(n));const r=l(t,["retrievalConfig"]);return r!=null&&d(e,["retrievalConfig"],r),e}function Mx(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),d(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearchRetrieval"]);r!=null&&d(e,["googleSearchRetrieval"],r);const o=l(t,["computerUse"]);o!=null&&d(e,["computerUse"],o);const i=l(t,["fileSearch"]);i!=null&&d(e,["fileSearch"],i);const s=l(t,["codeExecution"]);if(s!=null&&d(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],wx(a));const u=l(t,["googleSearch"]);u!=null&&d(e,["googleSearch"],Cx(u));const c=l(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}function Lx(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>Sx(p))),d(e,["functionDeclarations"],m)}const r=l(t,["retrieval"]);r!=null&&d(e,["retrieval"],r);const o=l(t,["googleSearchRetrieval"]);o!=null&&d(e,["googleSearchRetrieval"],o);const i=l(t,["computerUse"]);if(i!=null&&d(e,["computerUse"],i),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&d(e,["codeExecution"],s);const a=l(t,["enterpriseWebSearch"]);a!=null&&d(e,["enterpriseWebSearch"],a);const u=l(t,["googleMaps"]);u!=null&&d(e,["googleMaps"],u);const c=l(t,["googleSearch"]);c!=null&&d(e,["googleSearch"],c);const f=l(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function Dx(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);const o=l(t,["expireTime"]);return e!==void 0&&o!=null&&d(e,["expireTime"],o),n}function Ox(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&d(e,["ttl"],r);const o=l(t,["expireTime"]);return e!==void 0&&o!=null&&d(e,["expireTime"],o),n}function Ux(t,e){const n={},r=l(e,["name"]);r!=null&&d(n,["_url","name"],wn(t,r));const o=l(e,["config"]);return o!=null&&Dx(o,n),n}function Fx(t,e){const n={},r=l(e,["name"]);r!=null&&d(n,["_url","name"],wn(t,r));const o=l(e,["config"]);return o!=null&&Ox(o,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gx extends Tn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new cr(Sn.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=fx(this.apiClient,e);return a=ge("cachedContents",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const c=dx(this.apiClient,e);return a=ge("cachedContents",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async get(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=Tx(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const c=Ex(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=px(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=gx(f),p=new Yd;return Object.assign(p,m),p})}else{const c=hx(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=mx(f),p=new Yd;return Object.assign(p,m),p})}}async update(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=Fx(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>f)}else{const c=Ux(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async listInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=bx(e);return a=ge("cachedContents",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=Rx(f),p=new Kd;return Object.assign(p,m),p})}else{const c=Ix(e);return a=ge("cachedContents",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=Ax(f),p=new Kd;return Object.assign(p,m),p})}}}function us(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function nf(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ce(t){return this instanceof Ce?(this.v=t,this):new Ce(t)}function Jt(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(g){return function(E){return Promise.resolve(E).then(g,m)}}function a(g,E){r[g]&&(o[g]=function(v){return new Promise(function(T,y){i.push([g,v,T,y])>1||u(g,v)})},E&&(o[g]=E(o[g])))}function u(g,E){try{c(r[g](E))}catch(v){p(i[0][3],v)}}function c(g){g.value instanceof Ce?Promise.resolve(g.value.v).then(f,m):p(i[0][2],g)}function f(g){u("next",g)}function m(g){u("throw",g)}function p(g,E){g(E),i.shift(),i.length&&u(i[0][0],i[0][1])}}function Xt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof nf=="function"?nf(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(s){return new Promise(function(a,u){s=t[i](s),o(a,u,s.done,s.value)})}}function o(i,s,a,u){Promise.resolve(u).then(function(c){i({value:c,done:a})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bx(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:em(n)}function em(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function Hx(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function rf(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const o=[];let i=!0;for(;r<n&&t[r].role==="model";)o.push(t[r]),i&&!em(t[r])&&(i=!1),r++;i?e.push(...o):e.pop()}return e}class Vx{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new zx(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class zx{constructor(e,n,r,o={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=o,this.history=i,this.sendPromise=Promise.resolve(),Hx(i)}async sendMessage(e){var n;await this.sendPromise;const r=ct(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,s,a;const u=await o,c=(s=(i=u.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content,f=u.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let p=[];f!=null&&(p=(a=f.slice(m))!==null&&a!==void 0?a:[]);const g=c?[c]:[];this.recordHistory(r,g,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var n;await this.sendPromise;const r=ct(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const i=await o;return this.processStreamResponse(i,r)}getHistory(e=!1){const n=e?rf(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Jt(this,arguments,function*(){var o,i,s,a,u,c;const f=[];try{for(var m=!0,p=Xt(e),g;g=yield Ce(p.next()),o=g.done,!o;m=!0){a=g.value,m=!1;const E=a;if(Bx(E)){const v=(c=(u=E.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content;v!==void 0&&f.push(v)}yield yield Ce(E)}}catch(E){i={error:E}}finally{try{!m&&!o&&(s=p.return)&&(yield Ce(s.call(p)))}finally{if(i)throw i.error}}this.recordHistory(n,f)})}recordHistory(e,n,r){let o=[];n.length>0&&n.every(i=>i.role!==void 0)?o=n:o.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...rf(r)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class As extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,As.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $x(t){const e={},n=l(t,["file"]);return n!=null&&d(e,["file"],n),e}function jx(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function Wx(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","file"],qp(n)),e}function qx(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function Yx(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","file"],qp(n)),e}function Kx(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function Jx(t){const e={},n=l(t,["config"]);return n!=null&&Kx(n,e),e}function Xx(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["files"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["files"],i)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zx extends Tn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new cr(Sn.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Jx(e);return i=ge("files",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const c=Xx(u),f=new nv;return Object.assign(f,c),f})}}async createInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=$x(e);return i=ge("upload/v1beta/files",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const c=jx(u),f=new rv;return Object.assign(f,c),f})}}async get(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Yx(e);return i=ge("files/{file}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Wx(e);return i=ge("files/{file}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const c=qx(u),f=new ov;return Object.assign(f,c),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Di(t){const e={},n=l(t,["data"]);if(n!=null&&d(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function Qx(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>mS(i))),d(e,["parts"],o)}const r=l(t,["role"]);return r!=null&&d(e,["role"],r),e}function eS(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function tS(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const r=l(t,["args"]);r!=null&&d(e,["args"],r);const o=l(t,["name"]);if(o!=null&&d(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function nS(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&d(e,["description"],n);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["parameters"]);o!=null&&d(e,["parameters"],o);const i=l(t,["parametersJsonSchema"]);i!=null&&d(e,["parametersJsonSchema"],i);const s=l(t,["response"]);s!=null&&d(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&d(e,["responseJsonSchema"],a),e}function rS(t){const e={},n=l(t,["modelSelectionConfig"]);n!=null&&d(e,["modelConfig"],n);const r=l(t,["responseJsonSchema"]);r!=null&&d(e,["responseJsonSchema"],r);const o=l(t,["audioTimestamp"]);o!=null&&d(e,["audioTimestamp"],o);const i=l(t,["candidateCount"]);i!=null&&d(e,["candidateCount"],i);const s=l(t,["enableAffectiveDialog"]);s!=null&&d(e,["enableAffectiveDialog"],s);const a=l(t,["frequencyPenalty"]);a!=null&&d(e,["frequencyPenalty"],a);const u=l(t,["logprobs"]);u!=null&&d(e,["logprobs"],u);const c=l(t,["maxOutputTokens"]);c!=null&&d(e,["maxOutputTokens"],c);const f=l(t,["mediaResolution"]);f!=null&&d(e,["mediaResolution"],f);const m=l(t,["presencePenalty"]);m!=null&&d(e,["presencePenalty"],m);const p=l(t,["responseLogprobs"]);p!=null&&d(e,["responseLogprobs"],p);const g=l(t,["responseMimeType"]);g!=null&&d(e,["responseMimeType"],g);const E=l(t,["responseModalities"]);E!=null&&d(e,["responseModalities"],E);const v=l(t,["responseSchema"]);v!=null&&d(e,["responseSchema"],v);const T=l(t,["routingConfig"]);T!=null&&d(e,["routingConfig"],T);const y=l(t,["seed"]);y!=null&&d(e,["seed"],y);const x=l(t,["speechConfig"]);x!=null&&d(e,["speechConfig"],x);const w=l(t,["stopSequences"]);w!=null&&d(e,["stopSequences"],w);const _=l(t,["temperature"]);_!=null&&d(e,["temperature"],_);const b=l(t,["thinkingConfig"]);b!=null&&d(e,["thinkingConfig"],b);const M=l(t,["topK"]);M!=null&&d(e,["topK"],M);const R=l(t,["topP"]);if(R!=null&&d(e,["topP"],R),l(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function oS(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function iS(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function sS(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],r);const o=l(t,["responseModalities"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","responseModalities"],o);const i=l(t,["temperature"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","temperature"],i);const s=l(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const u=l(t,["maxOutputTokens"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","maxOutputTokens"],u);const c=l(t,["mediaResolution"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","mediaResolution"],c);const f=l(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const m=l(t,["speechConfig"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","speechConfig"],Cu(m));const p=l(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);const g=l(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],g);const E=l(t,["systemInstruction"]);e!==void 0&&E!=null&&d(e,["setup","systemInstruction"],Qx(ct(E)));const v=l(t,["tools"]);if(e!==void 0&&v!=null){let M=Jr(v);Array.isArray(M)&&(M=M.map(R=>yS(Kr(R)))),d(e,["setup","tools"],M)}const T=l(t,["sessionResumption"]);e!==void 0&&T!=null&&d(e,["setup","sessionResumption"],gS(T));const y=l(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&d(e,["setup","inputAudioTranscription"],y);const x=l(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&d(e,["setup","outputAudioTranscription"],x);const w=l(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&d(e,["setup","realtimeInputConfig"],w);const _=l(t,["contextWindowCompression"]);e!==void 0&&_!=null&&d(e,["setup","contextWindowCompression"],_);const b=l(t,["proactivity"]);if(e!==void 0&&b!=null&&d(e,["setup","proactivity"],b),l(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function aS(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],rS(r));const o=l(t,["responseModalities"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","responseModalities"],o);const i=l(t,["temperature"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","temperature"],i);const s=l(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const u=l(t,["maxOutputTokens"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","maxOutputTokens"],u);const c=l(t,["mediaResolution"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","mediaResolution"],c);const f=l(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const m=l(t,["speechConfig"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","speechConfig"],Cu(m));const p=l(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);const g=l(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],g);const E=l(t,["systemInstruction"]);e!==void 0&&E!=null&&d(e,["setup","systemInstruction"],ct(E));const v=l(t,["tools"]);if(e!==void 0&&v!=null){let R=Jr(v);Array.isArray(R)&&(R=R.map(F=>vS(Kr(F)))),d(e,["setup","tools"],R)}const T=l(t,["sessionResumption"]);e!==void 0&&T!=null&&d(e,["setup","sessionResumption"],T);const y=l(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&d(e,["setup","inputAudioTranscription"],y);const x=l(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&d(e,["setup","outputAudioTranscription"],x);const w=l(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&d(e,["setup","realtimeInputConfig"],w);const _=l(t,["contextWindowCompression"]);e!==void 0&&_!=null&&d(e,["setup","contextWindowCompression"],_);const b=l(t,["proactivity"]);e!==void 0&&b!=null&&d(e,["setup","proactivity"],b);const M=l(t,["explicitVadSignal"]);return e!==void 0&&M!=null&&d(e,["setup","explicitVadSignal"],M),n}function lS(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["setup","model"],ke(t,r));const o=l(e,["config"]);return o!=null&&d(n,["config"],sS(o,n)),n}function uS(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["setup","model"],ke(t,r));const o=l(e,["config"]);return o!=null&&d(n,["config"],aS(o,n)),n}function cS(t){const e={},n=l(t,["musicGenerationConfig"]);return n!=null&&d(e,["musicGenerationConfig"],n),e}function dS(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>o)),d(e,["weightedPrompts"],r)}return e}function fS(t){const e={},n=l(t,["media"]);if(n!=null){let c=Vp(n);Array.isArray(c)&&(c=c.map(f=>Di(f))),d(e,["mediaChunks"],c)}const r=l(t,["audio"]);r!=null&&d(e,["audio"],Di($p(r)));const o=l(t,["audioStreamEnd"]);o!=null&&d(e,["audioStreamEnd"],o);const i=l(t,["video"]);i!=null&&d(e,["video"],Di(zp(i)));const s=l(t,["text"]);s!=null&&d(e,["text"],s);const a=l(t,["activityStart"]);a!=null&&d(e,["activityStart"],a);const u=l(t,["activityEnd"]);return u!=null&&d(e,["activityEnd"],u),e}function hS(t){const e={},n=l(t,["media"]);if(n!=null){let c=Vp(n);Array.isArray(c)&&(c=c.map(f=>f)),d(e,["mediaChunks"],c)}const r=l(t,["audio"]);r!=null&&d(e,["audio"],$p(r));const o=l(t,["audioStreamEnd"]);o!=null&&d(e,["audioStreamEnd"],o);const i=l(t,["video"]);i!=null&&d(e,["video"],zp(i));const s=l(t,["text"]);s!=null&&d(e,["text"],s);const a=l(t,["activityStart"]);a!=null&&d(e,["activityStart"],a);const u=l(t,["activityEnd"]);return u!=null&&d(e,["activityEnd"],u),e}function pS(t){const e={},n=l(t,["setupComplete"]);n!=null&&d(e,["setupComplete"],n);const r=l(t,["serverContent"]);r!=null&&d(e,["serverContent"],r);const o=l(t,["toolCall"]);o!=null&&d(e,["toolCall"],o);const i=l(t,["toolCallCancellation"]);i!=null&&d(e,["toolCallCancellation"],i);const s=l(t,["usageMetadata"]);s!=null&&d(e,["usageMetadata"],xS(s));const a=l(t,["goAway"]);a!=null&&d(e,["goAway"],a);const u=l(t,["sessionResumptionUpdate"]);u!=null&&d(e,["sessionResumptionUpdate"],u);const c=l(t,["voiceActivityDetectionSignal"]);return c!=null&&d(e,["voiceActivityDetectionSignal"],c),e}function mS(t){const e={},n=l(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const o=l(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);const i=l(t,["fileData"]);i!=null&&d(e,["fileData"],eS(i));const s=l(t,["functionCall"]);s!=null&&d(e,["functionCall"],tS(s));const a=l(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&d(e,["inlineData"],Di(u));const c=l(t,["text"]);c!=null&&d(e,["text"],c);const f=l(t,["thought"]);f!=null&&d(e,["thought"],f);const m=l(t,["thoughtSignature"]);m!=null&&d(e,["thoughtSignature"],m);const p=l(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function gS(t){const e={},n=l(t,["handle"]);if(n!=null&&d(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function yS(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),d(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearchRetrieval"]);r!=null&&d(e,["googleSearchRetrieval"],r);const o=l(t,["computerUse"]);o!=null&&d(e,["computerUse"],o);const i=l(t,["fileSearch"]);i!=null&&d(e,["fileSearch"],i);const s=l(t,["codeExecution"]);if(s!=null&&d(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],oS(a));const u=l(t,["googleSearch"]);u!=null&&d(e,["googleSearch"],iS(u));const c=l(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}function vS(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>nS(p))),d(e,["functionDeclarations"],m)}const r=l(t,["retrieval"]);r!=null&&d(e,["retrieval"],r);const o=l(t,["googleSearchRetrieval"]);o!=null&&d(e,["googleSearchRetrieval"],o);const i=l(t,["computerUse"]);if(i!=null&&d(e,["computerUse"],i),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&d(e,["codeExecution"],s);const a=l(t,["enterpriseWebSearch"]);a!=null&&d(e,["enterpriseWebSearch"],a);const u=l(t,["googleMaps"]);u!=null&&d(e,["googleMaps"],u);const c=l(t,["googleSearch"]);c!=null&&d(e,["googleSearch"],c);const f=l(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function xS(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&d(e,["promptTokenCount"],n);const r=l(t,["cachedContentTokenCount"]);r!=null&&d(e,["cachedContentTokenCount"],r);const o=l(t,["candidatesTokenCount"]);o!=null&&d(e,["responseTokenCount"],o);const i=l(t,["toolUsePromptTokenCount"]);i!=null&&d(e,["toolUsePromptTokenCount"],i);const s=l(t,["thoughtsTokenCount"]);s!=null&&d(e,["thoughtsTokenCount"],s);const a=l(t,["totalTokenCount"]);a!=null&&d(e,["totalTokenCount"],a);const u=l(t,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(E=>E)),d(e,["promptTokensDetails"],g)}const c=l(t,["cacheTokensDetails"]);if(c!=null){let g=c;Array.isArray(g)&&(g=g.map(E=>E)),d(e,["cacheTokensDetails"],g)}const f=l(t,["candidatesTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(E=>E)),d(e,["responseTokensDetails"],g)}const m=l(t,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(E=>E)),d(e,["toolUsePromptTokensDetails"],g)}const p=l(t,["trafficType"]);return p!=null&&d(e,["trafficType"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SS(t){const e={},n=l(t,["data"]);if(n!=null&&d(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function ES(t){const e={},n=l(t,["content"]);n!=null&&d(e,["content"],n);const r=l(t,["citationMetadata"]);r!=null&&d(e,["citationMetadata"],TS(r));const o=l(t,["tokenCount"]);o!=null&&d(e,["tokenCount"],o);const i=l(t,["finishReason"]);i!=null&&d(e,["finishReason"],i);const s=l(t,["avgLogprobs"]);s!=null&&d(e,["avgLogprobs"],s);const a=l(t,["groundingMetadata"]);a!=null&&d(e,["groundingMetadata"],a);const u=l(t,["index"]);u!=null&&d(e,["index"],u);const c=l(t,["logprobsResult"]);c!=null&&d(e,["logprobsResult"],c);const f=l(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>g)),d(e,["safetyRatings"],p)}const m=l(t,["urlContextMetadata"]);return m!=null&&d(e,["urlContextMetadata"],m),e}function TS(t){const e={},n=l(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>o)),d(e,["citations"],r)}return e}function wS(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["contents"]);if(o!=null){let i=Gt(o);Array.isArray(i)&&(i=i.map(s=>s)),d(n,["contents"],i)}return n}function CS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["tokensInfo"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),d(e,["tokensInfo"],o)}return e}function _S(t){const e={},n=l(t,["values"]);n!=null&&d(e,["values"],n);const r=l(t,["statistics"]);return r!=null&&d(e,["statistics"],NS(r)),e}function NS(t){const e={},n=l(t,["truncated"]);n!=null&&d(e,["truncated"],n);const r=l(t,["token_count"]);return r!=null&&d(e,["tokenCount"],r),e}function Rs(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>DE(i))),d(e,["parts"],o)}const r=l(t,["role"]);return r!=null&&d(e,["role"],r),e}function IS(t){const e={},n=l(t,["controlType"]);n!=null&&d(e,["controlType"],n);const r=l(t,["enableControlImageComputation"]);return r!=null&&d(e,["computeControl"],r),e}function bS(t){const e={};if(l(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function AS(t,e){const n={},r=l(t,["systemInstruction"]);e!==void 0&&r!=null&&d(e,["systemInstruction"],ct(r));const o=l(t,["tools"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>om(a))),d(e,["tools"],s)}const i=l(t,["generationConfig"]);return e!==void 0&&i!=null&&d(e,["generationConfig"],SE(i)),n}function RS(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["contents"]);if(o!=null){let s=Gt(o);Array.isArray(s)&&(s=s.map(a=>Rs(a))),d(n,["contents"],s)}const i=l(e,["config"]);return i!=null&&bS(i),n}function kS(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["contents"]);if(o!=null){let s=Gt(o);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["contents"],s)}const i=l(e,["config"]);return i!=null&&AS(i,n),n}function PS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["totalTokens"]);r!=null&&d(e,["totalTokens"],r);const o=l(t,["cachedContentTokenCount"]);return o!=null&&d(e,["cachedContentTokenCount"],o),e}function MS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["totalTokens"]);return r!=null&&d(e,["totalTokens"],r),e}function LS(t,e){const n={},r=l(e,["model"]);return r!=null&&d(n,["_url","name"],ke(t,r)),n}function DS(t,e){const n={},r=l(e,["model"]);return r!=null&&d(n,["_url","name"],ke(t,r)),n}function OS(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function US(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}function FS(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);const o=l(t,["negativePrompt"]);e!==void 0&&o!=null&&d(e,["parameters","negativePrompt"],o);const i=l(t,["numberOfImages"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&d(e,["parameters","aspectRatio"],s);const a=l(t,["guidanceScale"]);e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a);const u=l(t,["seed"]);e!==void 0&&u!=null&&d(e,["parameters","seed"],u);const c=l(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&d(e,["parameters","safetySetting"],c);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const m=l(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&d(e,["parameters","includeSafetyAttributes"],m);const p=l(t,["includeRaiReason"]);e!==void 0&&p!=null&&d(e,["parameters","includeRaiReason"],p);const g=l(t,["language"]);e!==void 0&&g!=null&&d(e,["parameters","language"],g);const E=l(t,["outputMimeType"]);e!==void 0&&E!=null&&d(e,["parameters","outputOptions","mimeType"],E);const v=l(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&d(e,["parameters","outputOptions","compressionQuality"],v);const T=l(t,["addWatermark"]);e!==void 0&&T!=null&&d(e,["parameters","addWatermark"],T);const y=l(t,["labels"]);e!==void 0&&y!=null&&d(e,["labels"],y);const x=l(t,["editMode"]);e!==void 0&&x!=null&&d(e,["parameters","editMode"],x);const w=l(t,["baseSteps"]);return e!==void 0&&w!=null&&d(e,["parameters","editConfig","baseSteps"],w),n}function GS(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);const i=l(e,["referenceImages"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>HE(u))),d(n,["instances[0]","referenceImages"],a)}const s=l(e,["config"]);return s!=null&&FS(s,n),n}function BS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>ks(i))),d(e,["generatedImages"],o)}return e}function HS(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&d(e,["requests[]","taskType"],r);const o=l(t,["title"]);e!==void 0&&o!=null&&d(e,["requests[]","title"],o);const i=l(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&d(e,["requests[]","outputDimensionality"],i),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function VS(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&d(e,["instances[]","task_type"],r);const o=l(t,["title"]);e!==void 0&&o!=null&&d(e,["instances[]","title"],o);const i=l(t,["outputDimensionality"]);e!==void 0&&i!=null&&d(e,["parameters","outputDimensionality"],i);const s=l(t,["mimeType"]);e!==void 0&&s!=null&&d(e,["instances[]","mimeType"],s);const a=l(t,["autoTruncate"]);return e!==void 0&&a!=null&&d(e,["parameters","autoTruncate"],a),n}function zS(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["contents"]);if(o!=null){let a=Eu(t,o);Array.isArray(a)&&(a=a.map(u=>u)),d(n,["requests[]","content"],a)}const i=l(e,["config"]);i!=null&&HS(i,n);const s=l(e,["model"]);return s!==void 0&&d(n,["requests[]","model"],ke(t,s)),n}function $S(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["contents"]);if(o!=null){let s=Eu(t,o);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["instances[]","content"],s)}const i=l(e,["config"]);return i!=null&&VS(i,n),n}function jS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["embeddings"],i)}const o=l(t,["metadata"]);return o!=null&&d(e,["metadata"],o),e}function WS(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>_S(s))),d(e,["embeddings"],i)}const o=l(t,["metadata"]);return o!=null&&d(e,["metadata"],o),e}function qS(t){const e={},n=l(t,["endpoint"]);n!=null&&d(e,["name"],n);const r=l(t,["deployedModelId"]);return r!=null&&d(e,["deployedModelId"],r),e}function YS(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function KS(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const r=l(t,["args"]);r!=null&&d(e,["args"],r);const o=l(t,["name"]);if(o!=null&&d(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function JS(t){const e={},n=l(t,["mode"]);n!=null&&d(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);if(r!=null&&d(e,["allowedFunctionNames"],r),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function XS(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&d(e,["description"],n);const r=l(t,["name"]);r!=null&&d(e,["name"],r);const o=l(t,["parameters"]);o!=null&&d(e,["parameters"],o);const i=l(t,["parametersJsonSchema"]);i!=null&&d(e,["parametersJsonSchema"],i);const s=l(t,["response"]);s!=null&&d(e,["response"],s);const a=l(t,["responseJsonSchema"]);return a!=null&&d(e,["responseJsonSchema"],a),e}function ZS(t,e,n){const r={},o=l(e,["systemInstruction"]);n!==void 0&&o!=null&&d(n,["systemInstruction"],Rs(ct(o)));const i=l(e,["temperature"]);i!=null&&d(r,["temperature"],i);const s=l(e,["topP"]);s!=null&&d(r,["topP"],s);const a=l(e,["topK"]);a!=null&&d(r,["topK"],a);const u=l(e,["candidateCount"]);u!=null&&d(r,["candidateCount"],u);const c=l(e,["maxOutputTokens"]);c!=null&&d(r,["maxOutputTokens"],c);const f=l(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);const m=l(e,["responseLogprobs"]);m!=null&&d(r,["responseLogprobs"],m);const p=l(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);const g=l(e,["presencePenalty"]);g!=null&&d(r,["presencePenalty"],g);const E=l(e,["frequencyPenalty"]);E!=null&&d(r,["frequencyPenalty"],E);const v=l(e,["seed"]);v!=null&&d(r,["seed"],v);const T=l(e,["responseMimeType"]);T!=null&&d(r,["responseMimeType"],T);const y=l(e,["responseSchema"]);y!=null&&d(r,["responseSchema"],Tu(y));const x=l(e,["responseJsonSchema"]);if(x!=null&&d(r,["responseJsonSchema"],x),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=l(e,["safetySettings"]);if(n!==void 0&&w!=null){let z=w;Array.isArray(z)&&(z=z.map(C=>VE(C))),d(n,["safetySettings"],z)}const _=l(e,["tools"]);if(n!==void 0&&_!=null){let z=Jr(_);Array.isArray(z)&&(z=z.map(C=>KE(Kr(C)))),d(n,["tools"],z)}const b=l(e,["toolConfig"]);if(n!==void 0&&b!=null&&d(n,["toolConfig"],YE(b)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=l(e,["cachedContent"]);n!==void 0&&M!=null&&d(n,["cachedContent"],wn(t,M));const R=l(e,["responseModalities"]);R!=null&&d(r,["responseModalities"],R);const F=l(e,["mediaResolution"]);F!=null&&d(r,["mediaResolution"],F);const D=l(e,["speechConfig"]);if(D!=null&&d(r,["speechConfig"],wu(D)),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const V=l(e,["thinkingConfig"]);V!=null&&d(r,["thinkingConfig"],V);const K=l(e,["imageConfig"]);K!=null&&d(r,["imageConfig"],_E(K));const A=l(e,["enableEnhancedCivicAnswers"]);return A!=null&&d(r,["enableEnhancedCivicAnswers"],A),r}function QS(t,e,n){const r={},o=l(e,["systemInstruction"]);n!==void 0&&o!=null&&d(n,["systemInstruction"],ct(o));const i=l(e,["temperature"]);i!=null&&d(r,["temperature"],i);const s=l(e,["topP"]);s!=null&&d(r,["topP"],s);const a=l(e,["topK"]);a!=null&&d(r,["topK"],a);const u=l(e,["candidateCount"]);u!=null&&d(r,["candidateCount"],u);const c=l(e,["maxOutputTokens"]);c!=null&&d(r,["maxOutputTokens"],c);const f=l(e,["stopSequences"]);f!=null&&d(r,["stopSequences"],f);const m=l(e,["responseLogprobs"]);m!=null&&d(r,["responseLogprobs"],m);const p=l(e,["logprobs"]);p!=null&&d(r,["logprobs"],p);const g=l(e,["presencePenalty"]);g!=null&&d(r,["presencePenalty"],g);const E=l(e,["frequencyPenalty"]);E!=null&&d(r,["frequencyPenalty"],E);const v=l(e,["seed"]);v!=null&&d(r,["seed"],v);const T=l(e,["responseMimeType"]);T!=null&&d(r,["responseMimeType"],T);const y=l(e,["responseSchema"]);y!=null&&d(r,["responseSchema"],Tu(y));const x=l(e,["responseJsonSchema"]);x!=null&&d(r,["responseJsonSchema"],x);const w=l(e,["routingConfig"]);w!=null&&d(r,["routingConfig"],w);const _=l(e,["modelSelectionConfig"]);_!=null&&d(r,["modelConfig"],_);const b=l(e,["safetySettings"]);if(n!==void 0&&b!=null){let ue=b;Array.isArray(ue)&&(ue=ue.map($=>$)),d(n,["safetySettings"],ue)}const M=l(e,["tools"]);if(n!==void 0&&M!=null){let ue=Jr(M);Array.isArray(ue)&&(ue=ue.map($=>om(Kr($)))),d(n,["tools"],ue)}const R=l(e,["toolConfig"]);n!==void 0&&R!=null&&d(n,["toolConfig"],R);const F=l(e,["labels"]);n!==void 0&&F!=null&&d(n,["labels"],F);const D=l(e,["cachedContent"]);n!==void 0&&D!=null&&d(n,["cachedContent"],wn(t,D));const V=l(e,["responseModalities"]);V!=null&&d(r,["responseModalities"],V);const K=l(e,["mediaResolution"]);K!=null&&d(r,["mediaResolution"],K);const A=l(e,["speechConfig"]);A!=null&&d(r,["speechConfig"],wu(A));const z=l(e,["audioTimestamp"]);z!=null&&d(r,["audioTimestamp"],z);const C=l(e,["thinkingConfig"]);C!=null&&d(r,["thinkingConfig"],C);const q=l(e,["imageConfig"]);if(q!=null&&d(r,["imageConfig"],NE(q)),l(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return r}function of(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["contents"]);if(o!=null){let s=Gt(o);Array.isArray(s)&&(s=s.map(a=>Rs(a))),d(n,["contents"],s)}const i=l(e,["config"]);return i!=null&&d(n,["generationConfig"],ZS(t,i,n)),n}function sf(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["contents"]);if(o!=null){let s=Gt(o);Array.isArray(s)&&(s=s.map(a=>a)),d(n,["contents"],s)}const i=l(e,["config"]);return i!=null&&d(n,["generationConfig"],QS(t,i,n)),n}function af(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>ES(c))),d(e,["candidates"],u)}const o=l(t,["modelVersion"]);o!=null&&d(e,["modelVersion"],o);const i=l(t,["promptFeedback"]);i!=null&&d(e,["promptFeedback"],i);const s=l(t,["responseId"]);s!=null&&d(e,["responseId"],s);const a=l(t,["usageMetadata"]);return a!=null&&d(e,["usageMetadata"],a),e}function lf(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(f=>f)),d(e,["candidates"],c)}const o=l(t,["createTime"]);o!=null&&d(e,["createTime"],o);const i=l(t,["modelVersion"]);i!=null&&d(e,["modelVersion"],i);const s=l(t,["promptFeedback"]);s!=null&&d(e,["promptFeedback"],s);const a=l(t,["responseId"]);a!=null&&d(e,["responseId"],a);const u=l(t,["usageMetadata"]);return u!=null&&d(e,["usageMetadata"],u),e}function eE(t,e){const n={};if(l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);const o=l(t,["aspectRatio"]);e!==void 0&&o!=null&&d(e,["parameters","aspectRatio"],o);const i=l(t,["guidanceScale"]);if(e!==void 0&&i!=null&&d(e,["parameters","guidanceScale"],i),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=l(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&d(e,["parameters","safetySetting"],s);const a=l(t,["personGeneration"]);e!==void 0&&a!=null&&d(e,["parameters","personGeneration"],a);const u=l(t,["includeSafetyAttributes"]);e!==void 0&&u!=null&&d(e,["parameters","includeSafetyAttributes"],u);const c=l(t,["includeRaiReason"]);e!==void 0&&c!=null&&d(e,["parameters","includeRaiReason"],c);const f=l(t,["language"]);e!==void 0&&f!=null&&d(e,["parameters","language"],f);const m=l(t,["outputMimeType"]);e!==void 0&&m!=null&&d(e,["parameters","outputOptions","mimeType"],m);const p=l(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&d(e,["parameters","outputOptions","compressionQuality"],p),l(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=l(t,["imageSize"]);if(e!==void 0&&g!=null&&d(e,["parameters","sampleImageSize"],g),l(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function tE(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);const o=l(t,["negativePrompt"]);e!==void 0&&o!=null&&d(e,["parameters","negativePrompt"],o);const i=l(t,["numberOfImages"]);e!==void 0&&i!=null&&d(e,["parameters","sampleCount"],i);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&d(e,["parameters","aspectRatio"],s);const a=l(t,["guidanceScale"]);e!==void 0&&a!=null&&d(e,["parameters","guidanceScale"],a);const u=l(t,["seed"]);e!==void 0&&u!=null&&d(e,["parameters","seed"],u);const c=l(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&d(e,["parameters","safetySetting"],c);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const m=l(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&d(e,["parameters","includeSafetyAttributes"],m);const p=l(t,["includeRaiReason"]);e!==void 0&&p!=null&&d(e,["parameters","includeRaiReason"],p);const g=l(t,["language"]);e!==void 0&&g!=null&&d(e,["parameters","language"],g);const E=l(t,["outputMimeType"]);e!==void 0&&E!=null&&d(e,["parameters","outputOptions","mimeType"],E);const v=l(t,["outputCompressionQuality"]);e!==void 0&&v!=null&&d(e,["parameters","outputOptions","compressionQuality"],v);const T=l(t,["addWatermark"]);e!==void 0&&T!=null&&d(e,["parameters","addWatermark"],T);const y=l(t,["labels"]);e!==void 0&&y!=null&&d(e,["labels"],y);const x=l(t,["imageSize"]);e!==void 0&&x!=null&&d(e,["parameters","sampleImageSize"],x);const w=l(t,["enhancePrompt"]);return e!==void 0&&w!=null&&d(e,["parameters","enhancePrompt"],w),n}function nE(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);const i=l(e,["config"]);return i!=null&&eE(i,n),n}function rE(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);const i=l(e,["config"]);return i!=null&&tE(i,n),n}function oE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>gE(s))),d(e,["generatedImages"],i)}const o=l(t,["positivePromptSafetyAttributes"]);return o!=null&&d(e,["positivePromptSafetyAttributes"],nm(o)),e}function iE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>ks(s))),d(e,["generatedImages"],i)}const o=l(t,["positivePromptSafetyAttributes"]);return o!=null&&d(e,["positivePromptSafetyAttributes"],rm(o)),e}function sE(t,e){const n={},r=l(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r),l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=l(t,["durationSeconds"]);if(e!==void 0&&o!=null&&d(e,["parameters","durationSeconds"],o),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=l(t,["aspectRatio"]);e!==void 0&&i!=null&&d(e,["parameters","aspectRatio"],i);const s=l(t,["resolution"]);e!==void 0&&s!=null&&d(e,["parameters","resolution"],s);const a=l(t,["personGeneration"]);if(e!==void 0&&a!=null&&d(e,["parameters","personGeneration"],a),l(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=l(t,["negativePrompt"]);e!==void 0&&u!=null&&d(e,["parameters","negativePrompt"],u);const c=l(t,["enhancePrompt"]);if(e!==void 0&&c!=null&&d(e,["parameters","enhancePrompt"],c),l(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=l(t,["lastFrame"]);e!==void 0&&f!=null&&d(e,["instances[0]","lastFrame"],Ps(f));const m=l(t,["referenceImages"]);if(e!==void 0&&m!=null){let p=m;Array.isArray(p)&&(p=p.map(g=>lT(g))),d(e,["instances[0]","referenceImages"],p)}if(l(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(l(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function aE(t,e){const n={},r=l(t,["numberOfVideos"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);const o=l(t,["outputGcsUri"]);e!==void 0&&o!=null&&d(e,["parameters","storageUri"],o);const i=l(t,["fps"]);e!==void 0&&i!=null&&d(e,["parameters","fps"],i);const s=l(t,["durationSeconds"]);e!==void 0&&s!=null&&d(e,["parameters","durationSeconds"],s);const a=l(t,["seed"]);e!==void 0&&a!=null&&d(e,["parameters","seed"],a);const u=l(t,["aspectRatio"]);e!==void 0&&u!=null&&d(e,["parameters","aspectRatio"],u);const c=l(t,["resolution"]);e!==void 0&&c!=null&&d(e,["parameters","resolution"],c);const f=l(t,["personGeneration"]);e!==void 0&&f!=null&&d(e,["parameters","personGeneration"],f);const m=l(t,["pubsubTopic"]);e!==void 0&&m!=null&&d(e,["parameters","pubsubTopic"],m);const p=l(t,["negativePrompt"]);e!==void 0&&p!=null&&d(e,["parameters","negativePrompt"],p);const g=l(t,["enhancePrompt"]);e!==void 0&&g!=null&&d(e,["parameters","enhancePrompt"],g);const E=l(t,["generateAudio"]);e!==void 0&&E!=null&&d(e,["parameters","generateAudio"],E);const v=l(t,["lastFrame"]);e!==void 0&&v!=null&&d(e,["instances[0]","lastFrame"],en(v));const T=l(t,["referenceImages"]);if(e!==void 0&&T!=null){let w=T;Array.isArray(w)&&(w=w.map(_=>uT(_))),d(e,["instances[0]","referenceImages"],w)}const y=l(t,["mask"]);e!==void 0&&y!=null&&d(e,["instances[0]","mask"],aT(y));const x=l(t,["compressionQuality"]);return e!==void 0&&x!=null&&d(e,["parameters","compressionQuality"],x),n}function lE(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["metadata"]);r!=null&&d(e,["metadata"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);i!=null&&d(e,["error"],i);const s=l(t,["response","generateVideoResponse"]);return s!=null&&d(e,["response"],fE(s)),e}function uE(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["metadata"]);r!=null&&d(e,["metadata"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);i!=null&&d(e,["error"],i);const s=l(t,["response"]);return s!=null&&d(e,["response"],hE(s)),e}function cE(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);const i=l(e,["image"]);i!=null&&d(n,["instances[0]","image"],Ps(i));const s=l(e,["video"]);s!=null&&d(n,["instances[0]","video"],im(s));const a=l(e,["source"]);a!=null&&pE(a,n);const u=l(e,["config"]);return u!=null&&sE(u,n),n}function dE(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["prompt"]);o!=null&&d(n,["instances[0]","prompt"],o);const i=l(e,["image"]);i!=null&&d(n,["instances[0]","image"],en(i));const s=l(e,["video"]);s!=null&&d(n,["instances[0]","video"],sm(s));const a=l(e,["source"]);a!=null&&mE(a,n);const u=l(e,["config"]);return u!=null&&aE(u,n),n}function fE(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>vE(s))),d(e,["generatedVideos"],i)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);const o=l(t,["raiMediaFilteredReasons"]);return o!=null&&d(e,["raiMediaFilteredReasons"],o),e}function hE(t){const e={},n=l(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>xE(s))),d(e,["generatedVideos"],i)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&d(e,["raiMediaFilteredCount"],r);const o=l(t,["raiMediaFilteredReasons"]);return o!=null&&d(e,["raiMediaFilteredReasons"],o),e}function pE(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);const o=l(t,["image"]);e!==void 0&&o!=null&&d(e,["instances[0]","image"],Ps(o));const i=l(t,["video"]);return e!==void 0&&i!=null&&d(e,["instances[0]","video"],im(i)),n}function mE(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);const o=l(t,["image"]);e!==void 0&&o!=null&&d(e,["instances[0]","image"],en(o));const i=l(t,["video"]);return e!==void 0&&i!=null&&d(e,["instances[0]","video"],sm(i)),n}function gE(t){const e={},n=l(t,["_self"]);n!=null&&d(e,["image"],IE(n));const r=l(t,["raiFilteredReason"]);r!=null&&d(e,["raiFilteredReason"],r);const o=l(t,["_self"]);return o!=null&&d(e,["safetyAttributes"],nm(o)),e}function ks(t){const e={},n=l(t,["_self"]);n!=null&&d(e,["image"],tm(n));const r=l(t,["raiFilteredReason"]);r!=null&&d(e,["raiFilteredReason"],r);const o=l(t,["_self"]);o!=null&&d(e,["safetyAttributes"],rm(o));const i=l(t,["prompt"]);return i!=null&&d(e,["enhancedPrompt"],i),e}function yE(t){const e={},n=l(t,["_self"]);n!=null&&d(e,["mask"],tm(n));const r=l(t,["labels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),d(e,["labels"],o)}return e}function vE(t){const e={},n=l(t,["video"]);return n!=null&&d(e,["video"],iT(n)),e}function xE(t){const e={},n=l(t,["_self"]);return n!=null&&d(e,["video"],sT(n)),e}function SE(t){const e={},n=l(t,["modelSelectionConfig"]);n!=null&&d(e,["modelConfig"],n);const r=l(t,["responseJsonSchema"]);r!=null&&d(e,["responseJsonSchema"],r);const o=l(t,["audioTimestamp"]);o!=null&&d(e,["audioTimestamp"],o);const i=l(t,["candidateCount"]);i!=null&&d(e,["candidateCount"],i);const s=l(t,["enableAffectiveDialog"]);s!=null&&d(e,["enableAffectiveDialog"],s);const a=l(t,["frequencyPenalty"]);a!=null&&d(e,["frequencyPenalty"],a);const u=l(t,["logprobs"]);u!=null&&d(e,["logprobs"],u);const c=l(t,["maxOutputTokens"]);c!=null&&d(e,["maxOutputTokens"],c);const f=l(t,["mediaResolution"]);f!=null&&d(e,["mediaResolution"],f);const m=l(t,["presencePenalty"]);m!=null&&d(e,["presencePenalty"],m);const p=l(t,["responseLogprobs"]);p!=null&&d(e,["responseLogprobs"],p);const g=l(t,["responseMimeType"]);g!=null&&d(e,["responseMimeType"],g);const E=l(t,["responseModalities"]);E!=null&&d(e,["responseModalities"],E);const v=l(t,["responseSchema"]);v!=null&&d(e,["responseSchema"],v);const T=l(t,["routingConfig"]);T!=null&&d(e,["routingConfig"],T);const y=l(t,["seed"]);y!=null&&d(e,["seed"],y);const x=l(t,["speechConfig"]);x!=null&&d(e,["speechConfig"],x);const w=l(t,["stopSequences"]);w!=null&&d(e,["stopSequences"],w);const _=l(t,["temperature"]);_!=null&&d(e,["temperature"],_);const b=l(t,["thinkingConfig"]);b!=null&&d(e,["thinkingConfig"],b);const M=l(t,["topK"]);M!=null&&d(e,["topK"],M);const R=l(t,["topP"]);if(R!=null&&d(e,["topP"],R),l(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function EE(t,e){const n={},r=l(e,["model"]);return r!=null&&d(n,["_url","name"],ke(t,r)),n}function TE(t,e){const n={},r=l(e,["model"]);return r!=null&&d(n,["_url","name"],ke(t,r)),n}function wE(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function CE(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function _E(t){const e={},n=l(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);const r=l(t,["imageSize"]);if(r!=null&&d(e,["imageSize"],r),l(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(l(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function NE(t){const e={},n=l(t,["aspectRatio"]);n!=null&&d(e,["aspectRatio"],n);const r=l(t,["imageSize"]);r!=null&&d(e,["imageSize"],r);const o=l(t,["outputMimeType"]);o!=null&&d(e,["imageOutputOptions","mimeType"],o);const i=l(t,["outputCompressionQuality"]);return i!=null&&d(e,["imageOutputOptions","compressionQuality"],i),e}function IE(t){const e={},n=l(t,["bytesBase64Encoded"]);n!=null&&d(e,["imageBytes"],Wn(n));const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function tm(t){const e={},n=l(t,["gcsUri"]);n!=null&&d(e,["gcsUri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&d(e,["imageBytes"],Wn(r));const o=l(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}function Ps(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=l(t,["imageBytes"]);n!=null&&d(e,["bytesBase64Encoded"],Wn(n));const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function en(t){const e={},n=l(t,["gcsUri"]);n!=null&&d(e,["gcsUri"],n);const r=l(t,["imageBytes"]);r!=null&&d(e,["bytesBase64Encoded"],Wn(r));const o=l(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}function bE(t,e,n){const r={},o=l(e,["pageSize"]);n!==void 0&&o!=null&&d(n,["_query","pageSize"],o);const i=l(e,["pageToken"]);n!==void 0&&i!=null&&d(n,["_query","pageToken"],i);const s=l(e,["filter"]);n!==void 0&&s!=null&&d(n,["_query","filter"],s);const a=l(e,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],Yp(t,a)),r}function AE(t,e,n){const r={},o=l(e,["pageSize"]);n!==void 0&&o!=null&&d(n,["_query","pageSize"],o);const i=l(e,["pageToken"]);n!==void 0&&i!=null&&d(n,["_query","pageToken"],i);const s=l(e,["filter"]);n!==void 0&&s!=null&&d(n,["_query","filter"],s);const a=l(e,["queryBase"]);return n!==void 0&&a!=null&&d(n,["_url","models_url"],Yp(t,a)),r}function RE(t,e){const n={},r=l(e,["config"]);return r!=null&&bE(t,r,n),n}function kE(t,e){const n={},r=l(e,["config"]);return r!=null&&AE(t,r,n),n}function PE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["_self"]);if(o!=null){let i=Kp(o);Array.isArray(i)&&(i=i.map(s=>hl(s))),d(e,["models"],i)}return e}function ME(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["_self"]);if(o!=null){let i=Kp(o);Array.isArray(i)&&(i=i.map(s=>pl(s))),d(e,["models"],i)}return e}function LE(t){const e={},n=l(t,["maskMode"]);n!=null&&d(e,["maskMode"],n);const r=l(t,["segmentationClasses"]);r!=null&&d(e,["maskClasses"],r);const o=l(t,["maskDilation"]);return o!=null&&d(e,["dilation"],o),e}function hl(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["displayName"]);r!=null&&d(e,["displayName"],r);const o=l(t,["description"]);o!=null&&d(e,["description"],o);const i=l(t,["version"]);i!=null&&d(e,["version"],i);const s=l(t,["_self"]);s!=null&&d(e,["tunedModelInfo"],JE(s));const a=l(t,["inputTokenLimit"]);a!=null&&d(e,["inputTokenLimit"],a);const u=l(t,["outputTokenLimit"]);u!=null&&d(e,["outputTokenLimit"],u);const c=l(t,["supportedGenerationMethods"]);c!=null&&d(e,["supportedActions"],c);const f=l(t,["temperature"]);f!=null&&d(e,["temperature"],f);const m=l(t,["maxTemperature"]);m!=null&&d(e,["maxTemperature"],m);const p=l(t,["topP"]);p!=null&&d(e,["topP"],p);const g=l(t,["topK"]);g!=null&&d(e,["topK"],g);const E=l(t,["thinking"]);return E!=null&&d(e,["thinking"],E),e}function pl(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["displayName"]);r!=null&&d(e,["displayName"],r);const o=l(t,["description"]);o!=null&&d(e,["description"],o);const i=l(t,["versionId"]);i!=null&&d(e,["version"],i);const s=l(t,["deployedModels"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(p=>qS(p))),d(e,["endpoints"],m)}const a=l(t,["labels"]);a!=null&&d(e,["labels"],a);const u=l(t,["_self"]);u!=null&&d(e,["tunedModelInfo"],XE(u));const c=l(t,["defaultCheckpointId"]);c!=null&&d(e,["defaultCheckpointId"],c);const f=l(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(p=>p)),d(e,["checkpoints"],m)}return e}function DE(t){const e={},n=l(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const o=l(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);const i=l(t,["fileData"]);i!=null&&d(e,["fileData"],YS(i));const s=l(t,["functionCall"]);s!=null&&d(e,["functionCall"],KS(s));const a=l(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&d(e,["inlineData"],SS(u));const c=l(t,["text"]);c!=null&&d(e,["text"],c);const f=l(t,["thought"]);f!=null&&d(e,["thought"],f);const m=l(t,["thoughtSignature"]);m!=null&&d(e,["thoughtSignature"],m);const p=l(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function OE(t){const e={},n=l(t,["productImage"]);return n!=null&&d(e,["image"],en(n)),e}function UE(t,e){const n={},r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&d(e,["parameters","sampleCount"],r);const o=l(t,["baseSteps"]);e!==void 0&&o!=null&&d(e,["parameters","baseSteps"],o);const i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&d(e,["parameters","storageUri"],i);const s=l(t,["seed"]);e!==void 0&&s!=null&&d(e,["parameters","seed"],s);const a=l(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&d(e,["parameters","safetySetting"],a);const u=l(t,["personGeneration"]);e!==void 0&&u!=null&&d(e,["parameters","personGeneration"],u);const c=l(t,["addWatermark"]);e!==void 0&&c!=null&&d(e,["parameters","addWatermark"],c);const f=l(t,["outputMimeType"]);e!==void 0&&f!=null&&d(e,["parameters","outputOptions","mimeType"],f);const m=l(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&d(e,["parameters","outputOptions","compressionQuality"],m);const p=l(t,["enhancePrompt"]);e!==void 0&&p!=null&&d(e,["parameters","enhancePrompt"],p);const g=l(t,["labels"]);return e!==void 0&&g!=null&&d(e,["labels"],g),n}function FE(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["source"]);o!=null&&BE(o,n);const i=l(e,["config"]);return i!=null&&UE(i,n),n}function GE(t){const e={},n=l(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>ks(o))),d(e,["generatedImages"],r)}return e}function BE(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);const o=l(t,["personImage"]);e!==void 0&&o!=null&&d(e,["instances[0]","personImage","image"],en(o));const i=l(t,["productImages"]);if(e!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>OE(a))),d(e,["instances[0]","productImages"],s)}return n}function HE(t){const e={},n=l(t,["referenceImage"]);n!=null&&d(e,["referenceImage"],en(n));const r=l(t,["referenceId"]);r!=null&&d(e,["referenceId"],r);const o=l(t,["referenceType"]);o!=null&&d(e,["referenceType"],o);const i=l(t,["maskImageConfig"]);i!=null&&d(e,["maskImageConfig"],LE(i));const s=l(t,["controlImageConfig"]);s!=null&&d(e,["controlImageConfig"],IS(s));const a=l(t,["styleImageConfig"]);a!=null&&d(e,["styleImageConfig"],a);const u=l(t,["subjectImageConfig"]);return u!=null&&d(e,["subjectImageConfig"],u),e}function nm(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&d(e,["categories"],n);const r=l(t,["safetyAttributes","scores"]);r!=null&&d(e,["scores"],r);const o=l(t,["contentType"]);return o!=null&&d(e,["contentType"],o),e}function rm(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&d(e,["categories"],n);const r=l(t,["safetyAttributes","scores"]);r!=null&&d(e,["scores"],r);const o=l(t,["contentType"]);return o!=null&&d(e,["contentType"],o),e}function VE(t){const e={},n=l(t,["category"]);if(n!=null&&d(e,["category"],n),l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=l(t,["threshold"]);return r!=null&&d(e,["threshold"],r),e}function zE(t){const e={},n=l(t,["image"]);return n!=null&&d(e,["image"],en(n)),e}function $E(t,e){const n={},r=l(t,["mode"]);e!==void 0&&r!=null&&d(e,["parameters","mode"],r);const o=l(t,["maxPredictions"]);e!==void 0&&o!=null&&d(e,["parameters","maxPredictions"],o);const i=l(t,["confidenceThreshold"]);e!==void 0&&i!=null&&d(e,["parameters","confidenceThreshold"],i);const s=l(t,["maskDilation"]);e!==void 0&&s!=null&&d(e,["parameters","maskDilation"],s);const a=l(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&d(e,["parameters","binaryColorThreshold"],a);const u=l(t,["labels"]);return e!==void 0&&u!=null&&d(e,["labels"],u),n}function jE(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["source"]);o!=null&&qE(o,n);const i=l(e,["config"]);return i!=null&&$E(i,n),n}function WE(t){const e={},n=l(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(o=>yE(o))),d(e,["generatedMasks"],r)}return e}function qE(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&d(e,["instances[0]","prompt"],r);const o=l(t,["image"]);e!==void 0&&o!=null&&d(e,["instances[0]","image"],en(o));const i=l(t,["scribbleImage"]);return e!==void 0&&i!=null&&d(e,["instances[0]","scribble"],zE(i)),n}function YE(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&d(e,["functionCallingConfig"],JS(n));const r=l(t,["retrievalConfig"]);return r!=null&&d(e,["retrievalConfig"],r),e}function KE(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),d(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearchRetrieval"]);r!=null&&d(e,["googleSearchRetrieval"],r);const o=l(t,["computerUse"]);o!=null&&d(e,["computerUse"],o);const i=l(t,["fileSearch"]);i!=null&&d(e,["fileSearch"],i);const s=l(t,["codeExecution"]);if(s!=null&&d(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],wE(a));const u=l(t,["googleSearch"]);u!=null&&d(e,["googleSearch"],CE(u));const c=l(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}function om(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>XS(p))),d(e,["functionDeclarations"],m)}const r=l(t,["retrieval"]);r!=null&&d(e,["retrieval"],r);const o=l(t,["googleSearchRetrieval"]);o!=null&&d(e,["googleSearchRetrieval"],o);const i=l(t,["computerUse"]);if(i!=null&&d(e,["computerUse"],i),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&d(e,["codeExecution"],s);const a=l(t,["enterpriseWebSearch"]);a!=null&&d(e,["enterpriseWebSearch"],a);const u=l(t,["googleMaps"]);u!=null&&d(e,["googleMaps"],u);const c=l(t,["googleSearch"]);c!=null&&d(e,["googleSearch"],c);const f=l(t,["urlContext"]);return f!=null&&d(e,["urlContext"],f),e}function JE(t){const e={},n=l(t,["baseModel"]);n!=null&&d(e,["baseModel"],n);const r=l(t,["createTime"]);r!=null&&d(e,["createTime"],r);const o=l(t,["updateTime"]);return o!=null&&d(e,["updateTime"],o),e}function XE(t){const e={},n=l(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(e,["baseModel"],n);const r=l(t,["createTime"]);r!=null&&d(e,["createTime"],r);const o=l(t,["updateTime"]);return o!=null&&d(e,["updateTime"],o),e}function ZE(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);const o=l(t,["description"]);e!==void 0&&o!=null&&d(e,["description"],o);const i=l(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&d(e,["defaultCheckpointId"],i),n}function QE(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&d(e,["displayName"],r);const o=l(t,["description"]);e!==void 0&&o!=null&&d(e,["description"],o);const i=l(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&d(e,["defaultCheckpointId"],i),n}function eT(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","name"],ke(t,r));const o=l(e,["config"]);return o!=null&&ZE(o,n),n}function tT(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["config"]);return o!=null&&QE(o,n),n}function nT(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&d(e,["parameters","storageUri"],r);const o=l(t,["safetyFilterLevel"]);e!==void 0&&o!=null&&d(e,["parameters","safetySetting"],o);const i=l(t,["personGeneration"]);e!==void 0&&i!=null&&d(e,["parameters","personGeneration"],i);const s=l(t,["includeRaiReason"]);e!==void 0&&s!=null&&d(e,["parameters","includeRaiReason"],s);const a=l(t,["outputMimeType"]);e!==void 0&&a!=null&&d(e,["parameters","outputOptions","mimeType"],a);const u=l(t,["outputCompressionQuality"]);e!==void 0&&u!=null&&d(e,["parameters","outputOptions","compressionQuality"],u);const c=l(t,["enhanceInputImage"]);e!==void 0&&c!=null&&d(e,["parameters","upscaleConfig","enhanceInputImage"],c);const f=l(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&d(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const m=l(t,["labels"]);e!==void 0&&m!=null&&d(e,["labels"],m);const p=l(t,["numberOfImages"]);e!==void 0&&p!=null&&d(e,["parameters","sampleCount"],p);const g=l(t,["mode"]);return e!==void 0&&g!=null&&d(e,["parameters","mode"],g),n}function rT(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["_url","model"],ke(t,r));const o=l(e,["image"]);o!=null&&d(n,["instances[0]","image"],en(o));const i=l(e,["upscaleFactor"]);i!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],i);const s=l(e,["config"]);return s!=null&&nT(s,n),n}function oT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>ks(i))),d(e,["generatedImages"],o)}return e}function iT(t){const e={},n=l(t,["uri"]);n!=null&&d(e,["uri"],n);const r=l(t,["encodedVideo"]);r!=null&&d(e,["videoBytes"],Wn(r));const o=l(t,["encoding"]);return o!=null&&d(e,["mimeType"],o),e}function sT(t){const e={},n=l(t,["gcsUri"]);n!=null&&d(e,["uri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&d(e,["videoBytes"],Wn(r));const o=l(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}function aT(t){const e={},n=l(t,["image"]);n!=null&&d(e,["_self"],en(n));const r=l(t,["maskMode"]);return r!=null&&d(e,["maskMode"],r),e}function lT(t){const e={},n=l(t,["image"]);n!=null&&d(e,["image"],Ps(n));const r=l(t,["referenceType"]);return r!=null&&d(e,["referenceType"],r),e}function uT(t){const e={},n=l(t,["image"]);n!=null&&d(e,["image"],en(n));const r=l(t,["referenceType"]);return r!=null&&d(e,["referenceType"],r),e}function im(t){const e={},n=l(t,["uri"]);n!=null&&d(e,["uri"],n);const r=l(t,["videoBytes"]);r!=null&&d(e,["encodedVideo"],Wn(r));const o=l(t,["mimeType"]);return o!=null&&d(e,["encoding"],o),e}function sm(t){const e={},n=l(t,["uri"]);n!=null&&d(e,["gcsUri"],n);const r=l(t,["videoBytes"]);r!=null&&d(e,["bytesBase64Encoded"],Wn(r));const o=l(t,["mimeType"]);return o!=null&&d(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cT(t,e){const n={},r=l(t,["displayName"]);return e!==void 0&&r!=null&&d(e,["displayName"],r),n}function dT(t){const e={},n=l(t,["config"]);return n!=null&&cT(n,e),e}function fT(t,e){const n={},r=l(t,["force"]);return e!==void 0&&r!=null&&d(e,["_query","force"],r),n}function hT(t){const e={},n=l(t,["name"]);n!=null&&d(e,["_url","name"],n);const r=l(t,["config"]);return r!=null&&fT(r,e),e}function pT(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function mT(t,e){const n={},r=l(t,["customMetadata"]);if(e!==void 0&&r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["customMetadata"],i)}const o=l(t,["chunkingConfig"]);return e!==void 0&&o!=null&&d(e,["chunkingConfig"],o),n}function gT(t){const e={},n=l(t,["name"]);n!=null&&d(e,["name"],n);const r=l(t,["metadata"]);r!=null&&d(e,["metadata"],r);const o=l(t,["done"]);o!=null&&d(e,["done"],o);const i=l(t,["error"]);i!=null&&d(e,["error"],i);const s=l(t,["response"]);return s!=null&&d(e,["response"],vT(s)),e}function yT(t){const e={},n=l(t,["fileSearchStoreName"]);n!=null&&d(e,["_url","file_search_store_name"],n);const r=l(t,["fileName"]);r!=null&&d(e,["fileName"],r);const o=l(t,["config"]);return o!=null&&mT(o,e),e}function vT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["parent"]);r!=null&&d(e,["parent"],r);const o=l(t,["documentName"]);return o!=null&&d(e,["documentName"],o),e}function xT(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function ST(t){const e={},n=l(t,["config"]);return n!=null&&xT(n,e),e}function ET(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["fileSearchStores"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["fileSearchStores"],i)}return e}function am(t,e){const n={},r=l(t,["mimeType"]);e!==void 0&&r!=null&&d(e,["mimeType"],r);const o=l(t,["displayName"]);e!==void 0&&o!=null&&d(e,["displayName"],o);const i=l(t,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>u)),d(e,["customMetadata"],a)}const s=l(t,["chunkingConfig"]);return e!==void 0&&s!=null&&d(e,["chunkingConfig"],s),n}function TT(t){const e={},n=l(t,["fileSearchStoreName"]);n!=null&&d(e,["_url","file_search_store_name"],n);const r=l(t,["config"]);return r!=null&&am(r,e),e}function wT(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&d(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CT="Content-Type",_T="X-Server-Timeout",NT="User-Agent",ml="x-goog-api-client",IT="1.34.0",bT=`google-genai-sdk/${IT}`,AT="v1beta1",RT="v1beta";class kT{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:AT,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:RT,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const o=[this.getRequestUrlInternal(n)];return r&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[s,a]of Object.entries(e.queryParams))o.searchParams.append(s,String(a));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,o.toString(),e.abortSignal),this.unaryApiCall(o,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[o,i]of Object.entries(n))typeof i=="object"?r[o]=Object.assign(Object.assign({},r[o]),i):i!==void 0&&(r[o]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,n,r);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,o.toString(),e.abortSignal),this.streamApiCall(o,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,o){if(n&&n.timeout||o){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>i.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}o&&o.addEventListener("abort",()=>{i.abort()}),e.signal=s}return n&&n.extraBody!==null&&PT(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async o=>(await uf(o),new cl(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async o=>(await uf(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){return Jt(this,arguments,function*(){var r;const o=(r=e==null?void 0:e.body)===null||r===void 0?void 0:r.getReader(),i=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let s="";const a="data:",u=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:c,value:f}=yield Ce(o.read());if(c){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=i.decode(f,{stream:!0});try{const E=JSON.parse(m);if("error"in E){const v=JSON.parse(JSON.stringify(E.error)),T=v.status,y=v.code,x=`got status: ${T}. ${JSON.stringify(E)}`;if(y>=400&&y<600)throw new As({message:x,status:y})}}catch(E){if(E.name==="ApiError")throw E}s+=m;let p=-1,g=0;for(;;){p=-1,g=0;for(const T of u){const y=s.indexOf(T);y!==-1&&(p===-1||y<p)&&(p=y,g=T.length)}if(p===-1)break;const E=s.substring(0,p);s=s.substring(p+g);const v=E.trim();if(v.startsWith(a)){const T=v.substring(a.length).trim();try{const y=new Response(T,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ce(new cl(y))}catch(y){throw new Error(`exception parsing stream chunk ${T}. ${y}`)}}}}}finally{o.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=bT+" "+this.clientOptions.userAgentExtra;return e[NT]=n,e[ml]=n,e[CT]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[o,i]of Object.entries(e.headers))r.append(o,i);e.timeout&&e.timeout>0&&r.append(_T,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const o={};n!=null&&(o.mimeType=n.mimeType,o.name=n.name,o.displayName=n.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const i=this.clientOptions.uploader,s=await i.stat(e);o.sizeBytes=String(s.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:s.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=a;const u={file:o},c=this.getFileName(e),f=ge("upload/v1beta/files",u._url),m=await this.fetchUploadUrl(f,o.sizeBytes,o.mimeType,c,u,n==null?void 0:n.httpOptions);return i.upload(e,m,this)}async uploadFileToFileSearchStore(e,n,r){var o;const i=this.clientOptions.uploader,s=await i.stat(n),a=String(s.size),u=(o=r==null?void 0:r.mimeType)!==null&&o!==void 0?o:s.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const c=`upload/v1beta/${e}:uploadToFileSearchStore`,f=this.getFileName(n),m={};r!=null&&am(r,m);const p=await this.fetchUploadUrl(c,a,u,f,m,r==null?void 0:r.httpOptions);return i.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,o,i,s){var a;let u={};s?u=s:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},o?{"X-Goog-Upload-File-Name":o}:{})};const c=await this.request({path:e,body:JSON.stringify(i),httpMethod:"POST",httpOptions:u});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(a=c==null?void 0:c.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function uf(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const o=JSON.stringify(r);throw n>=400&&n<600?new As({message:o,status:n}):new Error(o)}}function PT(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const i=JSON.parse(t.body);if(typeof i=="object"&&i!==null&&!Array.isArray(i))n=i;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(i,s){const a=Object.assign({},i);for(const u in s)if(Object.prototype.hasOwnProperty.call(s,u)){const c=s[u],f=a[u];c&&typeof c=="object"&&!Array.isArray(c)&&f&&typeof f=="object"&&!Array.isArray(f)?a[u]=r(f,c):(f&&c&&typeof f!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof f}, New type: ${typeof c}. Overwriting.`),a[u]=c)}return a}const o=r(n,e);t.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MT="mcp_used/unknown";let LT=!1;function lm(t){for(const e of t)if(DT(e)||typeof e=="object"&&"inputSchema"in e)return!0;return LT}function um(t){var e;const n=(e=t[ml])!==null&&e!==void 0?e:"";t[ml]=(n+` ${MT}`).trimStart()}function DT(t){return t!==null&&typeof t=="object"&&t instanceof _u}function OT(t){return Jt(this,arguments,function*(n,r=100){let o,i=0;for(;i<r;){const s=yield Ce(n.listTools({cursor:o}));for(const a of s.tools)yield yield Ce(a),i++;if(!s.nextCursor)break;o=s.nextCursor}})}class _u{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new _u(e,n)}async initialize(){var e,n,r,o;if(this.mcpTools.length>0)return;const i={},s=[];for(const f of this.mcpClients)try{for(var a=!0,u=(n=void 0,Xt(OT(f))),c;c=await u.next(),e=c.done,!e;a=!0){o=c.value,a=!1;const m=o;s.push(m);const p=m.name;if(i[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);i[p]=f}}catch(m){n={error:m}}finally{try{!a&&!e&&(r=u.return)&&await r.call(u)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),pv(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[r.name];let i;this.config.timeout&&(i={timeout:this.config.timeout});const s=await o.callTool({name:r.name,arguments:r.args},void 0,i);n.push({functionResponse:{name:r.name,response:s.isError?{error:s}:s}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function UT(t,e,n){const r=new sv;let o;n.data instanceof Blob?o=JSON.parse(await n.data.text()):o=JSON.parse(n.data),Object.assign(r,o),e(r)}class FT{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=HT(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),u=`${o}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${a}`;let c=()=>{};const f=new Promise(w=>{c=w}),m=e.callbacks,p=function(){c({})},g=this.apiClient,E={onopen:p,onmessage:w=>{UT(g,m.onmessage,w)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(w){},onclose:(r=m==null?void 0:m.onclose)!==null&&r!==void 0?r:function(w){}},v=this.webSocketFactory.create(u,BT(s),E);v.connect(),await f;const x={setup:{model:ke(this.apiClient,e.model)}};return v.send(JSON.stringify(x)),new GT(v,this.apiClient)}}class GT{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=dS(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=cS(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ar.PLAY)}pause(){this.sendPlaybackControl(Ar.PAUSE)}stop(){this.sendPlaybackControl(Ar.STOP)}resetContext(){this.sendPlaybackControl(Ar.RESET_CONTEXT)}close(){this.conn.close()}}function BT(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function HT(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VT="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function zT(t,e,n){const r=new iv;let o;n.data instanceof Blob?o=await n.data.text():n.data instanceof ArrayBuffer?o=new TextDecoder().decode(n.data):o=n.data;const i=JSON.parse(o);if(t.isVertexAI()){const s=pS(i);Object.assign(r,s)}else Object.assign(r,i);e(r)}class $T{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new FT(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,o,i,s,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&lm(e.config.tools)&&um(m);const p=YT(m);if(this.apiClient.isVertexAI())f=`${u}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,f);else{const D=this.apiClient.getApiKey();let V="BidiGenerateContent",K="key";D!=null&&D.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),V="BidiGenerateContentConstrained",K="access_token"),f=`${u}/ws/google.ai.generativelanguage.${c}.GenerativeService.${V}?${K}=${D}`}let g=()=>{};const E=new Promise(D=>{g=D}),v=e.callbacks,T=function(){var D;(D=v==null?void 0:v.onopen)===null||D===void 0||D.call(v),g({})},y=this.apiClient,x={onopen:T,onmessage:D=>{zT(y,v.onmessage,D)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(D){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(D){}},w=this.webSocketFactory.create(f,qT(p),x);w.connect(),await E;let _=ke(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&_.startsWith("publishers/")){const D=this.apiClient.getProject(),V=this.apiClient.getLocation();_=`projects/${D}/locations/${V}/`+_}let b={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[ss.AUDIO]}:e.config.responseModalities=[ss.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M=(a=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[],R=[];for(const D of M)if(this.isCallableTool(D)){const V=D;R.push(await V.tool())}else R.push(D);R.length>0&&(e.config.tools=R);const F={model:_,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?b=uS(this.apiClient,F):b=lS(this.apiClient,F),delete b.config,w.send(JSON.stringify(b)),new WT(w,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const jT={turnComplete:!0};class WT{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Gt(n.turns),e.isVertexAI()||(r=r.map(o=>Rs(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(VT)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},jT),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:hS(e)}:n={realtimeInput:fS(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function qT(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function YT(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cf=10;function df(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const s of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Fr(s)){o=!0;break}if(!o)return!0;const i=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function Fr(t){return"callTool"in t&&typeof t.callTool=="function"}function KT(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(o=>Fr(o)))!==null&&r!==void 0?r:!1}function ff(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,o)=>{if(Fr(r))return;const i=r;i.functionDeclarations&&i.functionDeclarations.length>0&&n.push(o)}),n}function hf(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JT extends Tn{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,o,i,s,a;const u=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!KT(n)||df(n.config))return await this.generateContentInternal(u);const c=ff(n);if(c.length>0){const v=c.map(T=>`tools[${T}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${v}.`)}let f,m;const p=Gt(u.contents),g=(i=(o=(r=u.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&i!==void 0?i:cf;let E=0;for(;E<g&&(f=await this.generateContentInternal(u),!(!f.functionCalls||f.functionCalls.length===0));){const v=f.candidates[0].content,T=[];for(const y of(a=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&a!==void 0?a:[])if(Fr(y)){const w=await y.callTool(f.functionCalls);T.push(...w)}E++,m={role:"user",parts:T},u.contents=Gt(u.contents),u.contents.push(v),u.contents.push(m),hf(u.config)&&(p.push(v),p.push(m))}return hf(u.config)&&(f.automaticFunctionCallingHistory=p),f},this.generateContentStream=async n=>{var r,o,i,s,a;if(this.maybeMoveToResponseJsonSchem(n),df(n.config)){const m=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(m)}const u=ff(n);if(u.length>0){const m=u.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const c=(i=(o=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||o===void 0?void 0:o.functionCallingConfig)===null||i===void 0?void 0:i.streamFunctionCallArguments,f=(a=(s=n==null?void 0:n.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(c&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var o;let i;const s=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((o=u==null?void 0:u.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?i=u==null?void 0:u.safetyAttributes:s.push(u);let a;return i?a={generatedImages:s,positivePromptSafetyAttributes:i,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:s,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const s={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((r=s.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new cr(Sn.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(s),s)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const o={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(o)},this.generateVideos=async n=>{var r,o,i,s,a,u;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((o=n.video)===null||o===void 0)&&o.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((s=(i=n.source)===null||i===void 0?void 0:i.video)===null||s===void 0)&&s.uri&&(!((u=(a=n.source)===null||a===void 0?void 0:a.video)===null||u===void 0)&&u.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,o;const i=(n=e.config)===null||n===void 0?void 0:n.tools;if(!i)return e;const s=await Promise.all(i.map(async u=>Fr(u)?await u.tool():u)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(a.config.tools=s,e.config&&e.config.tools&&lm(e.config.tools)){const u=(o=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&o!==void 0?o:{};let c=Object.assign({},u);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),um(c),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return a}async initAfcToolsMap(e){var n,r,o;const i=new Map;for(const s of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Fr(s)){const a=s,u=await a.tool();for(const c of(o=u.functionDeclarations)!==null&&o!==void 0?o:[]){if(!c.name)throw new Error("Function declaration name is required.");if(i.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);i.set(c.name,a)}}return i}async processAfcStream(e){var n,r,o;const i=(o=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:cf;let s=!1,a=0;const u=await this.initAfcToolsMap(e);return function(c,f,m){return Jt(this,arguments,function*(){for(var p,g,E,v,T,y;a<i;){s&&(a++,s=!1);const b=yield Ce(c.processParamsMaybeAddMcpUsage(m)),M=yield Ce(c.generateContentStreamInternal(b)),R=[],F=[];try{for(var x=!0,w=(g=void 0,Xt(M)),_;_=yield Ce(w.next()),p=_.done,!p;x=!0){v=_.value,x=!1;const D=v;if(yield yield Ce(D),D.candidates&&(!((T=D.candidates[0])===null||T===void 0)&&T.content)){F.push(D.candidates[0].content);for(const V of(y=D.candidates[0].content.parts)!==null&&y!==void 0?y:[])if(a<i&&V.functionCall){if(!V.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(V.functionCall.name)){const K=yield Ce(f.get(V.functionCall.name).callTool([V.functionCall]));R.push(...K)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${V.functionCall.name}`)}}}}catch(D){g={error:D}}finally{try{!x&&!p&&(E=w.return)&&(yield Ce(E.call(w)))}finally{if(g)throw g.error}}if(R.length>0){s=!0;const D=new lo;D.candidates=[{content:{role:"user",parts:R}}],yield yield Ce(D);const V=[];V.push(...F),V.push({role:"user",parts:R});const K=Gt(m.contents).concat(V);m.contents=K}else break}})}(this,u,e)}async generateContentInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=sf(this.apiClient,e);return a=ge("{model}:generateContent",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=lf(f),p=new lo;return Object.assign(p,m),p})}else{const c=of(this.apiClient,e);return a=ge("{model}:generateContent",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=af(f),p=new lo;return Object.assign(p,m),p})}}async generateContentStreamInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=sf(this.apiClient,e);return a=ge("{model}:streamGenerateContent?alt=sse",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.requestStream({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(m){return Jt(this,arguments,function*(){var p,g,E,v;try{for(var T=!0,y=Xt(m),x;x=yield Ce(y.next()),p=x.done,!p;T=!0){v=x.value,T=!1;const w=v,_=lf(yield Ce(w.json()));_.sdkHttpResponse={headers:w.headers};const b=new lo;Object.assign(b,_),yield yield Ce(b)}}catch(w){g={error:w}}finally{try{!T&&!p&&(E=y.return)&&(yield Ce(E.call(y)))}finally{if(g)throw g.error}}})})}else{const c=of(this.apiClient,e);return a=ge("{model}:streamGenerateContent?alt=sse",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.requestStream({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),s.then(function(m){return Jt(this,arguments,function*(){var p,g,E,v;try{for(var T=!0,y=Xt(m),x;x=yield Ce(y.next()),p=x.done,!p;T=!0){v=x.value,T=!1;const w=v,_=af(yield Ce(w.json()));_.sdkHttpResponse={headers:w.headers};const b=new lo;Object.assign(b,_),yield yield Ce(b)}}catch(w){g={error:w}}finally{try{!T&&!p&&(E=y.return)&&(yield Ce(E.call(y)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=$S(this.apiClient,e);return a=ge("{model}:predict",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=WS(f),p=new Hd;return Object.assign(p,m),p})}else{const c=zS(this.apiClient,e);return a=ge("{model}:batchEmbedContents",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=jS(f),p=new Hd;return Object.assign(p,m),p})}}async generateImagesInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=rE(this.apiClient,e);return a=ge("{model}:predict",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=iE(f),p=new Vd;return Object.assign(p,m),p})}else{const c=nE(this.apiClient,e);return a=ge("{model}:predict",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=oE(f),p=new Vd;return Object.assign(p,m),p})}}async editImageInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){const a=GS(this.apiClient,e);return i=ge("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const c=BS(u),f=new Yy;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){const a=rT(this.apiClient,e);return i=ge("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const c=oT(u),f=new Ky;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){const a=FE(this.apiClient,e);return i=ge("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const c=GE(u),f=new Jy;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){const a=jE(this.apiClient,e);return i=ge("{model}:predict",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const c=WE(u),f=new Xy;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=TE(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>pl(f))}else{const c=EE(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>hl(f))}}async listInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=kE(this.apiClient,e);return a=ge("{models_url}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=ME(f),p=new zd;return Object.assign(p,m),p})}else{const c=RE(this.apiClient,e);return a=ge("{models_url}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=PE(f),p=new zd;return Object.assign(p,m),p})}}async update(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=tT(this.apiClient,e);return a=ge("{model}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>pl(f))}else{const c=eT(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>hl(f))}}async delete(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=DS(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=US(f),p=new $d;return Object.assign(p,m),p})}else{const c=LS(this.apiClient,e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=OS(f),p=new $d;return Object.assign(p,m),p})}}async countTokens(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=kS(this.apiClient,e);return a=ge("{model}:countTokens",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=MS(f),p=new jd;return Object.assign(p,m),p})}else{const c=RS(this.apiClient,e);return a=ge("{model}:countTokens",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=PS(f),p=new jd;return Object.assign(p,m),p})}}async computeTokens(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){const a=wS(this.apiClient,e);return i=ge("{model}:computeTokens",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>{const c=CS(u),f=new Zy;return Object.assign(f,c),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=dE(this.apiClient,e);return a=ge("{model}:predictLongRunning",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s.then(f=>{const m=uE(f),p=new as;return Object.assign(p,m),p})}else{const c=cE(this.apiClient,e);return a=ge("{model}:predictLongRunning",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const m=lE(f),p=new as;return Object.assign(p,m),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XT extends Tn{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let i;r&&"httpOptions"in r&&(i=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:i}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=n.name.split("/operations/")[0];let i;r&&"httpOptions"in r&&(i=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:o,config:{httpOptions:i}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=Vy(e);return a=ge("{operationName}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),s}else{const c=Hy(e);return a=ge("{operationName}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s}}async fetchPredictVideosOperationInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){const a=Ly(e);return i=ge("{resourceName}:fetchPredictOperation",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZT(t){const e={},n=l(t,["data"]);if(n!=null&&d(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function QT(t){const e={},n=l(t,["parts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>lw(i))),d(e,["parts"],o)}const r=l(t,["role"]);return r!=null&&d(e,["role"],r),e}function ew(t,e,n){const r={},o=l(e,["expireTime"]);n!==void 0&&o!=null&&d(n,["expireTime"],o);const i=l(e,["newSessionExpireTime"]);n!==void 0&&i!=null&&d(n,["newSessionExpireTime"],i);const s=l(e,["uses"]);n!==void 0&&s!=null&&d(n,["uses"],s);const a=l(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&d(n,["bidiGenerateContentSetup"],aw(t,a));const u=l(e,["lockAdditionalFields"]);return n!==void 0&&u!=null&&d(n,["fieldMask"],u),r}function tw(t,e){const n={},r=l(e,["config"]);return r!=null&&d(n,["config"],ew(t,r,n)),n}function nw(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&d(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&d(e,["mimeType"],r),e}function rw(t){const e={},n=l(t,["id"]);n!=null&&d(e,["id"],n);const r=l(t,["args"]);r!=null&&d(e,["args"],r);const o=l(t,["name"]);if(o!=null&&d(e,["name"],o),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ow(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&d(e,["enableWidget"],n),e}function iw(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&d(e,["timeRangeFilter"],n),e}function sw(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&d(e,["setup","generationConfig"],r);const o=l(t,["responseModalities"]);e!==void 0&&o!=null&&d(e,["setup","generationConfig","responseModalities"],o);const i=l(t,["temperature"]);e!==void 0&&i!=null&&d(e,["setup","generationConfig","temperature"],i);const s=l(t,["topP"]);e!==void 0&&s!=null&&d(e,["setup","generationConfig","topP"],s);const a=l(t,["topK"]);e!==void 0&&a!=null&&d(e,["setup","generationConfig","topK"],a);const u=l(t,["maxOutputTokens"]);e!==void 0&&u!=null&&d(e,["setup","generationConfig","maxOutputTokens"],u);const c=l(t,["mediaResolution"]);e!==void 0&&c!=null&&d(e,["setup","generationConfig","mediaResolution"],c);const f=l(t,["seed"]);e!==void 0&&f!=null&&d(e,["setup","generationConfig","seed"],f);const m=l(t,["speechConfig"]);e!==void 0&&m!=null&&d(e,["setup","generationConfig","speechConfig"],Cu(m));const p=l(t,["thinkingConfig"]);e!==void 0&&p!=null&&d(e,["setup","generationConfig","thinkingConfig"],p);const g=l(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&d(e,["setup","generationConfig","enableAffectiveDialog"],g);const E=l(t,["systemInstruction"]);e!==void 0&&E!=null&&d(e,["setup","systemInstruction"],QT(ct(E)));const v=l(t,["tools"]);if(e!==void 0&&v!=null){let M=Jr(v);Array.isArray(M)&&(M=M.map(R=>cw(Kr(R)))),d(e,["setup","tools"],M)}const T=l(t,["sessionResumption"]);e!==void 0&&T!=null&&d(e,["setup","sessionResumption"],uw(T));const y=l(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&d(e,["setup","inputAudioTranscription"],y);const x=l(t,["outputAudioTranscription"]);e!==void 0&&x!=null&&d(e,["setup","outputAudioTranscription"],x);const w=l(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&d(e,["setup","realtimeInputConfig"],w);const _=l(t,["contextWindowCompression"]);e!==void 0&&_!=null&&d(e,["setup","contextWindowCompression"],_);const b=l(t,["proactivity"]);if(e!==void 0&&b!=null&&d(e,["setup","proactivity"],b),l(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function aw(t,e){const n={},r=l(e,["model"]);r!=null&&d(n,["setup","model"],ke(t,r));const o=l(e,["config"]);return o!=null&&d(n,["config"],sw(o,n)),n}function lw(t){const e={},n=l(t,["mediaResolution"]);n!=null&&d(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&d(e,["codeExecutionResult"],r);const o=l(t,["executableCode"]);o!=null&&d(e,["executableCode"],o);const i=l(t,["fileData"]);i!=null&&d(e,["fileData"],nw(i));const s=l(t,["functionCall"]);s!=null&&d(e,["functionCall"],rw(s));const a=l(t,["functionResponse"]);a!=null&&d(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&d(e,["inlineData"],ZT(u));const c=l(t,["text"]);c!=null&&d(e,["text"],c);const f=l(t,["thought"]);f!=null&&d(e,["thought"],f);const m=l(t,["thoughtSignature"]);m!=null&&d(e,["thoughtSignature"],m);const p=l(t,["videoMetadata"]);return p!=null&&d(e,["videoMetadata"],p),e}function uw(t){const e={},n=l(t,["handle"]);if(n!=null&&d(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function cw(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),d(e,["functionDeclarations"],f)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearchRetrieval"]);r!=null&&d(e,["googleSearchRetrieval"],r);const o=l(t,["computerUse"]);o!=null&&d(e,["computerUse"],o);const i=l(t,["fileSearch"]);i!=null&&d(e,["fileSearch"],i);const s=l(t,["codeExecution"]);if(s!=null&&d(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=l(t,["googleMaps"]);a!=null&&d(e,["googleMaps"],ow(a));const u=l(t,["googleSearch"]);u!=null&&d(e,["googleSearch"],iw(u));const c=l(t,["urlContext"]);return c!=null&&d(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dw(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const o=Object.keys(r).map(i=>`${n}.${i}`);e.push(...o)}else e.push(n)}return e.join(",")}function fw(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const i=r.setup;typeof i=="object"&&i!==null?(t.bidiGenerateContentSetup=i,n=i):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const o=t.fieldMask;if(n){const i=dw(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)i?t.fieldMask=i:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];o.length>0&&(a=o.map(c=>s.includes(c)?`generationConfig.${c}`:c));const u=[];i&&u.push(i),a.length>0&&u.push(...a),u.length>0?t.fieldMask=u.join(","):delete t.fieldMask}else delete t.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?t.fieldMask=o.join(","):delete t.fieldMask;return t}class hw extends Tn{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=tw(this.apiClient,e);i=ge("auth_tokens",a._url),s=a._query,delete a.config,delete a._url,delete a._query;const u=fw(a,e.config);return o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),o.then(c=>c)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pw(t,e){const n={},r=l(t,["force"]);return e!==void 0&&r!=null&&d(e,["_query","force"],r),n}function mw(t){const e={},n=l(t,["name"]);n!=null&&d(e,["_url","name"],n);const r=l(t,["config"]);return r!=null&&pw(r,e),e}function gw(t){const e={},n=l(t,["name"]);return n!=null&&d(e,["_url","name"],n),e}function yw(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&d(e,["_query","pageSize"],r);const o=l(t,["pageToken"]);return e!==void 0&&o!=null&&d(e,["_query","pageToken"],o),n}function vw(t){const e={},n=l(t,["parent"]);n!=null&&d(e,["_url","parent"],n);const r=l(t,["config"]);return r!=null&&yw(r,e),e}function xw(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&d(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&d(e,["nextPageToken"],r);const o=l(t,["documents"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(s=>s)),d(e,["documents"],i)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sw extends Tn{constructor(e){super(),this.apiClient=e,this.list=async n=>new cr(Sn.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=gw(e);return i=ge("{name}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(e){var n,r;let o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=mw(e);o=ge("{name}",s._url),i=s._query,delete s._url,delete s._query,await this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=vw(e);return i=ge("{parent}/documents",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const c=xw(u),f=new Qy;return Object.assign(f,c),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ew extends Tn{constructor(e,n=new Sw(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new cr(Sn.PAGED_ITEM_FILE_SEARCH_STORES,o=>this.listInternal(o),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=dT(e);return i=ge("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async get(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=pT(e);return i=ge("{name}",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>u)}}async delete(e){var n,r;let o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=hT(e);o=ge("{name}",s._url),i=s._query,delete s._url,delete s._query,await this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ST(e);return i=ge("fileSearchStores",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const c=ET(u),f=new ev;return Object.assign(f,c),f})}}async uploadToFileSearchStoreInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=TT(e);return i=ge("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const c=wT(u),f=new tv;return Object.assign(f,c),f})}}async importFile(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=yT(e);return i=ge("{file_search_store_name}:importFile",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),o.then(u=>{const c=gT(u),f=new xu;return Object.assign(f,c),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let cm=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return cm=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};const Tw=()=>cm();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gl(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const yl=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vt extends Error{}class gt extends Vt{constructor(e,n,r,o){super(`${gt.makeMessage(e,n,r)}`),this.status=e,this.headers=o,this.error=n}static makeMessage(e,n,r){const o=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,n,r,o){if(!e||!o)return new Ms({message:r,cause:yl(n)});const i=n;return e===400?new fm(e,i,r,o):e===401?new hm(e,i,r,o):e===403?new pm(e,i,r,o):e===404?new mm(e,i,r,o):e===409?new gm(e,i,r,o):e===422?new ym(e,i,r,o):e===429?new vm(e,i,r,o):e>=500?new xm(e,i,r,o):new gt(e,i,r,o)}}class vl extends gt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Ms extends gt{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class dm extends Ms{constructor({message:e}={}){super({message:e??"Request timed out."})}}class fm extends gt{}class hm extends gt{}class pm extends gt{}class mm extends gt{}class gm extends gt{}class ym extends gt{}class vm extends gt{}class xm extends gt{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ww=/^[a-z][a-z0-9+.-]*:/i,Cw=t=>ww.test(t);let xl=t=>(xl=Array.isArray,xl(t));const _w=xl;let Nw=_w;const pf=Nw;function Iw(t){if(!t)return!0;for(const e in t)return!1;return!0}function bw(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Aw=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Vt(`${t} must be an integer`);if(e<0)throw new Vt(`${t} must be a positive integer`);return e},Rw=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const kw=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pr="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pw(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Mw=()=>{var t,e,n,r,o;const i=Pw();if(i==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pr,"X-Stainless-OS":gf(Deno.build.os),"X-Stainless-Arch":mf(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(i==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pr,"X-Stainless-OS":gf((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":mf((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};const s=Lw();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":pr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Lw(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const o=r[1]||0,i=r[2]||0,s=r[3]||0;return{browser:e,version:`${o}.${i}.${s}`}}}return null}const mf=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",gf=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let pi;const Dw=()=>pi??(pi=Mw());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ow(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Sm(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function Uw(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return Sm({start(){},async pull(n){const{done:r,value:o}=await e.next();r?n.close():n.enqueue(o)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function Em(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Fw(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const r=t.getReader(),o=r.cancel();r.releaseLock(),await o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Gw=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Tm=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function da(t,e,n){return Tm(),new File(t,e??"unknown_file",n)}function Bw(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const Hw=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wm=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Vw=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&wm(t),zw=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function $w(t,e,n){if(Tm(),t=await t,Vw(t))return t instanceof File?t:da([await t.arrayBuffer()],t.name);if(zw(t)){const o=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),da(await Sl(o),e,n)}const r=await Sl(t);if(e||(e=Bw(t)),!(n!=null&&n.type)){const o=r.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof o=="string"&&(n=Object.assign(Object.assign({},n),{type:o}))}return da(r,e,n)}async function Sl(t){var e,n,r,o,i;let s=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)s.push(t);else if(wm(t))s.push(t instanceof Blob?t:await t.arrayBuffer());else if(Hw(t))try{for(var a=!0,u=Xt(t),c;c=await u.next(),e=c.done,!e;a=!0){o=c.value,a=!1;const f=o;s.push(...await Sl(f))}}catch(f){n={error:f}}finally{try{!a&&!e&&(r=u.return)&&await r.call(u)}finally{if(n)throw n.error}}else{const f=(i=t==null?void 0:t.constructor)===null||i===void 0?void 0:i.name;throw new Error(`Unexpected data type: ${typeof t}${f?`; constructor: ${f}`:""}${jw(t)}`)}return s}function jw(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cm{constructor(e){this._client=e}}Cm._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _m(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const yf=Object.freeze(Object.create(null)),Ww=(t=_m)=>function(n,...r){if(n.length===1)return n[0];let o=!1;const i=[],s=n.reduce((f,m,p)=>{var g,E,v;/[?#]/.test(m)&&(o=!0);const T=r[p];let y=(o?encodeURIComponent:t)(""+T);return p!==r.length&&(T==null||typeof T=="object"&&T.toString===((v=Object.getPrototypeOf((E=Object.getPrototypeOf((g=T.hasOwnProperty)!==null&&g!==void 0?g:yf))!==null&&E!==void 0?E:yf))===null||v===void 0?void 0:v.toString))&&(y=T+"",i.push({start:f.length+m.length,length:y.length,error:`Value of type ${Object.prototype.toString.call(T).slice(8,-1)} is not a valid path parameter`})),f+m+(p===r.length?"":y)},""),a=s.split(/[?#]/,1)[0],u=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=u.exec(a))!==null;)i.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(i.sort((f,m)=>f.start-m.start),i.length>0){let f=0;const m=i.reduce((p,g)=>{const E=" ".repeat(g.start-f),v="^".repeat(g.length);return f=g.start+g.length,p+E+v},"");throw new Vt(`Path parameters result in path with invalid segments:
${i.map(p=>p.error).join(`
`)}
${s}
${m}`)}return s},mi=Ww(_m);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Nm extends Cm{create(e,n){var r;const{api_version:o=this._client.apiVersion}=e,i=us(e,["api_version"]);if("model"in i&&"agent_config"in i)throw new Vt("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in i&&"generation_config"in i)throw new Vt("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(mi`/${o}/interactions`,Object.assign(Object.assign({body:i},n),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,n={},r){const{api_version:o=this._client.apiVersion}=n??{};return this._client.delete(mi`/${o}/interactions/${e}`,r)}cancel(e,n={},r){const{api_version:o=this._client.apiVersion}=n??{};return this._client.post(mi`/${o}/interactions/${e}/cancel`,r)}get(e,n={},r){var o;const i=n??{},{api_version:s=this._client.apiVersion}=i,a=us(i,["api_version"]);return this._client.get(mi`/${s}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(o=n==null?void 0:n.stream)!==null&&o!==void 0?o:!1}))}}Nm._key=Object.freeze(["interactions"]);class Im extends Nm{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qw(t){let e=0;for(const o of t)e+=o.length;const n=new Uint8Array(e);let r=0;for(const o of t)n.set(o,r),r+=o.length;return n}let gi;function Nu(t){let e;return(gi??(e=new globalThis.TextEncoder,gi=e.encode.bind(e)))(t)}let yi;function vf(t){let e;return(yi??(e=new globalThis.TextDecoder,yi=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ls{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Nu(e):e;this.buffer=qw([this.buffer,n]);const r=[];let o;for(;(o=Yw(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){r.push(vf(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const i=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,s=vf(this.buffer.subarray(0,i));r.push(s),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}Ls.NEWLINE_CHARS=new Set([`
`,"\r"]);Ls.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Yw(t,e){for(let o=e??0;o<t.length;o++){if(t[o]===10)return{preceding:o,index:o+1,carriage:!1};if(t[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function Kw(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cs={off:0,error:200,warn:300,info:400,debug:500},xf=(t,e,n)=>{if(t){if(bw(cs,t))return t;ht(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(cs))}`)}};function yo(){}function vi(t,e,n){return!e||cs[t]>cs[n]?yo:e[t].bind(e)}const Jw={error:yo,warn:yo,info:yo,debug:yo};let Sf=new WeakMap;function ht(t){var e;const n=t.logger,r=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return Jw;const o=Sf.get(n);if(o&&o[0]===r)return o[1];const i={error:vi("error",n,r),warn:vi("warn",n,r),info:vi("info",n,r),debug:vi("debug",n,r)};return Sf.set(n,[r,i]),i}const Xn=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rr{constructor(e,n,r){this.iterator=e,this.controller=n,this.client=r}static fromSSEResponse(e,n,r){let o=!1;const i=r?ht(r):console;function s(){return Jt(this,arguments,function*(){var u,c,f,m;if(o)throw new Vt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let p=!1;try{try{for(var g=!0,E=Xt(Xw(e,n)),v;v=yield Ce(E.next()),u=v.done,!u;g=!0){m=v.value,g=!1;const T=m;if(!p)if(T.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield Ce(JSON.parse(T.data))}catch(y){throw i.error("Could not parse message into JSON:",T.data),i.error("From chunk:",T.raw),y}}}catch(T){c={error:T}}finally{try{!g&&!u&&(f=E.return)&&(yield Ce(f.call(E)))}finally{if(c)throw c.error}}p=!0}catch(T){if(gl(T))return yield Ce(void 0);throw T}finally{p||n.abort()}})}return new Rr(s,n,r)}static fromReadableStream(e,n,r){let o=!1;function i(){return Jt(this,arguments,function*(){var u,c,f,m;const p=new Ls,g=Em(e);try{for(var E=!0,v=Xt(g),T;T=yield Ce(v.next()),u=T.done,!u;E=!0){m=T.value,E=!1;const y=m;for(const x of p.decode(y))yield yield Ce(x)}}catch(y){c={error:y}}finally{try{!E&&!u&&(f=v.return)&&(yield Ce(f.call(v)))}finally{if(c)throw c.error}}for(const y of p.flush())yield yield Ce(y)})}function s(){return Jt(this,arguments,function*(){var u,c,f,m;if(o)throw new Vt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let p=!1;try{try{for(var g=!0,E=Xt(i()),v;v=yield Ce(E.next()),u=v.done,!u;g=!0){m=v.value,g=!1;const T=m;p||T&&(yield yield Ce(JSON.parse(T)))}}catch(T){c={error:T}}finally{try{!g&&!u&&(f=E.return)&&(yield Ce(f.call(E)))}finally{if(c)throw c.error}}p=!0}catch(T){if(gl(T))return yield Ce(void 0);throw T}finally{p||n.abort()}})}return new Rr(s,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),o=i=>({next:()=>{if(i.length===0){const s=r.next();e.push(s),n.push(s)}return i.shift()}});return[new Rr(()=>o(e),this.controller,this.client),new Rr(()=>o(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return Sm({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:o,done:i}=await n.next();if(i)return r.close();const s=Nu(JSON.stringify(o)+`
`);r.enqueue(s)}catch(o){r.error(o)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}}function Xw(t,e){return Jt(this,arguments,function*(){var r,o,i,s;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Vt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Vt("Attempted to iterate over a response with no body");const a=new Qw,u=new Ls,c=Em(t.body);try{for(var f=!0,m=Xt(Zw(c)),p;p=yield Ce(m.next()),r=p.done,!r;f=!0){s=p.value,f=!1;const g=s;for(const E of u.decode(g)){const v=a.decode(E);v&&(yield yield Ce(v))}}}catch(g){o={error:g}}finally{try{!f&&!r&&(i=m.return)&&(yield Ce(i.call(m)))}finally{if(o)throw o.error}}for(const g of u.flush()){const E=a.decode(g);E&&(yield yield Ce(E))}})}function Zw(t){return Jt(this,arguments,function*(){var n,r,o,i;let s=new Uint8Array;try{for(var a=!0,u=Xt(t),c;c=yield Ce(u.next()),n=c.done,!n;a=!0){i=c.value,a=!1;const f=i;if(f==null)continue;const m=f instanceof ArrayBuffer?new Uint8Array(f):typeof f=="string"?Nu(f):f;let p=new Uint8Array(s.length+m.length);p.set(s),p.set(m,s.length),s=p;let g;for(;(g=Kw(s))!==-1;)yield yield Ce(s.slice(0,g)),s=s.slice(g)}}catch(f){r={error:f}}finally{try{!a&&!n&&(o=u.return)&&(yield Ce(o.call(u)))}finally{if(r)throw r.error}}s.length>0&&(yield yield Ce(s))})}class Qw{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,o]=eC(e,":");return o.startsWith(" ")&&(o=o.substring(1)),n==="event"?this.event=o:n==="data"&&this.data.push(o),null}}function eC(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function tC(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:o,startTime:i}=e,s=await(async()=>{var a;if(e.options.stream)return ht(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Rr.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const u=n.headers.get("content-type"),c=(a=u==null?void 0:u.split(";")[0])===null||a===void 0?void 0:a.trim();return(c==null?void 0:c.includes("application/json"))||(c==null?void 0:c.endsWith("+json"))?await n.json():await n.text()})();return ht(t).debug(`[${r}] response parsed`,Xn({retryOfRequestLogID:o,url:n.url,status:n.status,body:s,durationMs:Date.now()-i})),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Iu extends Promise{constructor(e,n,r=tC){super(o=>{o(null)}),this.responsePromise=n,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new Iu(this.client,this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bm=Symbol("brand.privateNullableHeaders");function*nC(t){if(!t)return;if(bm in t){const{values:r,nulls:o}=t;yield*r.entries();for(const i of o)yield[i,null];return}let e=!1,n;t instanceof Headers?n=t.entries():pf(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const o=r[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const i=pf(r[1])?r[1]:[r[1]];let s=!1;for(const a of i)a!==void 0&&(e&&!s&&(s=!0,yield[o,null]),yield[o,a])}}const uo=t=>{const e=new Headers,n=new Set;for(const r of t){const o=new Set;for(const[i,s]of nC(r)){const a=i.toLowerCase();o.has(a)||(e.delete(i),o.add(a)),s===null?(e.delete(i),n.add(a)):(e.append(i,s),n.delete(a))}}return{[bm]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fa=t=>{var e,n,r,o,i,s;if(typeof globalThis.process<"u")return(r=(n=(e=by)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(s=(i=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||i===void 0?void 0:i.call(o,t))===null||s===void 0?void 0:s.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Am;class Ds{constructor(e){var n,r,o,i,s,a,u,{baseURL:c=fa("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:f=(n=fa("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:m="v1beta"}=e,p=us(e,["baseURL","apiKey","apiVersion"]);const g=Object.assign(Object.assign({apiKey:f,apiVersion:m},p),{baseURL:c||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(r=g.timeout)!==null&&r!==void 0?r:Ds.DEFAULT_TIMEOUT,this.logger=(o=g.logger)!==null&&o!==void 0?o:console;const E="warn";this.logLevel=E,this.logLevel=(s=(i=xf(g.logLevel,"ClientOptions.logLevel",this))!==null&&i!==void 0?i:xf(fa("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&s!==void 0?s:E,this.fetchOptions=g.fetchOptions,this.maxRetries=(a=g.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(u=g.fetch)!==null&&u!==void 0?u:Ow(),this.encoder=Gw,this._options=g,this.apiKey=f,this.apiVersion=m,this.clientAdapter=g.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=uo([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return uo([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return uo([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Vt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${pr}`}defaultIdempotencyKey(){return`stainless-node-retry-${Tw()}`}makeStatusError(e,n,r,o){return gt.generate(e,n,r,o)}buildURL(e,n,r){const o=!this.baseURLOverridden()&&r||this.baseURL,i=Cw(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Iw(s)||(n=Object.assign(Object.assign({},s),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(i.search=this.stringifyQuery(n)),i.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(o=>Object.assign({method:e,path:n},o)))}request(e,n=null){return new Iu(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var o,i,s;const a=await e,u=(o=a.maxRetries)!==null&&o!==void 0?o:this.maxRetries;n==null&&(n=u),await this.prepareOptions(a);const{req:c,url:f,timeout:m}=await this.buildRequest(a,{retryCount:u-n});await this.prepareRequest(c,{url:f,options:a});const p="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=r===void 0?"":`, retryOf: ${r}`,E=Date.now();if(ht(this).debug(`[${p}] sending request`,Xn({retryOfRequestLogID:r,method:a.method,url:f,options:a,headers:c.headers})),!((i=a.signal)===null||i===void 0)&&i.aborted)throw new vl;const v=new AbortController,T=await this.fetchWithTimeout(f,c,m,v).catch(yl),y=Date.now();if(T instanceof globalThis.Error){const w=`retrying, ${n} attempts remaining`;if(!((s=a.signal)===null||s===void 0)&&s.aborted)throw new vl;const _=gl(T)||/timed? ?out/i.test(String(T)+("cause"in T?String(T.cause):""));if(n)return ht(this).info(`[${p}] connection ${_?"timed out":"failed"} - ${w}`),ht(this).debug(`[${p}] connection ${_?"timed out":"failed"} (${w})`,Xn({retryOfRequestLogID:r,url:f,durationMs:y-E,message:T.message})),this.retryRequest(a,n,r??p);throw ht(this).info(`[${p}] connection ${_?"timed out":"failed"} - error; no more retries left`),ht(this).debug(`[${p}] connection ${_?"timed out":"failed"} (error; no more retries left)`,Xn({retryOfRequestLogID:r,url:f,durationMs:y-E,message:T.message})),_?new dm:new Ms({cause:T})}const x=`[${p}${g}] ${c.method} ${f} ${T.ok?"succeeded":"failed"} with status ${T.status} in ${y-E}ms`;if(!T.ok){const w=await this.shouldRetry(T);if(n&&w){const D=`retrying, ${n} attempts remaining`;return await Fw(T.body),ht(this).info(`${x} - ${D}`),ht(this).debug(`[${p}] response error (${D})`,Xn({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,durationMs:y-E})),this.retryRequest(a,n,r??p,T.headers)}const _=w?"error; no more retries left":"error; not retryable";ht(this).info(`${x} - ${_}`);const b=await T.text().catch(D=>yl(D).message),M=Rw(b),R=M?void 0:b;throw ht(this).debug(`[${p}] response error (${_})`,Xn({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,message:R,durationMs:Date.now()-E})),this.makeStatusError(T.status,M,R,T.headers)}return ht(this).info(x),ht(this).debug(`[${p}] response start`,Xn({retryOfRequestLogID:r,url:T.url,status:T.status,headers:T.headers,durationMs:y-E})),{response:T,options:a,controller:v,requestLogID:p,retryOfRequestLogID:r,startTime:E}}async fetchWithTimeout(e,n,r,o){const i=n||{},{signal:s,method:a}=i,u=us(i,["signal","method"]);s&&s.addEventListener("abort",()=>o.abort());const c=setTimeout(()=>o.abort(),r),f=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,m=Object.assign(Object.assign(Object.assign({signal:o.signal},f?{duplex:"half"}:{}),{method:"GET"}),u);a&&(m.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,m)}finally{clearTimeout(c)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,o){var i;let s;const a=o==null?void 0:o.get("retry-after-ms");if(a){const c=parseFloat(a);Number.isNaN(c)||(s=c)}const u=o==null?void 0:o.get("retry-after");if(u&&!s){const c=parseFloat(u);Number.isNaN(c)?s=Date.parse(u)-Date.now():s=c*1e3}if(!(s&&0<=s&&s<60*1e3)){const c=(i=e.maxRetries)!==null&&i!==void 0?i:this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,c)}return await kw(s),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,s=Math.min(.5*Math.pow(2,i),8),a=1-Math.random()*.25;return s*a*1e3}async buildRequest(e,{retryCount:n=0}={}){var r,o,i;const s=Object.assign({},e),{method:a,path:u,query:c,defaultBaseURL:f}=s,m=this.buildURL(u,c,f);"timeout"in s&&Aw("timeout",s.timeout),s.timeout=(r=s.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:p,body:g}=this.buildBody({options:s}),E=await this.buildHeaders({options:e,method:a,bodyHeaders:p,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:E},s.signal&&{signal:s.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(i=s.fetchOptions)!==null&&i!==void 0?i:{}),url:m,timeout:s.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:o}){let i={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const s=await this.authHeaders(e);let a=uo([i,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),Dw()),this._options.defaultHeaders,r,e.headers,s]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=uo([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Uw(e)}:this.encoder({body:e,headers:r})}}Ds.DEFAULT_TIMEOUT=6e4;class tt extends Ds{constructor(){super(...arguments),this.interactions=new Im(this)}}Am=tt;tt.GeminiNextGenAPIClient=Am;tt.GeminiNextGenAPIClientError=Vt;tt.APIError=gt;tt.APIConnectionError=Ms;tt.APIConnectionTimeoutError=dm;tt.APIUserAbortError=vl;tt.NotFoundError=mm;tt.ConflictError=gm;tt.RateLimitError=vm;tt.BadRequestError=fm;tt.AuthenticationError=hm;tt.InternalServerError=xm;tt.PermissionDeniedError=pm;tt.UnprocessableEntityError=ym;tt.toFile=$w;tt.Interactions=Im;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rC(t,e){const n={},r=l(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function oC(t,e){const n={},r=l(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function iC(t,e){const n={},r=l(t,["sdkHttpResponse"]);return r!=null&&d(n,["sdkHttpResponse"],r),n}function sC(t,e){const n={},r=l(t,["sdkHttpResponse"]);return r!=null&&d(n,["sdkHttpResponse"],r),n}function aC(t,e,n){const r={};if(l(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=l(t,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&d(e,["displayName"],o),l(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=l(t,["epochCount"]);e!==void 0&&i!=null&&d(e,["tuningTask","hyperparameters","epochCount"],i);const s=l(t,["learningRateMultiplier"]);if(s!=null&&d(r,["tuningTask","hyperparameters","learningRateMultiplier"],s),l(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(l(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(l(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=l(t,["batchSize"]);e!==void 0&&a!=null&&d(e,["tuningTask","hyperparameters","batchSize"],a);const u=l(t,["learningRate"]);if(e!==void 0&&u!=null&&d(e,["tuningTask","hyperparameters","learningRate"],u),l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(l(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function lC(t,e,n){const r={};let o=l(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const g=l(t,["validationDataset"]);e!==void 0&&g!=null&&d(e,["supervisedTuningSpec"],Ef(g))}else if(o==="PREFERENCE_TUNING"){const g=l(t,["validationDataset"]);e!==void 0&&g!=null&&d(e,["preferenceOptimizationSpec"],Ef(g))}const i=l(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&d(e,["tunedModelDisplayName"],i);const s=l(t,["description"]);e!==void 0&&s!=null&&d(e,["description"],s);let a=l(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const g=l(t,["epochCount"]);e!==void 0&&g!=null&&d(e,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(a==="PREFERENCE_TUNING"){const g=l(t,["epochCount"]);e!==void 0&&g!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let u=l(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const g=l(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&d(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(u==="PREFERENCE_TUNING"){const g=l(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let c=l(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const g=l(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&d(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(c==="PREFERENCE_TUNING"){const g=l(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&d(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let f=l(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const g=l(t,["adapterSize"]);e!==void 0&&g!=null&&d(e,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(f==="PREFERENCE_TUNING"){const g=l(t,["adapterSize"]);e!==void 0&&g!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(l(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(l(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=l(t,["labels"]);e!==void 0&&m!=null&&d(e,["labels"],m);const p=l(t,["beta"]);return e!==void 0&&p!=null&&d(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),r}function uC(t,e){const n={},r=l(t,["baseModel"]);r!=null&&d(n,["baseModel"],r);const o=l(t,["preTunedModel"]);o!=null&&d(n,["preTunedModel"],o);const i=l(t,["trainingDataset"]);i!=null&&SC(i);const s=l(t,["config"]);return s!=null&&aC(s,n),n}function cC(t,e){const n={},r=l(t,["baseModel"]);r!=null&&d(n,["baseModel"],r);const o=l(t,["preTunedModel"]);o!=null&&d(n,["preTunedModel"],o);const i=l(t,["trainingDataset"]);i!=null&&EC(i,n,e);const s=l(t,["config"]);return s!=null&&lC(s,n,e),n}function dC(t,e){const n={},r=l(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function fC(t,e){const n={},r=l(t,["name"]);return r!=null&&d(n,["_url","name"],r),n}function hC(t,e,n){const r={},o=l(t,["pageSize"]);e!==void 0&&o!=null&&d(e,["_query","pageSize"],o);const i=l(t,["pageToken"]);e!==void 0&&i!=null&&d(e,["_query","pageToken"],i);const s=l(t,["filter"]);return e!==void 0&&s!=null&&d(e,["_query","filter"],s),r}function pC(t,e,n){const r={},o=l(t,["pageSize"]);e!==void 0&&o!=null&&d(e,["_query","pageSize"],o);const i=l(t,["pageToken"]);e!==void 0&&i!=null&&d(e,["_query","pageToken"],i);const s=l(t,["filter"]);return e!==void 0&&s!=null&&d(e,["_query","filter"],s),r}function mC(t,e){const n={},r=l(t,["config"]);return r!=null&&hC(r,n),n}function gC(t,e){const n={},r=l(t,["config"]);return r!=null&&pC(r,n),n}function yC(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const o=l(t,["nextPageToken"]);o!=null&&d(n,["nextPageToken"],o);const i=l(t,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>Rm(a))),d(n,["tuningJobs"],s)}return n}function vC(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const o=l(t,["nextPageToken"]);o!=null&&d(n,["nextPageToken"],o);const i=l(t,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>El(a))),d(n,["tuningJobs"],s)}return n}function xC(t,e){const n={},r=l(t,["name"]);r!=null&&d(n,["model"],r);const o=l(t,["name"]);return o!=null&&d(n,["endpoint"],o),n}function SC(t,e){const n={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=l(t,["examples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),d(n,["examples","examples"],o)}return n}function EC(t,e,n){const r={};let o=l(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const s=l(t,["gcsUri"]);e!==void 0&&s!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(o==="PREFERENCE_TUNING"){const s=l(t,["gcsUri"]);e!==void 0&&s!=null&&d(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}let i=l(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const s=l(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&d(e,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(i==="PREFERENCE_TUNING"){const s=l(t,["vertexDatasetResource"]);e!==void 0&&s!=null&&d(e,["preferenceOptimizationSpec","trainingDatasetUri"],s)}if(l(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Rm(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const o=l(t,["name"]);o!=null&&d(n,["name"],o);const i=l(t,["state"]);i!=null&&d(n,["state"],Wp(i));const s=l(t,["createTime"]);s!=null&&d(n,["createTime"],s);const a=l(t,["tuningTask","startTime"]);a!=null&&d(n,["startTime"],a);const u=l(t,["tuningTask","completeTime"]);u!=null&&d(n,["endTime"],u);const c=l(t,["updateTime"]);c!=null&&d(n,["updateTime"],c);const f=l(t,["description"]);f!=null&&d(n,["description"],f);const m=l(t,["baseModel"]);m!=null&&d(n,["baseModel"],m);const p=l(t,["_self"]);return p!=null&&d(n,["tunedModel"],xC(p)),n}function El(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const o=l(t,["name"]);o!=null&&d(n,["name"],o);const i=l(t,["state"]);i!=null&&d(n,["state"],Wp(i));const s=l(t,["createTime"]);s!=null&&d(n,["createTime"],s);const a=l(t,["startTime"]);a!=null&&d(n,["startTime"],a);const u=l(t,["endTime"]);u!=null&&d(n,["endTime"],u);const c=l(t,["updateTime"]);c!=null&&d(n,["updateTime"],c);const f=l(t,["error"]);f!=null&&d(n,["error"],f);const m=l(t,["description"]);m!=null&&d(n,["description"],m);const p=l(t,["baseModel"]);p!=null&&d(n,["baseModel"],p);const g=l(t,["tunedModel"]);g!=null&&d(n,["tunedModel"],g);const E=l(t,["preTunedModel"]);E!=null&&d(n,["preTunedModel"],E);const v=l(t,["supervisedTuningSpec"]);v!=null&&d(n,["supervisedTuningSpec"],v);const T=l(t,["preferenceOptimizationSpec"]);T!=null&&d(n,["preferenceOptimizationSpec"],T);const y=l(t,["tuningDataStats"]);y!=null&&d(n,["tuningDataStats"],y);const x=l(t,["encryptionSpec"]);x!=null&&d(n,["encryptionSpec"],x);const w=l(t,["partnerModelTuningSpec"]);w!=null&&d(n,["partnerModelTuningSpec"],w);const _=l(t,["customBaseModel"]);_!=null&&d(n,["customBaseModel"],_);const b=l(t,["experiment"]);b!=null&&d(n,["experiment"],b);const M=l(t,["labels"]);M!=null&&d(n,["labels"],M);const R=l(t,["outputUri"]);R!=null&&d(n,["outputUri"],R);const F=l(t,["pipelineJob"]);F!=null&&d(n,["pipelineJob"],F);const D=l(t,["serviceAccount"]);D!=null&&d(n,["serviceAccount"],D);const V=l(t,["tunedModelDisplayName"]);V!=null&&d(n,["tunedModelDisplayName"],V);const K=l(t,["veoTuningSpec"]);return K!=null&&d(n,["veoTuningSpec"],K),n}function TC(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&d(n,["sdkHttpResponse"],r);const o=l(t,["name"]);o!=null&&d(n,["name"],o);const i=l(t,["metadata"]);i!=null&&d(n,["metadata"],i);const s=l(t,["done"]);s!=null&&d(n,["done"],s);const a=l(t,["error"]);return a!=null&&d(n,["error"],a),n}function Ef(t,e){const n={},r=l(t,["gcsUri"]);r!=null&&d(n,["validationDatasetUri"],r);const o=l(t,["vertexDatasetResource"]);return o!=null&&d(n,["validationDatasetUri"],o),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wC extends Tn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new cr(Sn.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const o={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(o.checkpointId=n.config.preTunedModelCheckpointId);const i=Object.assign(Object.assign({},n),{preTunedModel:o});return i.baseModel=void 0,await this.tuneInternal(i)}else{const o=Object.assign({},n);return await this.tuneInternal(o)}else{const o=Object.assign({},n),i=await this.tuneMldevInternal(o);let s="";return i.metadata!==void 0&&i.metadata.tunedModel!==void 0?s=i.metadata.tunedModel:i.name!==void 0&&i.name.includes("/operations/")&&(s=i.name.split("/operations/")[0]),{name:s,state:ul.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=fC(e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>El(f))}else{const c=dC(e);return a=ge("{name}",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>Rm(f))}}async listInternal(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=gC(e);return a=ge("tuningJobs",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=vC(f),p=new Wd;return Object.assign(p,m),p})}else{const c=mC(e);return a=ge("tunedModels",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=yC(f),p=new Wd;return Object.assign(p,m),p})}}async cancel(e){var n,r,o,i;let s,a="",u={};if(this.apiClient.isVertexAI()){const c=oC(e);return a=ge("{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=sC(f),p=new qd;return Object.assign(p,m),p})}else{const c=rC(e);return a=ge("{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),s.then(f=>{const m=iC(f),p=new qd;return Object.assign(p,m),p})}}async tuneInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI()){const a=cC(e,e);return i=ge("tuningJobs",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>El(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let o,i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=uC(e);return i=ge("tunedModels",a._url),s=a._query,delete a._url,delete a._query,o=this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(c=>{const f=c;return f.sdkHttpResponse={headers:u.headers},f})),o.then(u=>TC(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CC{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const _C=1024*1024*8,NC=3,IC=1e3,bC=2,ds="x-goog-upload-status";async function AC(t,e,n){var r;const o=await km(t,e,n),i=await(o==null?void 0:o.json());if(((r=o==null?void 0:o.headers)===null||r===void 0?void 0:r[ds])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return i.file}async function RC(t,e,n){var r;const o=await km(t,e,n),i=await(o==null?void 0:o.json());if(((r=o==null?void 0:o.headers)===null||r===void 0?void 0:r[ds])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const s=Bp(i),a=new Su;return Object.assign(a,s),a}async function km(t,e,n){var r,o;let i=0,s=0,a=new cl(new Response),u="upload";for(i=t.size;s<i;){const c=Math.min(_C,i-s),f=t.slice(s,s+c);s+c>=i&&(u+=", finalize");let m=0,p=IC;for(;m<NC&&(a=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(s),"Content-Length":String(c)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[ds]));)m++,await PC(p),p=p*bC;if(s+=c,((o=a==null?void 0:a.headers)===null||o===void 0?void 0:o[ds])!=="active")break;if(i<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function kC(t){return{size:t.size,type:t.type}}function PC(t){return new Promise(e=>setTimeout(e,t))}class MC{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await AC(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await RC(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await kC(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LC{create(e,n,r){return new DC(e,n,r)}}class DC{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Tf="x-goog-api-key";class OC{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(Tf)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Tf,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UC="gl-node/";class FC{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new tt({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Py(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const o=new OC(this.apiKey);this.apiClient=new kT({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:UC+"web",uploader:new MC,downloader:new CC}),this.models=new JT(this.apiClient),this.live=new $T(this.apiClient,o,new LC),this.batches=new ax(this.apiClient),this.chats=new Vx(this.models,this.apiClient),this.caches=new Gx(this.apiClient),this.files=new Zx(this.apiClient),this.operations=new XT(this.apiClient),this.authTokens=new hw(this.apiClient),this.tunings=new wC(this.apiClient),this.fileSearchStores=new Ew(this.apiClient)}}const St={webtoon:{name:"  ",desc:"   +    ( )",prompt:"Premium Korean Historical Webtoon Style, High Quality 2D Digital Art, Crisp Line Art (Outlines), Cel Shading, Smooth Coloring, Beautiful Characters (Sparkling eyes, delicate features, pale skin, soft blush), Fusion Hanbok, Vibrant and Pastel tones, Webtoon Cover Art aesthetic, Sharp focus, No photorealism, Manhwa style"},animation:{name:"  ",desc:" ,  ",prompt:"2D cell animation style, Korean folklore atmosphere, flat shading, clean lines, Studio Ghibli inspired but Korean Joseon aesthetics"},inkwash:{name:"  (Modern)",desc:"   +   ",prompt:"Modern Korean emotional watercolor illustration, beautiful and handsome characters with modern aesthetic faces (sharp jawline, large expressive eyes, delicate features), soft transparent watercolor texture, ink spreading effect, dreamy and romantic atmosphere, detailed character design, NOT old traditional folk art style, NOT round ugly faces, pastel tones, artistic masterpiece"},fantasy:{name:"  ()",desc:"    ",prompt:"soft semi-realistic webtoon painting with clean bold lineart. Use thicker black outlines on the character (about 1.52x thicker than background linework) and slightly bold internal lines (eyes, nose, lips, hair strands, hanbok folds). Keep background linework thinner and softer. Smooth gradient shading (avoid hard cel shading), low-contrast natural earthy palette, minimal texture (no gritty details, no skin pores). Subtle depth-of-field: character crisp and sharp, background gently softened/blurred for focus separation. Clean edges, no sticker-like halo."}},bu=[{category:Ir.HARM_CATEGORY_HARASSMENT,threshold:br.BLOCK_NONE},{category:Ir.HARM_CATEGORY_HATE_SPEECH,threshold:br.BLOCK_NONE},{category:Ir.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:br.BLOCK_NONE},{category:Ir.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:br.BLOCK_NONE}],Mt=t=>{if(!t)throw new Error("API   .   'API  '    .");return new FC({apiKey:t})},qn=t=>{try{let e=t.replace(/```json\s*/g,"").replace(/```\s*/g,"");return e=e.trim(),JSON.parse(e)}catch(e){throw console.error("JSON Parse Error:",e,"Raw Text:",t),new Error("AI    . (JSON  )")}},Pm=`
  NEGATIVE PROMPT: **TEXT**, **WRITING**, **LETTERS**, **SIGNATURE**, **WATERMARK**, **SPEECH BUBBLE**, **DIALOGUE BUBBLE**, **SUBTITLES**, **CAPTIONS**, **LOGO**, **LOOKING AT CAMERA**, **EYE CONTACT**, posing for photo, selfie, modern items, electricity, cars, concrete, western clothes, beds, chairs, glass windows, paved roads, Japanese style shoes (Geta/Zori), Chinese queues, dirty face (unless specified), messy hair (unless specified), short skirt, showing legs, modernized hanbok, 3d render, plastic skin, western lingerie, nipples, genitals, modern bra, thick clothes, winter clothes.
`,GC=`
  CONTEXT: Korea, Joseon Dynasty (Historical Setting).
  ${Pm}
`,Mm=async(t,e)=>{const n=Mt(t),r=e.match(/^data:(.+);base64,(.+)$/);if(!r)return"Imported image";const o=`
    Analyze this character image for a CONTINUITY SHEET.
    
    [CRITICAL INSTRUCTION: VISUAL FACTS ONLY]
    - **NO PERSONALITY**: Do NOT describe personality (e.g., "brave", "kind", "sad").
    - **NO EMOTION**: Do NOT describe current emotion (e.g., "smiling", "angry").
    - **PHYSICAL APPEARANCE ONLY**: Focus 100% on visual details (Clothes, Hair, Face features).

    [CRITICAL INSTRUCTION: CHILD AGE & DETAILS]
    - **AGE CHECK**: Estimate the age. If under 20, explicitly state "Child (Age X)".
    - **FACE DETAILS**: 
      - **MUST MENTION**: Scars, Beards, Moles, Wrinkles, Eye shape.
      - **MUST MENTION**: Skin texture (Rough/Smooth/Tanned).
    
    [CRITICAL INSTRUCTION: NO HELD ITEMS]
    - **DO NOT DESCRIBE PROPS or ITEMS IN HANDS.** (e.g., No sword, No book, No cup, No bag).
    - Focus ONLY on the person's invariant appearance.

    1. **HEADWEAR**: Exact type (Gat, Nambawi, None) and color.
    2. **HAIR**: Exact style (Topknot, Braid, Bun) and hairline.
    3. **CLOTHING**: 
       - Top (Jeogori) Color & Pattern.
       - Bottom (Baji/Chima) Color.
       - Outer (Dopo/Jangot) Color.
    4. **FACE**: Eye shape, facial hair (beard/mustache), distinct features (scars/moles).
    5. **BODY**: Physique, height, build (e.g., muscular, slender, sturdy).
    
    Output a single paragraph. Be extremely precise about COLORS and PHYSICAL FEATURES.
  `;try{return(await n.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{inlineData:{mimeType:r[1],data:r[2]}},{text:o}]}})).text||"Imported Character Reference"}catch(i){return console.error("Vision Analysis Failed",i),"Imported Character Reference (Analysis Failed)"}},BC=async(t,e,n)=>{var s;const r=Mt(t),o=e.match(/^data:(.+);base64,(.+)$/);if(!o)return"";const i=`
    Analyze this image to create a Visual Description for a Character Design Option.
    
    [TARGET CATEGORY]: ${n}
    (e.g., if category is 'hair', focus ONLY on the hair. If 'headwear', focus on the hat.)
    
    [CONTEXT]
    The user wants to add this specific style to their character builder.
    The description will be used as a prompt for Image Generation AI (Stable Diffusion/Midjourney style).
    
    [INSTRUCTIONS]
    1. **FOCUS**: Ignore the background, ignore the face (unless category is 'face'). Look ONLY at the ${n}.
    2. **DETAIL**: Describe the shape, material, color, and texture.
    3. **TERMINOLOGY**: Use precise English terms. If it's a traditional Korean item (Joseon Dynasty), try to describe its look (e.g., "Black horsehair hat with wide brim" for Gat).
    4. **FORMAT**: Return a concise, comma-separated descriptive string.
    
    [EXAMPLE OUTPUTS]
    - (Category: Hair): "Traditional Korean Gache, large braided wig, ornate gold hairpins, heavy volume"
    - (Category: Clothing): "Red royal robe, gold dragon embroidery on chest and shoulders, wide sleeves"
  `;try{return((s=(await r.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{inlineData:{mimeType:o[1],data:o[2]}},{text:i}]}})).text)==null?void 0:s.trim())||""}catch(a){throw console.error("Option Analysis Failed",a),new Error("  .")}},wf={webtoon:"",animation:"",inkwash:"",fantasy:""},Cf={webtoon:"  ,  ,  ,  ,  ",animation:"2D  ,   ,  ,  ,   ",inkwash:"   ,   ,   ,  ,  ",fantasy:"   ,  ,  ,  ,   "},HC=async(t,e,n,r,o,i)=>{const s=Mt(t),a=e.map((c,f)=>{var E;const p=f>0&&e[f-1].location===c.location?"(SAME SET AS SCENE "+f+" - CAMERA ANGLE CHANGE ONLY)":"",g=(((E=c.casting)==null?void 0:E.mainIds)||[]).map(v=>{const T=o.find(x=>x.id===v);if(!T)return null;const y=i.find(x=>x.name===T.name);return`${T.name} (Age: ${T.age||"Unknown"}): ${y?y.description:T.description}`}).filter(Boolean).join("; ");return`
    [SCENE ${f+1}]
    - Location: ${c.location} ${p}
    - Time: ${c.timeOfDay}
    - Script: "${c.scriptSegment}"
    - Summary: "${c.description}"
    - Characters: ${g||"None (Landscape/Crowd)"}
    - Type: ${c.sceneType}
    `}).join(`

`),u=`
    You are a professional Prompt Engineer.
    Convert these ${e.length} scenes into DETAILED KOREAN PROMPTS with structured tags.

    [GLOBAL STYLE]
    Selected Style: ${n.toUpperCase()} (${wf[n]||n})
    Style Details: ${Cf[n]||n}

    [INSTRUCTIONS]
    For each scene, generate a detailed **KOREAN** prompt following this EXACT format:
    
    [: ${wf[n]||n} , ${Cf[n]||n}] [: (Camera Details)] [: (Composition)] [: (Character Names)] [: (Expressions)] [: (Situation Summary)] [: (Detailed Action)] [: (Detailed Background)] [/: (Lighting, Season, Tone)]

    [RULES]
    1. **LANGUAGE**: MUST BE KOREAN.
    2. **TAGS**: Use the exact bracket tags provided above.
    3. **DETAILS**:
       - **[]**: MUST START WITH THE STYLE NAME (e.g., " ", " ") followed by details.
       - **[]**: **BE SPECIFIC**: Tracking direction (Front/Side/Back), Height (Low/Eye/High Angle).
         - **SHOT SIZE RESTRICTION (CRITICAL)**: **DO NOT USE Close-up or Bust Shot**.
         - **MINIMUM SIZE**: **Waist Shot** (From waist up) or wider (Knee Shot, Full Shot, Long Shot).
         - **REASON**: The user will zoom in during video editing, so we need wider framing to preserve quality.
       - **[]**: Character position (Center/Left/Right), Distance/Depth (e.g., Distance from gate).
       - **[]**: List main characters.
       - **[]**: **EMOTION & NUANCE**: Describe specific emotions (e.g., Nervous, Determined, Fearful, Curious).
       - **[]**: **COPY THE SUMMARY**: Use the provided 'Summary' field directly here.
       - **[]**: **MICRO-DETAIL ACTION & MOVEMENT**.
         - Describe facial muscle movements, specific hand gestures, body posture tension, and interaction with objects.
         - **BAD**: "He eats." / "She cries."
         - **GOOD**: "He tears the chicken leg with his teeth, grease dripping down his chin, eyes wide with hunger."
         - **GOOD**: "Tears well up in her eyes and stream down her flushed cheeks, her lips trembling as she bites them."
         - **[CRITICAL] GENDER CLOTHING CHECK**:
           - **IF MALE**: DO NOT WRITE "(Skirt)" or "Dress". Write "(Trousers)", "(Robe)", "(Hem)".
           - **IF FEMALE**: "(Skirt)" is okay.
           - **NEVER** describe a man's clothing as "skirt covering feet". Use "Robes covering feet" or "Trousers".
       - **[]**: Describe the environment vividly.
         - **CONTINUITY CHECK**: If the location says "(SAME SET)", you MUST describe the **EXACT SAME BACKGROUND ELEMENTS** as the previous scene.
         - **CAMERA ROTATION**: Imagine the characters are on a fixed set. Only the camera moves. Do NOT change the furniture/trees/buildings.
         - **PERSPECTIVE**: If the camera turns 180 degrees, describe the *reverse* angle of the SAME location.
       - **[/]**: **TIME OF DAY** (Must specify: Dawn, Morning, Noon, Afternoon, Sunset, Evening, Night, or Midnight). **SEASON** (Spring/Summer/Autumn/Winter). **COLOR TONE** (e.g., Warm yellow dust, Cold blue moonlight).
    4. **SEASON/TIME**: Infer from context if missing.
    5. **NO NEGATIVES**: Do not include negative prompts.
    6. **CHARACTER CONSISTENCY**: Use the provided Character names.
    7. **CHILD AGE MARKER (CRITICAL)**:
         - If a character is a CHILD (under 20 years old), you **MUST** prefix their name with their age in the [] tag and [] description.
         - **Format**: "[Age] [Name]" (e.g., "7 ", "12 ").
         - **Reason**: To ensure they look like children in the generated image.
         - Adults (20+) do NOT need this.
    8. **NO TEXT VISUALIZATION (CRITICAL)**:
         - **ABSOLUTELY NO TEXT**: Do NOT describe speech bubbles, sound effects (SFX), floating text, subtitles, or written signs in the image description.
         - **PURE VISUALS**: Describe only the physical reality. If a character speaks, describe their *mouth moving* or *expression*, NOT a speech bubble.

      [OUTPUT FORMAT]
    Return a JSON array of strings.
    Example:
    [
      "[:   ...] [:  ,  ] [: ] [:       ] [:        ,     .    .] [:  ...] [:  ]",
      ...
    ]
  `;try{const c=await s.models.generateContent({model:"gemini-2.5-flash",contents:[{text:a},{text:u}],config:{responseMimeType:"application/json"}});if(c.text){const f=qn(c.text);if(Array.isArray(f)&&f.length===e.length)return f}throw new Error("Batch generation returned invalid format")}catch(c){return console.error("Prompt Generation Failed",c),e.map(()=>"")}},VC=async(t,e,n,r,o,i,s,a,u,c)=>{const f=Mt(t),m=s.length>0?`[KNOWN CHARACTERS (MANDATORY TO USE)]
${s.map(v=>`- ${v.name} (Age: ${v.age||"Unknown"}): ${v.name} looks like character reference image.`).join(`
`)}

[CHARACTER MATCHING RULE]
- If any of these characters appear in the script, you MUST use their EXACT NAME in the 'characterNames' list.
- **INTERACTION RULE**: If Character A interacts with Character B (talks to, looks at, helps, hits), **BOTH MUST BE IN THE LIST**.
- Even if they are minor/supporting roles (), do NOT ignore them.
- Do NOT rename them.`:"",E=`
    Act as a **MASTER CINEMATIC DIRECTOR** for a high-budget Movie/Webtoon.
    Analyze the script and create a detailed **STORYBOARD** for a specific part of the story.
    
    ${a}
    ${m}
    
    [BATCH GENERATION MODE]
    ${o}
    ${i}
    
    [CRITICAL MISSION: DYNAMIC STORYTELLING]
    - **GOAL**: Transform text into a **VISUAL EXPERIENCE**. 
    - **STYLE**: Dynamic, Action-Oriented, Cinematic.
    - **TARGET**: Generate EXACTLY ${n} scenes starting from Scene #${r}.
    - **NO SPLIT FRAMES**: ABSOLUTELY NO COMIC STRIP LAYOUTS, NO SPLIT SCREENS, NO MULTI-PANEL IMAGES. One image = One full moment.

    [SCENE BREAKDOWN RULES (USER PRIORITY)]
    1. **ONE SCENE = ONE ACTION/MOMENT**:
       - If a sentence contains **multiple sequential actions** (e.g., "A punches B, THEN B falls down"), you MUST **SPLIT** them into separate scenes.
       - **BAD**: Scene 1: "A punches B and B falls." (This confuses the AI).
       - **GOOD**: 
          - Scene 1: "A throws a punch at B."
          - Scene 2: "B is hit and starts to fall backward."
    2. **PACING**:
       - Do NOT drag out simple walking/talking scenes at the end just to fill the count.
       - **DENSITY CONTROL**: 
          - **Action/Fight**: HIGH DENSITY (Split every punch/reaction).
          - **Dialogue/Travel**: MEDIUM DENSITY (Focus on key expressions/atmosphere).
    3. **AVOID "MANGA STYLE"**:
       - Never ask for "split screen", "collage", or "sequence of shots" in one image.
       - Focus on **ONE** specific split-second moment per scene.
    4. **UNIFORM PACING & DENSITY (USER COMPLAINT FIX)**:
       - **ISSUE**: The user complains that early scenes (1-15) are too fast/sparse, and later scenes (25-30) are too slow/detailed.
       - **SOLUTION**: 
          - **EARLY SCENES**: BREAK THEM DOWN! Do not summarize 10 lines of dialogue into 1 scene. Split every emotional beat.
          - **LATE SCENES**: Maintain the same density. Do not start analyzing every blink of an eye just to fill quota.
          - **CONSISTENCY**: The level of detail in Scene #1 must be IDENTICAL to Scene #30.

    [CRITICAL: CHARACTER PRESENCE & CONTINUITY]
    1. **INTERACTION implies PRESENCE**: If the script describes an interaction (looking at, talking to, helping, fighting), ALL involved characters must be listed.
    2. **CONTINUITY OF GROUPS (The "Where did they go?" Rule)**:
       - **Logic**: Characters do not vanish into thin air.
       - **Rule**: If a group of characters are together in Scene X, and Scene X+1 is a direct continuation (same time/place or continuous travel), **ALL OF THEM** must be present in Scene X+1 unless the script explicitly says someone left.
       - **Focus**: Do not focus only on the character performing the *action*. Focus on who is *present in the space*.
       - *Example*: If A and B are walking together, and the next scene shows A stopping to look at something, **B is still standing right there**. Include B.
    3. **PASSIVE PRESENCE**: Even if a character has no lines and no specific action in the current beat, if they were established as being there, they are present.
    4. **NEVER** exclude a character mentioned in the current action just because they don't speak.
    5. **CHILD AGE MARKER (CRITICAL)**:
       - If a character is a CHILD (under 20 years old), you **MUST** prefix their name with their age in the 'visualPrompt' [] tag and [] description.
       - **Format**: "[Age] [Name]" (e.g., "7 ", "12 ").
       - **Reason**: To ensure they look like children in the generated image.

    [VISUAL RULES - THE "BANGTONG" STANDARD]
    1. **METHOD ACTING & PSYCHOLOGICAL DEPTH (NO EYE CONTACT)**:
       - **INVISIBLE CAMERA (CRITICAL)**: Characters must NEVER look at the camera lens. They must look at each other, at an object, or into the distance.
       - **SHOW, DON'T TELL (Psychological Description)**:
         - Do NOT simply say "He is sad" or "She is angry".
         - **DESCRIBE THE SYMPTOMS**: "His head hangs low, eyes fixed on his trembling hands" (Sadness). "Her jaw is clenched tight, neck veins bulging, breathing heavily" (Anger).
       - **MICRO-EXPRESSIONS & INVOLUNTARY ACTIONS**:
         - Focus on **UNCONSCIOUS** movements: trembling lips, dilated pupils, sweat beading on forehead, knuckles turning white.
       - **ACTIVE HANDS**: Hands should never be idle or just hanging. They should be gripping clothes, holding an object, touching their face, or gesturing dynamically.

    2. **AUTO-POPULATE EXTRAS (WORLD BUILDING)**:
       - If Location is "Market" -> AUTOMATICALLY ADD "Peddlers, Shoppers, Children running".
       - If Location is "Palace" -> AUTOMATICALLY ADD "Eunuchs, Court Ladies walking in line".
       - The world must feel ALIVE.

    3. **CAMERA DIRECTIONS & ACTION DETAIL**:
       - **CAMERA**: Use cinematic terms (Low Angle, High Angle, Full Shot, etc.) to enhance the visual storytelling.
       - **ACTION**: Describe **MICRO-ACTIONS** in detail.
       - **Instead of** "Close up of hand", **Write** "His knuckles turn white as he grips the sword handle, veins popping on his forearm."
       - **Instead of** "Low angle of hero", **Write** "He stands tall with chest puffed out, looking down with a sneer, casting a long shadow over the viewer."

    ${u?`4. **PRESERVE OPENING SCENERY (CRITICAL)**:
       - **OPENING SHOT**: If the script starts with a landscape/location description, YOU MUST MAKE IT SCENE 1.
       - **ALIVE WORLD RULE**: If the opening is a "Market", "Tavern", or "Village", **DO NOT DRAW AN EMPTY STREET**.
         - Even if no specific character is there, you **MUST DESCRIBE A CROWD**: "Busy market with peddlers and shoppers", "Villagers walking by".
         - **BAD**: "An empty market street."
         - **GOOD**: "A bustling market filled with merchants, customers, and steam rising from food stalls."`:""}
    ${c?'- **ENDING SHOT**: If the script ends with a lingering view (e.g., "Empty road", "Sunset"), YOU MUST MAKE IT THE LAST SCENE.\n       - **NO MID-SCENE FILLERS**: Do NOT create pure scenic shots in the middle unless it\'s a major time jump.\n       - **NO CHARACTER RULE**: For these shots, keep `characterNames` empty `[]`, but describe the *Anonymous Crowd* in the `description`.':""}

    5. **CONTINUITY & FLOW**:
       - Use transitions in descriptions: "Continuing from previous shot...", "Reaction to...", "The camera follows...".
       - Ensure logical flow of movement between cuts.

    [OUTPUT JSON STRUCTURE]
    Return an ARRAY of objects.
    [{ 
      "sceneNumber": ${r}, 
      "location": "Location (KOREAN)", 
      "timeOfDay": "Day/Night (KOREAN)", 
      "scriptSegment": "Original Script Text (KOREAN - DO NOT TRANSLATE)", 
      "summary": "Short Narrative Summary (KOREAN)", 
      "visualPrompt": "Detailed Visual Prompt (KOREAN)", 
      "sceneType": "action|emotion|landscape",
      "characterNames": ["Name1", "Name2"] 
    }]

    [FIELD RULES]
    1. **scriptSegment**: Keep original Korean text. Group dialogue lines if needed to fit the scene count.
    2. **location/timeOfDay**: Keep in Korean.
    3. **sceneType**: 'action', 'emotion', or 'landscape'.
    4. **characterNames**: List ALL characters PHYSICALLY PRESENT.
       - **STRICT RULE**: If the action involves two people, BOTH names MUST be here.
       - Include **EXTRAS** if you added them (e.g., ["Villagers", "Merchant"]).
    5. **summary**: A short, simple narrative description of the scene context.
       - Example: "Dam-i arrives at the busy market and looks around."
    6. **visualPrompt**: **THE DETAILED PROMPT FOR IMAGE GENERATION**.
       - **STYLE DEFINITION (CRITICAL)**: The style is "Webtoon", BUT this is for **"Yadam/Mindam Audiobook Video Illustrations"**.
          - **DO NOT** create a comic book page (No panels, No speech bubbles, No text effects, No Sound Effects).
          - **DO** create a **SINGLE, HIGH-QUALITY CINEMATIC ILLUSTRATION** that looks like a frame from a high-budget animated movie.
       - Format: "[: Webtoon Style (Audiobook Video Art)] [: Angle/Shot] [: Names] [: Summary] [: EXTREME DETAIL ACTION] [: Extras/Atmosphere] [: Mood]"
       - **Example**: "[:   (/   )] [:  ,  ] [: ] [:     ] [:     ,      .    .] [:        .] [:     ]"
       
       - **CONTEXT**: Korea, Joseon Dynasty (Historical Setting).
       - **CAMERA**: Include [] tag with specific angle/shot size.
       - **NO TEXT (STRICT)**: Do NOT describe speech bubbles, sound effects (SFX), floating text, subtitles, or written signs.
       - **NO SPLIT**: Do NOT use words like "split screen", "panel", "collage".
       - **ONE MOMENT**: Describe ONLY what happens in a SINGLE split second. Do NOT say "He runs AND THEN jumps". Say "He is mid-air jumping".
       - **NO CHARACTER APPEARANCE REPETITION (CRITICAL)**: 
          - **ABSOLUTELY FORBIDDEN**: Do NOT describe the character's fixed appearance (e.g., "wearing a blue hanbok", "long hair", "scar on face", "skirt covering feet") in the \`visualPrompt\`.
          - **REASON**: We already have separate reference images for the characters.
          - **FOCUS ONLY ON ACTION**: Only describe what changes in this specific moment (facial expression, hand gesture, posture, interaction).
          - **BAD**: "Chul-soo, wearing a red coat and black hat, draws his sword."
          - **GOOD**: "Chul-soo draws his sword with a fierce grimace."

    SCRIPT:
    ${e}
  `;try{const v=await f.models.generateContent({model:"gemini-2.5-flash",contents:E,config:{responseMimeType:"application/json",maxOutputTokens:2e4,safetySettings:bu}});if(v.text){const T=qn(v.text);if(Array.isArray(T))return T.map((y,x)=>({id:`scene-${Date.now()}-${x}`,...y,description:y.summary,englishPrompt:y.visualPrompt}))}return[]}catch(v){throw console.error(v),new Error("   (   ).")}},zC=async(t,e,n=[],r=25,o=[],i)=>{var g;let a=[...n];const u=n.length;let c=0;const f=Math.ceil(r/10),m=f*2,p=n.length>0?`EXISTING LOCATIONS: ${n.map(E=>`${E.location} (${E.description})`).join("; ")}`:"";for(;a.length-u<r&&c<m;){const E=a.length-u,v=r-E,T=f-c;let y=10;if(T>0?y=Math.ceil(v/T):y=Math.min(10,v),y<=0)break;const x=c===0&&u===0,w=v<=10,_=a.length+1,b=a.length>0?a[a.length-1]:null,M=b?`[PREVIOUS SCENE CONTEXT]
- Last Scene #${b.sceneNumber}: ${b.scriptSegment}
- Location: ${b.location}
- Action: ${b.description}
- Characters Present: ${((g=b.characterNames)==null?void 0:g.join(", "))||"None"}

[INSTRUCTION]
- **DO NOT REPEAT** the event of the last scene.
- **CONTINUE** directly from this point. Start the NEXT event immediately.`:`[INSTRUCTION]
- Start from the VERY BEGINNING of the script.`,R=e.length,F=Math.ceil(R/f),D=c*F,V=Math.min((c+1)*F+500,R);let K=V;if(K<R){const Y=e.lastIndexOf(".",K),L=e.lastIndexOf(`
`,K);K=Math.max(Y,L),K<D&&(K=V)}e.substring(0,K+100);const A=c+1,z=(c/f*100).toFixed(0),C=((c+1)/f*100).toFixed(0),q=`
        [INTELLIGENT PACING CONTROL (Batch ${A}/${f})]
        - **CURRENT PROGRESS**: ${z}% -> ${C}% of the story.
        - **YOUR GOAL**: Analyze the script ONLY up to the ${C}% mark.
        - **DO NOT RUSH**: Do NOT try to finish the story in this batch. You have ${f-A} more batches left.
        - **DO NOT DRAG**: Do NOT stretch a single sentence into 5 scenes. Keep a steady rhythm.
        - **DENSITY RULE**: 
           - Ideal Density: 1 Scene per 2-3 sentences of dialogue/action.
           - Action Scenes: 1 Scene per punch/move.
           - Dialogue Scenes: 1 Scene per emotional shift (not per line).
     `;let ue=0,$=!1;for(;ue<3&&!$;)try{ue>0&&console.log(`Retrying batch ${c+1} (Attempt ${ue+1})...`);const Y=await VC(t,e,y,_,M,q,o,p,x,w);if(Y.length>0){const L=Y.map((Z,G)=>({...Z,id:Z.id||`scene-${Date.now()}-${_+G}`}));a=[...a,...L],$=!0}else console.warn(`Batch ${c+1} attempt ${ue+1} returned empty.`),ue++}catch(Y){console.error(`Batch ${c+1} attempt ${ue+1} failed:`,Y),ue++,await new Promise(L=>setTimeout(L,1e3))}if(!$){console.error(`Batch ${c+1} failed after 3 attempts. Stopping generation to preserve partial results.`);break}c++}return a},$C=async(t,e,n,r=[])=>{const o=Mt(t),i=`
    You are a Casting Director. Extract characters from the script.
    OUTPUT JSON:
    [{ "name": "Name (KOREAN)", "visualGuide": "Korean Desc", "age": "20", "gender": "Male", "description": "English visual prompt", "isGroup": false }]

    [LANGUAGE RULES]
    1. **name**: Keep in KOREAN (e.g., "").
    2. **visualGuide**: Korean description for the user.
    3. **description**: English visual description for AI.
    4. **EXTRAS/GROUPS**: Extract anonymous groups as characters too (e.g., "Villagers", "Bandits").
       - Name: "Villagers" (or "Guests", "Soldiers")
       - VisualGuide: "Joseon peasants in dirty clothes"
       - Description: "Crowd of Korean peasants wearing white hanbok, straw shoes, rough texture."
    5. **isGroup**: Set to true if the name implies multiple people (e.g., ends with "", "", or is "People", "Crowd", "Soldiers").

    [CRITICAL RULE: NO PROPS/OBJECTS IN DESCRIPTION]
    - **ABSOLUTELY FORBIDDEN**: Do NOT include specific items held in hands (e.g., "holding a hammer", "carrying a radish", "holding a sword", "smoking a pipe").
    - **REASON**: If you write "holding a hammer", the character will hold a hammer in EVERY SINGLE SCENE (even when sleeping or eating).
    - **FOCUS ON PHYSIQUE**: Describe the **Physical Body** and **Face** instead.
      - BAD: "Blacksmith holding a heavy hammer."
      - GOOD: "Blacksmith with muscular arms, thick neck, sweaty skin, soot on face, wearing a leather apron."
      - BAD: "Market woman holding a basket of radishes."
      - GOOD: "Market woman with a sturdy build, sun-tanned skin, wearing a worn-out cotton hanbok, friendly round face."
    - **CLOTHING ONLY**: Describe the clothes, hair, and body type. NO HELD ITEMS.

    SCRIPT:
    ${e.substring(0,5e4)}
  `;try{const s=await o.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",maxOutputTokens:15e3}});if(s.text){const a=qn(s.text);if(Array.isArray(a))return a.map((u,c)=>{var g;let f=u.description;(/|||||||/.test(u.name)||/police|constable|soldier|guard|officer/.test(((g=u.visualGuide)==null?void 0:g.toLowerCase())||""))&&(f="This character wears a traditional black *gat* hat with a subtle sheen, featuring a black braided band, a thinner reddish-brown braided band, and a gold-colored finial on top. On the right side, vibrant multi-colored ribbons in dark blue, emerald green, bright yellow, rich red, and a lighter blue/purple, along with bright yellow tassels, are attached. His dark hair is neatly styled, likely in a topknot under the hat as traditional, with a clean hairline. The visible clothing includes a pure white *jeogori* (top), covered by a deep charcoal grey or black long outer robe and an inner vest-like garment of the same color, both featuring a very subtle, fine, dark grey patterned texture. A striking, vibrant red sash is tied at the waist with long ends hanging down. The bottom garment consists of pure white, loose-fitting *baji* (trousers)");const p=u.isGroup||/$|$|$|$||||||/.test(u.name);return{id:`char-${Date.now()}-${c}`,...u,description:f,isGroup:p,hasDialogue:!0,chromaKeyColor:"green",actions:[]}})}return[]}catch(s){return console.error(s),[]}},jC=async(t,e,n,r)=>{const o=Mt(t),i=e.match(/^data:(.+);base64,(.+)$/);if(!i)throw new Error("   .");const s=`
    Analyze the provided image and the user's request to create a JSON specification for video generation.

    [USER REQUEST]
    "${n}"

    [OPTIONS]
    - Dialogue Enabled: ${r.dialogue}
    - Background Music (BGM): ${r.bgm}
    - Sound Effects (SFX): ${r.sfx}

    [TASK]
    Create a JSON object matching the 'VideoSceneSpec' structure.
    1. **video_prompt**: Create a highly detailed English prompt for video generation (like Runway Gen-2 or Veo).
       - Describe the motion, camera movement, and visual details based on the image and user request.
       - Include keywords like "dynamic motion", "high quality", "4k".
       - If the user request implies a specific action, describe it vividly.
       - IMPORTANT: The prompt must be in ENGLISH.
    2. **motion_bucket**: Suggest a motion bucket value (1-255). Higher for more action. Default to 127 if unsure.
    3. **cfg_scale**: Suggest a guidance scale (1.0-20.0). Default to 7.5 for best fidelity.
    4. **camera_motion**: Describe camera movement (e.g., "Pan Right", "Zoom In", "Static", "Horizontal", "Vertical").
    5. **dialogue**: 
       - If options.dialogue is TRUE: Generate a suitable line of dialogue in **KOREAN** based on the context/prompt.
       - If options.dialogue is FALSE: Set text to empty string.
       - Set enabled based on options.dialogue.
       - **CRITICAL**: The 'text' field MUST be in **KOREAN** (Hangul). Do NOT translate to English.
    6. **audio**: 
       - Set bgm based on options.bgm.
       - If options.sfx is TRUE: List specific SFX keywords (English) in an array (e.g., ["footsteps", "wind"]).
       - If options.sfx is FALSE: Set sfx to [].

    [OUTPUT FORMAT]
    Return ONLY the raw JSON object. No markdown, no code blocks.

    Example JSON Structure:
    {
      "id": "SCENE_UUID",
      "base_image": "",
      "video_prompt": "A close-up of the old man looking surprised...",
      "motion_bucket": 127,
      "cfg_scale": 7.5,
      "camera_motion": "Zoom In",
      "dialogue": {
        "enabled": true,
        "text": "   ?"
      },
      "audio": {
        "bgm": true,
        "sfx": ["rustling leaves", "gasp"]
      }
    }
  `;try{const u=(await o.models.generateContent({model:"gemini-2.0-flash-exp",contents:{parts:[{inlineData:{mimeType:i[1],data:i[2]}},{text:s}]},config:{responseMimeType:"application/json"}})).text||"{}";return{...qn(u),id:crypto.randomUUID(),base_image:e}}catch(a){throw console.error("Video Spec Generation Failed",a),new Error("   .")}},WC=async(t,e,n,r="auto",o)=>{const i=Mt(t),s=n.map(u=>`[CHARACTER: ${u.name}] ${u.description}`).join(`
`),a=`
    Act as a YouTube Thumbnail Artist.
    ${o?`[CRITICAL MISSION]: Create a thumbnail that perfectly matches this specific title: "${o}". Find the scene in the script that corresponds to this title.`:`Analyze the script and selected theme (${r}) to create ONE IMPACTFUL THUMBNAIL CONCEPT.`}

    SCRIPT:
    ${e.substring(0,3e4)}

    CHARACTERS:
    ${s}

    TASK:
    1. ${o?`**MATCH THE TITLE**: The visual MUST explain why the title is "${o}".`:"Identify the CORE CONFLICT or RELATIONSHIP in the script."}
    2. **CHARACTER-CENTRIC COMPOSITION**:
       - **MUST INCLUDE CHARACTERS**: Folk tales (Yadam) rely on characters. Do not just show objects.
       - **KEY FIGURES**: Usually a beautiful woman (Femme Fatale/Victim) and a man (Hero/Villain/Observer).
       - **DYNAMIC**: Show the tension between them (e.g., A woman seducing a scholar, A man threatening a woman, A tragic farewell).
       - **EXTRAS**: If the scene is a market or palace, include blurred extras in the background for scale.
    3. **METHOD ACTING (BANGTONG STYLE)**:
       - **EXPRESSION IS KING**: The characters must have **INTENSE, DRAMATIC EXPRESSIONS**.
       - **PSYCHOLOGICAL DEPTH**: Do not just show a face. Show the **INTERNAL STRUGGLE**.
       - **NO DEAD EYES**: Eyes must be alive with desire, fear, anger, or sorrow.
       - **ACTIVE POSING**: Do not just stand. Lean in, grab, push, or hide. Make it look like a paused frame from a high-budget movie.
       - **NO CAMERA STARE**: Unless it's a specific "breaking the 4th wall" concept, look at the target of the emotion.
    4. **VISUAL METAPHOR**: Combine the characters with a symbolic action (e.g., Offering a poisoned drink, Hiding a knife).
    5. **COMPOSITION STRATEGY**:
       - Decide whether to place the character on the **RIGHT** (for text space on left) or **CENTER** (for impact).
       - **RIGHT ALIGNMENT**: Good for dialogue or explanatory text on the left.
       - **CENTER ALIGNMENT**: Good for intense portraits or symmetrical scenes.
       - **NO BLACK VOID**: Do not describe a black background. Describe the full scene.
    7. **SAFETY & POLICY COMPLIANCE (CRITICAL)**:
       - **NO GORE/BLOOD**: Do NOT show blood, open wounds, or severed body parts. Use red lighting or red fabric to symbolize danger instead.
       - **NO EXPLICIT VIOLENCE**: Do NOT show the act of beheading or torture directly. Show the *moment before* (tension) or the *aftermath* (emotional reaction).
       - **SAFE METAPHORS**: Instead of a severed head, show a fallen hat or a broken sword. Instead of torture, show ropes and shadows.
       - **FOCUS ON APPEARANCE, NOT ACTION**: Instead of "being tortured", describe the result: "torn clothes, bruises on face, messy hair, sweat, intense fear".
       - **WEAPONS**: Weapons (swords, knives) are allowed but must not be actively cutting flesh. They should be held threateningly or sheathed.

    OUTPUT JSON:
     {
         "title": "${o||"Short Catchy Title (Korean)"}",
         "composition": "right",
         "action": "Description of the situation, background, and character actions (English). DO NOT include character physical appearance here.",
         "characters": [
            { "name": "Character Name (Korean)", "action": "Specific pose/expression for this character" }
         ]
     }
    `;try{const u=await i.models.generateContent({model:"gemini-2.5-flash",contents:a,config:{responseMimeType:"application/json"}});if(u.text)return qn(u.text);throw new Error("No response text")}catch(u){throw console.error(u),new Error("  ")}},fs=async(t,e)=>{var n;if(!e||!/[-]/.test(e))return e;try{return((n=(await t.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:`Translate the following Korean text to English for an image generation prompt. Keep it concise and descriptive. Text: "${e}"`}]}})).text)==null?void 0:n.trim())||e}catch(r){return console.error("Translation failed, using original text:",r),e}},qC=async(t,e,n,r={})=>{const o=Mt(t),i=n.match(/^data:(.+);base64,(.+)$/);if(!i)throw new Error("   .");const s=r.sceneCount||3,a=r.startSceneNumber||1,u=`
    You are a Master Video Director.
    Your task is to visualize a story into a sequence of ${s} consecutive video scenes.

    [STORY SEGMENT]
    "${e}"

    [INPUT IMAGE CONTEXT]
    The provided image represents the **STARTING POINT** (Scene #${a}) of this specific segment.
    **DO NOT DESCRIBE THE IMAGE ITSELF**. The image is already there. 
    Your job is to describe the **ACTION** and **MOTION** that happens *from* this image.

    [TASK]
    1. Break the story down into exactly ${s} sequential scenes (Scene #${a} to #${a+s-1}).
    2. Each scene represents a 6-second video clip.
    3. The scenes must be **CONTINUOUS**.
    4. **VISUAL EVOLUTION (PRIORITY)**:
       - If there is a physical transformation (e.g., aging, rejuvenation, shapeshifting), THIS IS THE MOST IMPORTANT PART.
       - **START WITH THE CHANGE**: The prompt must explicitly describe the morphing process.
       - Use keywords like: **"Morphing"**, **"Transforming"**, **"Visibly changing"**, **"Reverting to youth"**.
       - Example: "The old man's face is **visibly morphing**, wrinkles are **smoothing out**, transforming into a young man."
    5. **Video Prompts (English)**:
       - Write a highly detailed, cinematic video generation prompt for each scene.
       - **KEYWORD FIRST**: Place the **MAIN ACTION** or **TRANSFORMATION** at the VERY BEGINNING of the prompt.
       - **DIRECT COMMAND STYLE**: Do NOT write a novel. Use short, punchy sentences. "Subject VERBS Object."
       - **BAD**: "Suddenly, a mystical phenomenon occurs as the man's face begins to change." (Too abstract)
       - **GOOD**: "The man's face MORPHS into a young face. Wrinkles DISAPPEAR. Skin SMOOTHENS." (Direct)
       - **FOCUS ON MOTION**: Describe **WHAT MOVES** and **HOW IT MOVES**. 
       - **NO STATIC DESCRIPTION**: Do NOT waste tokens describing "A man in black clothes stands on the left". Instead, say "The man in black on the left **turns his head sharply**".
       - **NO STYLE INJECTION**: Do NOT add words like "High quality", "4k", "Masterpiece" unless the user story explicitly asks for it. Just describe the scene.
       - For Scene #${a}, describe the action starting from the provided image.
       - For subsequent scenes, describe the action evolving from the previous one.

    [OUTPUT FORMAT]
    Return a JSON array of 'VideoSceneSpec' objects.

    Structure:
    [
      {
        "id": "generated-id-1",
        "base_image": "USER_PROVIDED_IMAGE_FOR_SCENE_1_ONLY", 
        "video_prompt": "English video generation prompt...",
        "motion_bucket": 127, // 1-255 (Higher for more motion)
        "cfg_scale": 7.5, // 1.0-20.0 (Classifier-Free Guidance)
        "camera_motion": "Zoom In / Pan Right / Static",
        "dialogue": { "enabled": false, "text": "" },
        "audio": { "bgm": true, "sfx": ["sound1", "sound2"] }
      },
      ...
    ]

    [RULES]
    1. **Scene #${a}**: 'base_image' MUST be the string "INITIAL_IMAGE". (I will replace it with actual data later).
    2. **Scene #${a+1}...**: 'base_image' should be empty string "" (The user will use the output of the previous video as input).
    3. **Language**: 
       - 'video_prompt' MUST be in **ENGLISH**.
       - 'dialogue.text' MUST be in **KOREAN** (). 
       - **STRICT PROHIBITION**: NEVER translate the dialogue into English. It must be in the original Korean language as written in the story.
    4. **Motion & Guidance**: 
       - **motion_bucket**: Vary based on drama (1-255).
       - **cfg_scale**: Recommend a value between 7.0 and 8.0 for best fidelity.
       - **camera_motion**: 
          - DEFAULT to **"Static"** unless the user EXPLICITLY asks for camera movement (e.g., "Zoom in", "Pan right").
          - **DO NOT** add "Zoom In" automatically. It ruins full-body shots.
          - Only use "Zoom In" if the script says "Close up" or "Focus on face".
    5. **Audio**: Suggest appropriate SFX for each scene.
    6. **Dialogue**: 
       - If the story segment contains dialogue or monologue, extract it into 'dialogue.text'.
       - Set 'dialogue.enabled' to true.
       - The text MUST match the Korean story content.
       - **OUTPUT DIALOGUE IN KOREAN ONLY**.
       - **FORMAT**: Must be a JSON Object { "enabled": true, "text": "[KOREAN] '...'" }.
       - **PREFIX**: You MUST add '[KOREAN]' tag at the beginning of the text string.
    7. **IMAGE-TO-VIDEO CONTINUITY (CRITICAL)**: 
       - Assume that the user will use the **Last Frame** of Scene N as the **First Frame (Input Image)** for Scene N+1.
       - Therefore, Scene N+1's prompt MUST describe the action starting **EXACTLY where Scene N ended**.
       - Do NOT change the camera angle or character position abruptly between scenes unless it's a new cut.
       - **EXAMPLE**: If Scene 1 ends with "He raises his hand", Scene 2 MUST start with "With his hand raised, he grabs the apple...".
  `;try{const f=(await o.models.generateContent({model:"gemini-2.0-flash-exp",contents:{parts:[{inlineData:{mimeType:i[1],data:i[2]}},{text:u}]},config:{responseMimeType:"application/json"}})).text||"[]",m=qn(f);return Array.isArray(m)?m.map((p,g)=>({...p,id:crypto.randomUUID(),base_image:g===0?n:""})):[]}catch(c){throw console.error("Story Scene Generation Failed",c),new Error("   .")}},YC=async(t,e,n,r="16:9",o="background",i,s,a,u,c,f,m)=>{var ue,$,Y,L;const p=Mt(t),g=St[n].prompt;let v={aspectRatio:r||"16:9"},T=e;if(e&&/[-]/.test(e)&&(T=await fs(p,e)),m&&m.length>0&&Array.isArray(i)&&i.length>0){const Z=m.map((G,B)=>`${G} (MATCH WITH PROVIDED REFERENCE IMAGE #${B+1})`).join(", ");Z&&(T+=`
[CHARACTER MATCHING: ${Z}]`)}const y=`
    [ROLE] You are the "Continuity Supervisor" for a high-budget Korean Historical Drama.
    [ABSOLUTE CASTING RULE]
    - **DRAW ONLY** the characters explicitly listed in the "[FOCUS SUBJECT]" section of the prompt.
    - If the script mentions other characters (talking/listening) but they are NOT in "[FOCUS SUBJECT]", **DO NOT DRAW THEM**.
    - If only ONE character is listed, it must be a **SOLO SHOT**.
    
    [YOUR MISSION]
    1. **CONSISTENCY IS GOD**: 
       - If a Character Reference is provided, the character MUST look exactly like it.
       - If a Background Reference is provided, the room/environment MUST look exactly like it.
    2. **ACTING DIRECTOR**: Natural acting, candid shots.
    3. **HISTORICAL POLICE**: Enforce Joseon Dynasty rules.
    4. **CLEAN FRAME POLICY (NO TEXT)**:
       - **ABSOLUTELY NO TEXT**: Do not generate any text, speech bubbles, subtitles, signatures, or watermarks.
       - **PURE VISUALS**: The image must be a clean camera shot.
  `,x="";let w="";const _=Array.isArray(i)?i:i?[i]:[];_.length>0&&(o==="character"||o==="cinematic")&&(w=`
        [VISUAL ANCHOR - CHARACTERS (ABSOLUTE TRUTH)]
        The provided images (tagged as Character Refs) are the **GOD-TIER REFERENCES**.
        
        - **MATCHING RULE**: The prompt explicitly tags characters with "(MATCH WITH PROVIDED REFERENCE IMAGE #N)".
        - **EXECUTION**: You MUST map the Nth provided image to that specific character.
        - **IDENTITY LOCK**: 
          - **FACE**: Copy the facial features, age, and facial hair EXACTLY.
          - **COSTUME**: Copy the clothing style, colors, and HEADWEAR EXACTLY. 
          - **DO NOT CHANGE CLOTHES**: Unless the script explicitly says "He changed clothes", **KEEP THE REFERENCE COSTUME**.
          - **DO NOT REMOVE HATS**: If the reference has a hat (Gat/Official Cap), **KEEP IT ON** (Even indoors, unless explicitly told to remove).
          - **DO NOT HALLUCINATE**: Do not add beards, glasses, or accessories that are not in the reference.
        
        - **BACKGROUND EXCLUSION**: IGNORE any background elements in the reference images. Only look at the person.
      `);let b="",M="";const R=`
    [ACTING & EYE CONTACT RULES - ABSOLUTE PRIORITY]
    1. **NO EYE CONTACT WITH CAMERA (CRITICAL)**: 
       - The character MUST NEVER look at the viewer/lens.
       - **EYES**: Eyes must be focused on the *situation*, *other characters*, or *objects*.
       - **PENALTY**: If the character makes eye contact with the camera, it is a FAILURE.

    2. **METHOD ACTING (IMMERSION)**:
       - **IGNORE THE CAMERA**: The camera is an invisible ghost. The characters are unaware of it.
       - **FOCUS**: 
         - **Dialogue**: Look intently at the other person.
         - **Conflict**: Glare at the enemy or the threat.
         - **Thinking**: Look down, up, or into the distance (Profile view).
         - **Fear**: Look at the source of fear (NOT the camera).

    3. **DYNAMIC POSE & MOVEMENT**:
       - **NO STIFF POSES**: Do not just stand there. 
       - **DO SOMETHING**: Use hands, lean forward, crouch, run, or struggle.
       - **ENGAGE**: Interact with the environment (touching walls, holding tools, grabbing clothes).
  `,F=`
    [POSTURE & POSE RULES]
    1. **DEFAULT POSE**:
       - IF Location is OUTDOOR (Yard, Street, Forest): **MUST BE STANDING** unless script explicitly says "Sitting".
       - IF Location is INDOOR: Follow script context.
    2. **FRAMING VS POSE**:
       - **DO NOT CHANGE THE POSE** to fit the camera frame.
       - If "Waist Shot" is requested, **CROP THE IMAGE**. DO NOT make the character sit to hide their legs.
       - If the character is Standing, keep them Standing and just show the upper body.
  `,D=`
    [HISTORICAL ACCURACY: JOSEON DYNASTY ARCHITECTURE]
    - **PRISON/JAIL**:
      - **STRUCTURE**: Use **WOODEN LATTICE** (Grid pattern / # shape). Do NOT use vertical iron bars.
      - **NO STONE FLOOR**: The floor is **DIRT/GROUND** covered with **STRAW MATS** or scattered **HAY**.
      - **NO CHAINS**: Unless specified, use ropes (Seung) instead of metal chains.
    - **DOORS/WINDOWS**:
      - Use **PAPER DOORS (Changhoji)** with wooden frames. No glass windows.
      
    [SPATIAL REALISM & LENS]
    1. **DO NOT SHRINK THE ROOM**: The room must remain spacious. Do not make the walls close in on the characters.
    2. **DEPTH**: Use "Depth of Field" or "Bokeh" for Close-ups/Waist Shots to separate character from background.
    3. **LENS PREFERENCE (ZOOM OUT - BATCH MODE)**:
       - **DEFAULT TO KNEE SHOT (Medium Long Shot)**: To allow for post-production zoom-in effects without losing quality, **ALWAYS generate at least a Knee Shot** (showing head to knees) unless "Close Up" or "Bust Shot" is explicitly requested in the user prompt.
       - **AVOID TIGHT CROPPING**: Do NOT default to Waist Shot. We need more pixel data for zooming.
       - **Framing**: Character should fill 60-70% of the vertical frame, leaving room for camera movement.
    4. **LENS**:
       - Use **50mm Standard Lens**. (Natural perspective, captures body language).
       - Ensure the character's hands and thighs are visible.
  `,V=`
    [STRICT ADHERENCE TO SCRIPT]
    - **NO HALLUCINATION**: Do NOT add any details, objects, or actions that are NOT explicitly mentioned in the user's prompt/script.
    - **ONLY WHAT IS WRITTEN**: If the script does not describe it, do not generate it.

    [HANBOK CLOTHING RULE - STRICT]
    - **DEFAULT**: Character MUST wear the FULL HANBOK set as shown in the Reference Image.
    - **NO UNDRESSING**: Do NOT remove layers unless the script EXPLICITLY says "Undress" or "Remove Clothes".
    - **SLEEPING/LYING DOWN**: Even when sleeping or lying down, **KEEP THE CLOTHES ON**. Do not change into sleepwear/underwear automatically.
    - **NO TRANSPARENCY**: The skirt (Chima) and Jacket (Jeogori) are **SOLID OPAQUE FABRIC**. DO NOT make them see-through.
    - **NEGATIVE PROMPT**: See-through clothes, Transparent fabric, Lingerie, Underwear only, Modern sleepwear, Nudity.
    
    [SPECIAL EXCEPTION: IF USER EXPLICITLY REQUESTS "UNDRESS/UNDERWEAR/SOKJEOKSAM"]
    - Only IF the prompt specifically asks for "Sokjeoksam" or "Underwear":
      1. Top (Jeogori) can be white/sheer.
      2. **BOTTOM (CHIMA) MUST BE SOLID OPAQUE**: The skirt must NEVER be transparent. It must cover the legs completely and solidly.
      3. **NO NUDITY**: No sensitive body parts visible.
  `;let K="",A="";e.includes("[CAMERA]")&&(e.includes("Waist Shot")||e.includes("ws")?A=`
            [ABSOLUTE FRAMING RULE: WAIST SHOT] 
            1. **ZOOM / CROP**: The framing MUST be a **CLOSE-UP from Head to Waist**.
            2. **FILL THE SCREEN**: The Character's Head and Torso MUST FILL the vertical space of the 16:9 frame.
            3. **CUT OFF**: The bottom of the frame MUST CUT OFF at the Belt/Waist line. **DO NOT SHOW LEGS**.
            4. **HEIGHT DIFFERENCE**: If characters have different heights, **CROP TO THE SHORTER PERSON'S WAIST**. Ensure the shorter person's head is fully visible.
            5. **POSTURE**: **SITTING IS ALLOWED**. If sitting, the camera zooms in to the upper body only.
            6. **NEGATIVE PROMPT**: Full body, Distant shot, Small character, Showing legs, Showing shoes.
            7. **BACKGROUND PRIORITY**: **LOW**. The Character Framing is PRIORITIZED over showing the background location (e.g. Maru/Room). It is okay if the background is cropped or blurry. DO NOT ZOOM OUT to show the architecture.
            8. **MANDATORY**: IF the generated image shows the character's KNEES or FEET, IT IS A FAILURE. REGENERATE closer.
          `:e.includes("Bust Shot")||e.includes("bs")||e.includes("Close Up")||e.includes("cu")?A=`
            [ABSOLUTE FRAMING RULE: BUST SHOT / CLOSE UP] 
            1. **EXTREME ZOOM**: The framing is TIGHT on the Face and Shoulders.
            2. **FILL THE SCREEN**: The Face and Shoulders MUST DOMINATE the frame (80% of screen).
            3. **CUT OFF**: The bottom of the frame MUST CUT OFF at the Chest/Armpits. **DO NOT SHOW WAIST**.
            4. **HEIGHT DIFFERENCE**: If characters have different heights, **CROP TO THE SHORTER PERSON'S CHEST**. Ensure the shorter person's face is fully visible.
            5. **POSTURE**: **SITTING IS ALLOWED**. Even if sitting, we only see the face.
            6. **NEGATIVE PROMPT**: Waist, Stomach, Belt, Hands (unless gesture), Full body, Distant shot.
            7. **BACKGROUND PRIORITY**: **LOW**. The Character Framing is PRIORITIZED over showing the background location (e.g. Maru/Room). It is okay if the background is cropped or blurry. DO NOT ZOOM OUT to show the architecture.
            8. **OVER-THE-SHOULDER RULE**: If the prompt specifies "Speaker" or "OTS", **CROP TO THE SPEAKER**. The Listener (shoulder) is just a framing device and can be cut off or blurred. Focus on the Speaker's face/bust.
            9. **MANDATORY**: IF the generated image shows the character's WAIST or BELT, IT IS A FAILURE. REGENERATE closer.
          `:e.includes("Knee Shot")||e.includes("mls")?A=`
            [ABSOLUTE FRAMING RULE: KNEE SHOT (Medium Long)] 
            1. **ZOOM**: The framing is from Head to Knees.
            2. **FILL THE SCREEN**: The Character (Head to Knees) MUST FILL the vertical space.
            3. **CUT OFF**: The bottom of the frame MUST CUT OFF at the Knees/Thighs. **DO NOT SHOW FEET**.
            4. **POSTURE**: **SITTING IS ALLOWED**. If sitting, show the character from Head to Knees.
            5. **NEGATIVE PROMPT**: Feet, Shoes, Ground at feet, Full body, Distant shot.
            6. **BACKGROUND PRIORITY**: **LOW**. The Character Framing is PRIORITIZED over showing the background location (e.g. Maru/Room).
               - Match the background perspective to the **CHARACTER'S EYE/KNEE LEVEL**.
               - It is okay if the background is cropped or blurry. **DO NOT ZOOM OUT** just to show the floor or roof.
            7. **MANDATORY**: IF the generated image shows the character's SHOES, IT IS A FAILURE. REGENERATE closer.
          `:(e.includes("Full Shot")||e.includes("full"))&&(A=`
            [ABSOLUTE FRAMING RULE: FULL SHOT]
            1. **WIDE ANGLE**: Show the ENTIRE BODY from Head to Toe.
            2. **SPACE**: Leave some space above the head and below the feet.
            3. **POSTURE**: **SITTING IS ALLOWED**. Show the full pose including legs and feet.
            4. **NEGATIVE PROMPT**: Cut off feet, Cut off head, Close up, Waist shot.
            5. **MANDATORY**: IF the generated image cuts off the FEET or HEAD, IT IS A FAILURE. ZOOM OUT.
          `)),K=`
    [SYSTEM INSTRUCTION: IMAGE EDITING & FRAMING MODE]
    
    ${A}
    
    [ORIGINAL SCENE CONTEXT]
    ${y}
    ${g}
    ${GC}
    ${V}
    
    [INDOOR ETIQUETTE GUIDE]
    - IF the scene is INDOORS (Room, Maru):
      1. **SHOES**: **STRICT RULE: REMOVE SHOES**. 
         - Characters MUST be barefoot or wearing white socks (Beoseon).
         - Even if the reference image shows shoes, **YOU MUST REMOVE THEM** for indoor scenes.
      2. **HATS**: 
         - Default rule: Remove large outdoor hats (Satgat, Paeraengi).
         - **CRITICAL EXCEPTION**: If the Character Reference Image shows a specific hat (e.g. Gat, Official Cap), **KEEP IT ON** unless the user explicitly asked to remove it.
         - **IDENTITY PRIORITY**: The Character's Identity (Reference Image) is MORE IMPORTANT than the indoor rule.
  
    ${w}
    ${b}
    ${M}
    ${x}
    ${R}
    ${F}

    [SCENE GENERATION PROMPT]
    ${T}
    
    ${D}
    
    [FINAL CHECK]
    - DID YOU CROP THE IMAGE AS REQUESTED?
    - Is the framing correct (Waist/Bust/CloseUp)?
    - Is the background consistent with the Master Image?
  `;const q=[];_.length>0&&(o==="character"||o==="cinematic")&&_.forEach(Z=>{const G=Z.match(/^data:(.+);base64,(.+)$/);G&&q.push({inlineData:{mimeType:G[1],data:G[2]}})}),q.push({text:K});try{const Z=await p.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:q},config:{imageConfig:v,safetySettings:bu}});for(const G of((Y=($=(ue=Z.candidates)==null?void 0:ue[0])==null?void 0:$.content)==null?void 0:Y.parts)||[])if(G.inlineData)return`data:${G.inlineData.mimeType};base64,${G.inlineData.data}`;throw new Error("  .")}catch(Z){throw console.error(Z),(L=Z.message)!=null&&L.includes("SAFETY")?new Error("  :   ."):new Error("    .")}},KC=async(t,e,n,r,o)=>{var c,f,m,p;const i=Mt(t),s=await fs(i,n);let u=`
    ${St[r].prompt}
    CONTEXT: Korea, Joseon Dynasty.
    TASK: Generate a high-quality visual reference for a specific OBJECT/PROP.
    
    OBJECT NAME: ${e}
    VISUAL DESCRIPTION: ${s}
    
    [RULES]
    1. Single Object isolated on a clean, simple background (or solid color).
    2. Focus on the object details.
    3. Historical accuracy for Joseon Dynasty.
    4. NO text, NO watermarks, NO user interface elements.
    5. High resolution, clear definition.
  `;o&&(u+=`
      [REFERENCE IMAGE PROVIDED]
      - Use the provided image as a strict visual reference for SHAPE, COLOR, and MATERIAL.
      - Copy the structure and design of the object in the reference image.
      - Apply the Joseon Dynasty context if necessary, but keep the core look from the reference.
      `);try{const g=[];if(o){const v=o.match(/^data:(.+);base64,(.+)$/);v&&g.push({inlineData:{mimeType:v[1],data:v[2]}})}g.push({text:u});const E=await i.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:g},config:{imageConfig:{aspectRatio:"1:1"},safetySettings:bu}});for(const v of((m=(f=(c=E.candidates)==null?void 0:c[0])==null?void 0:f.content)==null?void 0:m.parts)||[])if(v.inlineData)return`data:${v.inlineData.mimeType};base64,${v.inlineData.data}`;throw new Error("  .")}catch(g){throw console.error(g),(p=g.message)!=null&&p.includes("SAFETY")?new Error("  :   ."):new Error("     .")}},JC=async(t,e,n,r,o)=>{var R,F,D,V,K,A,z,C,q,ue;const i=Mt(t),s={...e};let a=!1;const u=((R=e.gender)==null?void 0:R.match(/(\d+)\s*(||year)/i))||((F=e.extraDetails)==null?void 0:F.match(/(\d+)\s*(||year)/i));u&&parseInt(u[1])<18&&(a=!0);for(const $ in s)if(typeof s[$]=="string"){let Y=s[$],L=await fs(i,Y);a&&($==="gender"&&(L=L.replace(/(\d+)\s*(year old|years old)/gi,"Young")),L=L.replace(/\b(slender|curvy|sexy|hot|body|figure|breast|chest|curves|S-line|voluptuous|alluring|sensual)\b/gi,"small build"),L=L.replace(/\b(mature|adult-like|grown-up)\b/gi,"youthful"),L=L.replace(/\b(jealous|jealousy)\b/gi,"displeased"),L=L.replace(/\b(competitive|ambitious)\b/gi,"determined"),L=L.replace(/\b(woman|lady|female)\b/gi,"young girl"),L=L.replace(/\b(maid|servant)\b/gi,"apprentice"),L=L.replace(/\b(court maid|palace maid|kung-nyeo|saenggak-si|royal maid)\b/gi,"young girl in traditional hanbok"),L=L.replace(/\b(trainee court maid)\b/gi,"young student in traditional hanbok")),s[$]=L}const c=await fs(i,r||""),f=St[n].prompt,m=e.optionFlags||{},p=Object.entries(s).map(([$,Y])=>{if($==="optionFlags"||!Y||typeof Y!="string")return"";const L=m[$];if(L){if(L.enabled===!1)return"";if(L.isMandatory)return`**[CRITICAL/MANDATORY] ${$}: ${Y}**`}return`${$}: ${Y}`}).filter(Boolean).join(`
- `),g=(D=e.backgroundColor)!=null&&D.includes("Green")?"Solid Green Screen (#00FF00)":"Solid Background",E=((V=s.race)==null?void 0:V.toLowerCase().includes("pure animal"))||((K=s.race)==null?void 0:K.toLowerCase().includes("no clothes")),v=E?`[ANIMAL MODE - CRITICAL]
- DO NOT DRAW HUMAN CLOTHES (No Hanbok, No Hats).
- Draw a REALISTIC ANIMAL standing on four legs (unless specified otherwise).
- Focus on FUR texture and ANIMAL ANATOMY.`:"[CONTEXT] Korea, Joseon Dynasty (Historical Setting).",T=c?`
  [USER RESTRICTIONS - ABSOLUTE PRIORITY]
  DO NOT DRAW: ${c}.
  If the user asks to remove something, REMOVE IT COMPLETELY.
  `:"";let y="";const x=(A=s.gender)==null?void 0:A.match(/(\d+)\s*year\s*old/i);if(x&&!E){const $=parseInt(x[1]);$<18?$<7?y=`
             [AGE CONTROL: TODDLER / VERY YOUNG CHILD]
             - VISUALS: Small child, toddler proportions, very short.
             - **STRICT PROHIBITION**: NO "Chibi" style, NO "SD" style, NO "Big Head".
             - **SIZE & FRAMING**:
               1. **SCALE**: The child is TINY. Occupy **ONLY 40%** of the canvas height.
               2. **EMPTY SPACE**: **50% EMPTY SPACE** above head.
               3. **NEGATIVE PROMPT**: Adult, Mature, Tall.
             - **COMPOSITION**: Bottom center.
             `:$<13?y=`
             [AGE CONTROL: CHILD MODE (UNDER 13)]
             - **VISUAL HEIGHT REFERENCE**:
               1. **STANDARD ADULT**: 175-180cm (Fills 80% of canvas).
               2. **THIS CHARACTER**: **80-100cm** (MUST fill only **40%** of canvas).
               3. **COMPARISON**: The character is **HALF THE HEIGHT** of an adult.
             
             - **CULTURAL CONTEXT**: Joseon Dynasty Child (Dongja/Sonyuh).
             - **PROPORTIONS**:
               1. **HEAD SIZE**: **SMALL HEAD**. Ratio 1:7.5 to 1:8. (Same proportions as adult, just smaller scale).
               2. **BODY**: **THIN & NARROW**. SHOULDERS MUST BE NARROW.
               3. **NO BIG HEAD**: **ABSOLUTELY NO CHIBI/SD STYLE**. The head must look small.
             
             - **COMPOSITION & FRAMING (HIGHEST PRIORITY)**:
               1. **ALIGNMENT**: **STRICT BOTTOM ALIGNMENT**. Feet MUST be at the very bottom edge of the canvas (same ground level as adults).
               2. **VERTICAL OCCUPANCY**: Character MUST ONLY occupy the **BOTTOM 40%** of the canvas.
               3. **EMPTY SPACE**: The **TOP 60%** of the image MUST be EMPTY BACKGROUND.
               4. **NO FLOATING**: Do NOT center the character vertically. Put them ON THE GROUND.
               5. **ZOOM OUT**: Camera distance is **20 METERS AWAY**.
             
             - **NEGATIVE PROMPT**: Close up, Zoom in, Filling the frame, Macro, Portrait, Big head, Wide shoulders, Adult proportions, Giant, Large body, **Centered vertically**, **Floating in middle**.
             `:y=`- VISUALS: Youthful teenager, student age. Fresh skin, slightly smaller build than an adult.
`:(y=`
         [AGE CONTROL: ${$} YEARS OLD]
         - The character MUST look exactly ${$} years old.
         `,$>=60?y+=`- VISUALS: Visible WRINKLES, aged skin texture, grey/white hair (unless dyed), wise/tired eyes.
- DO NOT make them look like a young K-pop star with grey hair. They must have OLD SKIN.
`:$>=40&&(y+=`- VISUALS: Mature adult, slight laugh lines, confident bearing. Not a 20-year-old.
`))}const w=Object.values(e).join(" ").toLowerCase();(w.includes("")||w.includes("saenggak"))&&(a?y+=`
            - **COSTUME STYLE**: Traditional Korean apprentice girl outfit.
            - **HAIR**: Long braid with a ribbon (Daenggi), or looped hair (Saenggak-si style).
            - **CLOTHING**: Simple, neat Hanbok.
            - **APPEARANCE**: Young, innocent, disciplined student look.
            `:y+=`
            - **HISTORICAL ROLE: SAENGGAK-SI (LITTLE COURT MAID)**
            - **DEFINITION**: "Saenggak-si" refers to young court maids (Children) studying to become Nain in the Joseon Dynasty palace. It specifically means "Apprentice Court Maid" who just entered the palace for training.
            - **KOREAN CONTEXT**: "  ()       ,     ' '".
            - **AGE CONTEXT**: They are **CHILDREN** (trainees), NOT adults. They have childish features.
            - **HAIR**: "Saenggak-si" wear a specific hairstyle (often a long braid with a ribbon, or a special looped hair for trainees).
            - **CLOTHING**: Simple court maid uniform.
            `);let _="Full Body, Feet Visible";x&&parseInt(x[1])<13&&(_="Wide Shot, Small Scale Full Body, Distant View (20m away)");let b="";if(s.scale){const $=s.scale;b=`
      [USER DEFINED SCALE: ${$}%]
      - **CRITICAL INSTRUCTION**: The character MUST occupy **ONLY ${$}%** of the canvas height.
      - **ALIGNMENT**: **STRICT BOTTOM ALIGNMENT**. Feet at the bottom edge.
      - **EMPTY SPACE**: The TOP ${100-$}% of the image MUST be empty.
      - **REASON**: The user has manually set the character's height relative to the canvas.
      `,$<=50&&(_="Wide Shot, Small Scale Full Body, Distant View")}let M=`
    ${f}
    CONTEXT: Korea, Joseon Dynasty.
    ${v} 
    ${Pm}
    ${T}
    ${y}
    ${b}

    TASK: Generate Character Reference Sheet.
    [DETAILS] - ${p}
    [RULES] ${_}, ${g}, Neutral Pose.
  `;o&&(M+=`
      [VISUAL REFERENCE - SOURCE MATERIAL]
      The provided image is the **SOURCE ACTOR/DESIGN**.
      
      [CRITICAL INSTRUCTION]
      1. **FACE & IDENTITY**: Copy the facial features, eye shape, and expression from the reference image EXACTLY.
      2. **CLOTHING**: Maintain the style and structure of the clothing from the reference.
      3. **ADAPTATION**: Apply the Joseon Dynasty style ONLY to the texture/materials if necessary, but KEEP THE FORM.
      4. **GOAL**: The result must look like the SAME PERSON wearing the SAME CLOTHES (or Joseon version of them).
      `);try{const $=[];if(o){const L=o.match(/^data:(.+);base64,(.+)$/);L&&$.push({inlineData:{mimeType:L[1],data:L[2]}})}$.push({text:M});const Y=await i.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:$},config:{imageConfig:{aspectRatio:"9:16"}}});for(const L of((q=(C=(z=Y.candidates)==null?void 0:z[0])==null?void 0:C.content)==null?void 0:q.parts)||[])if(L.inlineData)return`data:${L.inlineData.mimeType};base64,${L.inlineData.data}`;throw new Error("  .")}catch($){throw(ue=$.message)!=null&&ue.includes("SAFETY")?new Error("  ."):new Error("  .")}},XC=async(t,e)=>{const n=Mt(t),r=`
       1000  ** /   **.
      ,  **[  ]**     50 .

    [ ]
    ${e.substring(0,5e4)}

    [  - "  "]
    1. ** : ",    "**
       -  (: " !", "!") ** **.
       -    **    ** .
       - **,    !**  , **   **   .

    2. **   ( )**:
       - **  **: '', ''      .
       - **/ **: , , , , , , , , ,  ,   .
       - : "" (X) -> " " (O)

    3. **  (    )**:
       - **[ //]** + **[()]** + **[/]**
       - : "5  " () + " " () + "" ()
       - **    .**     . (: "~ ", "~ ", "~ ")
       - ** **: "      " (  )
       - ** **: "    " ( )

    4. **   (   )**:
       - "5    "
       - "5     "
       - "      "
       - "      "
       - "    "
       - "    "
       - "     "

    5. **  ( )**:
       - **  **: "  " (X) -> "     " (O)
       - ** **:      . (:   ,   )
       - ** **: "5", "", "10"      .
       - ** **:     ,    .

    6. ** **:
       -    ,     ( ,  ,  )  50 .

    [ ]
    **JSON   .**
    : ["5    ", "  ", ...]
  `;try{const i=(await n.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:r}]},config:{responseMimeType:"application/json"}})).text||"[]",s=qn(i);return Array.isArray(s)?s:typeof s=="object"&&Array.isArray(s.titles)?s.titles:[]}catch(o){throw console.error("Massive hooking title generation failed",o),new Error("  : "+o.message)}},ZC=async(t,e,n,r="auto")=>{const o=Mt(t),i=e.map(f=>`[Scene ${f.sequenceNumber}] ${f.title}: ${f.visualPrompt}`).join(`
`),s={auto:"",fast_exciting:`
      [STYLE]: Korean Traditional Folk, Pungmul, Madangnori (Pure Gugak).
      [INSTRUMENTS]: Korean hand gong (Kkwaenggwari, metallic, bright, fast attack), Korean hourglass drum (Janggu, rhythmic percussion, drum roll, sharp stick sound), Barrel drum (Buk, resonant, heartbeat, bass drum), Korean gong (Jing, deep, long decay, brassy), Korean oboe (Taepyeongso, piercing, high-pitched, loud).
      [TEMPO]: Fast & Energetic (Hwimori, Jajinmori), Excited, Bouncy, Rhythmic.
      [VOCAL]: Playful, Energetic, Spoken-style, Narrative, With Chuimsae (Eol-su, Jihwaja).
      [MIXING]: Rich and well-blended sound, warm spatial mixing, energetic percussion.
      [NOTE]: **NO WESTERN INSTRUMENTS**. No Guitar, No Brass. Pure Korean sound.
      [NOTE]: The lyrics MUST be in **Jeolla-do or Chungcheong-do Dialect (Saturi)**. Use spoken word style like Pansori Aniri.
              Examples: ",  !", ",   !", ", !".
    `,sad_sorrowful:`
      [STYLE]: Sad Sagueuk Ballad, Cinematic, Emotional Gugak.
      [INSTRUMENTS]: Korean fiddle (Haegeum, two-stringed, grainy, sorrowful, violin-like), Korean bass fiddle (Ajaeng, bowed zither, mellow, deep, cello-like), Korean bamboo flute (Daegeum, breathy, wind sound), Korean zither (Gayageum, plucked, clear).
      [TEMPO]: Slow, Flowing, Rubato, Melancholic.
      [VOCAL]: Soft Female Vocals, Breathy, Sorrowful, Tearful, Lyrical.
      [MIXING]: Soft resonance, emotional reverb, intimate, grainy texture.
    `,faint_hazy:`
      [STYLE]: Dreamy Sagueuk, Ambient, Ethereal Gugak.
      [INSTRUMENTS]: Korean bamboo flute (Daegeum, breathy, air sound), Small bamboo flute (Sogeum, clear, high-pitched), Korean mouth organ (Saenghwang, mysterious chords), Korean zither (Gayageum, plucked, soft).
      [TEMPO]: Slow, Floating, Non-rhythmic, Mystical.
      [VOCAL]: Whispering, Echoing, Mysterious, Faint.
      [MIXING]: Ethereal reverb, wide spatial mixing, dreamy atmosphere.
    `,slow_mystery:`
      [STYLE]: Korean Traditional Noir, Suspense, Dark Gugak.
      [INSTRUMENTS]: Korean bass zither (Geomungo, percussive strings, deep resonance, heavy), Korean gong (Jing, dark resonance, slow decay), Barrel drum (Buk, deep thud), Korean bass fiddle (Ajaeng, low friction sound).
      [TEMPO]: Slow tension, Heartbeat rhythm, Heavy, Suspenseful.
      [VOCAL]: Low male vocal, Spoken word, Warning tone, Monologue-style.
      [MIXING]: Dark ambience, deep bass resonance, tension.
    `,medium_story:`
      [STYLE]: Korean Folk Storytelling, Mid-tempo Gugak.
      [INSTRUMENTS]: Barrel drum (Buk, resonant), Korean hourglass drum (Janggu, rhythmic), Korean bamboo flute (Daegeum, breathy), Korean zither (Gayageum, plucked, clear).
      [TEMPO]: Medium, Walking pace, Rhythmic (Gutgeori), (90-110 BPM).
      [VOCAL]: Clear narration, Minyo style, Storytelling, Conversational, With Chuimsae.
      [MIXING]: Clear vocal focus, balanced ensemble.
      [NOTE]: Use a storytelling tone (Taryeong) with occasional Chuimsae. Dialect (Saturi) is preferred for humor.
    `,grand_epic:`
      [STYLE]: Epic Sagueuk Orchestra, War Movie OST (Pure Gugak Version).
      [INSTRUMENTS]: Korean oboe (Taepyeongso, piercing, loud), Massive Barrel Drum Ensemble (Buk, thunderous, epic), Korean gong (Jing, metallic resonance), Korean double reed pipe (Piri, strong, nasal, loud), Korean hand gong (Kkwaenggwari, accent).
      [TEMPO]: Dynamic, Marching, Grandiose, Powerful.
      [VOCAL]: Grand Chorus, Chanting, Heroic, Powerful, Theatrical.
      [MIXING]: Massive sound, wide dynamic range, cinematic impact.
      [NOTE]: **NO WESTERN BRASS/STRINGS**. Create epicness with massive Korean drum ensemble and piercing wind instruments.
    `},a={auto:"Analyze the sequence and choose the most fitting Sagueuk (Korean Historical Drama) OST style using ONLY Korean traditional instruments.",mystery:`
      [STYLE]: Korean Traditional Noir, Sagueuk OST, Cinematic.
      [INSTRUMENTS]: Korean bass zither (Geomungo, percussive strings), Korean gong (Jing, dark resonance), Korean bamboo flute (Daegeum, breathy).
      [TEMPO]: Slow tension, Heartbeat rhythm, Slow-burn.
      [VOCAL]: Whispering, Low male vocal, Minimal Vocals.
      [MIXING]: Dark ambience, deep resonance.
    `,comedy:`
      [STYLE]: Korean Folk Pop, Madangnori, Upbeat OST.
      [INSTRUMENTS]: Korean hand gong (Kkwaenggwari, metallic), Korean hourglass drum (Janggu, rhythmic), Korean oboe (Taepyeongso, piercing).
      [TEMPO]: Fast Tempo, Bouncy, Rhythmic, Marching.
      [VOCAL]: Playful, Storytelling, Pansori style narration, Spoken-style.
      [MIXING]: Bright, clear, energetic.
    `,destiny:`
      [STYLE]: Epic Sagueuk Orchestra, Cinematic, Grandiose.
      [INSTRUMENTS]: Korean bamboo flute (Daegeum, breathy), Massive Barrel Drum Ensemble (Buk), Korean double reed pipe (Piri).
      [TEMPO]: Slow build-up to Fast, Dynamic, Marching.
      [VOCAL]: Grand Chorus, Chanting, Heroic Vocals.
      [MIXING]: Wide, cinematic, majestic.
    `,tragedy:`
      [STYLE]: Sad Sagueuk Ballad, Cinematic, OST.
      [INSTRUMENTS]: Korean fiddle (Haegeum, grainy, sorrowful), Korean bass fiddle (Ajaeng, mellow), Korean zither (Gayageum, plucked).
      [TEMPO]: Slow, Flowing, Rubato.
      [VOCAL]: Soft Female Vocals, Emotional, Breathy, Sorrowful.
      [MIXING]: Intimate, emotional reverb.
    `,revenge:`
      [STYLE]: Intense Gugak, Cinematic, Driving.
      [INSTRUMENTS]: Korean bass zither (Geomungo, aggressive, percussive), Barrel drum (Buk, deep), Korean oboe (Taepyeongso, piercing).
      [TEMPO]: Fast Paced, Aggressive, Driving rhythm.
      [VOCAL]: Gritty, Powerful, Spoken-style.
      [MIXING]: Sharp, punchy, intense.
    `,despair:`
      [STYLE]: Minimalist Sagueuk, Cinematic, Ambient.
      [INSTRUMENTS]: Korean bass fiddle (Ajaeng, sorrowful, bowed), Korean bamboo flute (Daegeum, breathy), Wind Sound.
      [TEMPO]: Very Slow, Dragging, Stillness.
      [VOCAL]: Spoken word, Low humming, Mournful.
      [MIXING]: Empty space, cold atmosphere.
    `};let u="";r!=="auto"&&s[r]?u=s[r]:u=a[n]||a.auto;const c=`
    You are a professional Music Director and Lyricist for a Korean Historical Drama (Sagueuk).
    Create a **Background Music (OST) prompt** for the following opening sequence.

    [GOAL]
    The music must **SUPPORT** the video, not overpower it. It should set the perfect atmosphere.
    The lyrics should be poetic and abstract, enhancing the mood without narrating every detail.
    For 'fast_exciting', 'comedy', or 'medium_story' styles:
      - **TONE**: Use **Satire & Humor (Haehak)**.
      - **STYLE**: Use **Spoken Word / Monologue (Pansori Aniri)** style.
      - **DIALECT**: Use **Korean Dialect (Saturi)** like "", "", "~", "~".
      - **CONTENT**: Directly address the situation with wit. NOT poetic descriptions.
      - Example: "     !"

    [SEQUENCE STORY]
    ${i}

    [MUSIC STYLE GUIDE]
    ${u}

    [TASK]
    1. **Title**: A catchy, poetic title for the song (Korean).
    2. **Style of Music (English)**: A single string of English tags for Suno AI.
       - **CRITICAL**: COPY the full instrument descriptions including adjectives (e.g., "Korean hand gong, metallic, bright"). DO NOT shorten to just "Kkwaenggwari".
       - **COMBINE**: Genre + Full Instrument Descriptions + Tempo + Vocal Style + Mixing Keywords.
       - **FORMAT**: Comma-separated tags.
       - **MUST INCLUDE**: "Cinematic", "OST", "Background Music", "No Intro", "Immediate Start".
    3. **Style of Music (Korean)**: A single string of Korean tags for Suno AI.
       - **COMBINE ALL ELEMENTS**: Genre + Instruments + Tempo + Vocal Style in Korean.
       - **IMPORTANT**: For "No Intro", use English "No Intro" even in the Korean string as it works better.
       - **FORMAT**: Comma-separated tags (e.g., "   OST, , , ,  , ,  , No Intro").
    4. **Lyrics**: Korean lyrics structured for ~60 seconds.
       - **CRITICAL RULE 0 (NO PRELUDE)**: The song must start singing IMMEDIATELY.
       - **CRITICAL RULE 4 (LENGTH LIMIT)**: **ABSOLUTE MAXIMUM 8 LINES TOTAL**. 
         - **Recommended Structure**: 
           [Verse] (2-4 lines)
           [Chorus] (2-4 lines)
           [Outro] (1 line)
       - **CRITICAL RULE 1 (NO NAMES)**: NEVER use specific character names. Use pronouns or metaphors.
       - **CRITICAL RULE 2 (NO SPOILERS)**: Do NOT describe specific plot events literally. Focus on *Atmosphere* and *Emotion*.
       - **CRITICAL RULE 3 (SUPPORTIVE)**: The lyrics should feel like a part of the soundtrack, not a separate pop song.

    [OUTPUT JSON FORMAT]
    {
      "title": "Song Title",
      "style_en": "Style Tags (English)",
      "style_ko": "Style Tags (Korean)",
      "lyrics": "[Verse]
Line 1
Line 2...

[Chorus]
Line 3..."
    }
  `;try{const m=(await o.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:c}]},config:{responseMimeType:"application/json"}})).text||"{}";return qn(m)}catch(f){throw console.error("Suno lyrics generation failed",f),new Error("  ")}},QC={gender:[{label:"",value:"Male"},{label:"",value:"Female"}],class:[{label:" ()",value:"Seonbi (Joseon Scholar), noble, silk robes"},{label:"/",value:"Bandit, rough appearance, wild, animal skins"},{label:"/",value:"King of Joseon, Red Royal Robe (Gonryongpo)"},{label:"/",value:"Queen of Joseon, Royal ceremonial dress"},{label:"/",value:"General, Warrior, Military uniform (Cheollik)"},{label:"/",value:"Merchant, Peddler, carrying bundle on back"},{label:"",value:"Buddhist Monk, grey robes"},{label:"/",value:"Peasant, Commoner, White hemp clothes"},{label:"",value:"Gisaeng, colorful Hanbok, artistic"},{label:"",value:"Shaman (Mudang), colorful ritual clothing"},{label:"/",value:"Magistrate (Sato), Official uniform"},{label:"// ()",value:"Pojol (Joseon Constable), This character wears a traditional black *gat* hat with a subtle sheen, featuring a black braided band, a thinner reddish-brown braided band, and a gold-colored finial on top. On the right side, vibrant multi-colored ribbons in dark blue, emerald green, bright yellow, rich red, and a lighter blue/purple, along with bright yellow tassels, are attached. His dark hair is neatly styled, likely in a topknot under the hat as traditional, with a clean hairline. The visible clothing includes a pure white *jeogori* (top), covered by a deep charcoal grey or black long outer robe and an inner vest-like garment of the same color, both featuring a very subtle, fine, dark grey patterned texture. A striking, vibrant red sash is tied at the waist with long ends hanging down. The bottom garment consists of pure white, loose-fitting *baji* (trousers)"},{label:"",value:"Grim Reaper (Jeoseung Saja), Black Hanbok, Black Gat"},{label:"/",value:"Mother figure, modest Hanbok"},{label:"/",value:"Father figure, traditional Hanbok"}],race:[{label:"",value:"Human"},{label:" (/)",value:"Anthropomorphic Animal, Humanoid body, Wearing Hanbok, Furry, Standing on two legs"},{label:" (//)",value:"Pure Animal, Realistic Creature, Walking on four legs, No clothes, No human features, Full fur"},{label:"",value:"Dokkaebi (Korean Goblin), holding club"},{label:"",value:"Gumiho (Nine-tailed Fox)"},{label:"",value:"Virgin Ghost (Cheonyeo Gwishin), white Sobok, messy hair"},{label:" (/)",value:"Tiger Spirit, anthropomorphic"},{label:" (//)",value:"Dragon King (Turtle spirit)"}],hair:[{label:" ( )",value:"Sangtu (Topknot) with Manggeon headband"},{label:" ()",value:"Daenggi-meori (Long Braid)"},{label:"  ()",value:"Half-tied hair with Manggeon ( )"},{label:" (/)",value:"Half-tied hair (No Manggeon), wild style"},{label:"  (/)",value:"Short Bob Hair (Danbal), rough cut"},{label:" (/)",value:"Shaggy Dog Hair (Deobeok-meori), messy and unkempt"},{label:"   ()",value:"Binyeo Bun (Low bun with silver hairpin)"},{label:"  ()",value:"Grey hair Sangtu (Topknot)"},{label:"   ()",value:"Grey hair Binyeo Bun"},{label:"  ()",value:"Gisaeng Gache (Large ornate wig)"},{label:"/ ",value:"Court Lady Gache (Rounded wig)"},{label:" ()",value:"Daesu-meori (Royal ceremonial wig with gold)"},{label:"  (/)",value:"Loose long black hair"},{label:" ()",value:"Wild messy hair"}],headwear:[{label:" ",value:"None"},{label:" (  )",value:"Gat (Black translucent horsehair hat)"},{label:" ()",value:"Jeongjagwan (Indoor scholar hat)"},{label:" ()",value:"Paeraengi (Bamboo hat)"},{label:" ()",value:"Jeonrip (Military hat with peacock feather)"},{label:" ()",value:"Ikseongwan (King black cap)"},{label:" ()",value:"Samo (Official black cap with wings)"},{label:" ( )",value:"Jokduri (Wedding headpiece)"},{label:" ()",value:"Jeonmo (Wide hat with butterfly decorations)"},{label:" ()",value:"Satgat (Conical straw hat)"},{label:" ()",value:"Nambawi (Winter cap)"}],outer:[{label:"  ()",value:"None"},{label:" ()",value:"Dopo (Scholar Robe with wide sleeves)"},{label:"",value:"Durumagi (Overcoat)"},{label:" ()",value:"Cheollik (Military Robe with pleated skirt)"},{label:"/",value:"Kwaeja (Long Vest)"},{label:" ( )",value:"Jangot (Coat worn over head)"},{label:"/ ()",value:"Hwarot/Wonsam (Ceremonial Robe)"},{label:" ()",value:"Sobok (White mourning clothes)"}],top:[{label:" ",value:"Jeogori (Traditional Jacket, curved sleeves)"},{label:" ",value:"Samhwejang Jeogori (Colorful cuffs and collar)"},{label:" ",value:"Saekdong Jeogori (Striped sleeves)"},{label:" ( )",value:"Jeoksam (Hemp shirt)"}],bottom:[{label:"  ()",value:"Baji (Wide trousers tied at ankles)"},{label:"  ()",value:"Chima (Full volume Ankle-length skirt, showing shoes)"},{label:" ()",value:"Seuran-chima (Ankle-length Skirt with gold leaf pattern, showing shoes)"},{label:" ( )",value:"Short Chima (Working class)"}],shoes:[{label:" ( )",value:"Jipsin (Straw shoes, covering toes like loafers)"},{label:" ()",value:"Taasahye (Leather shoes with patterns)"},{label:" ( )",value:"Mokhwa (Black velvet boots)"},{label:" ()",value:"Kkot-sin (Flower embroidered shoes)"},{label:"",value:"Barefoot"}],accessories:[{label:"",value:"None"},{label:" ()",value:"Gombangdae (Long pipe)"},{label:"",value:"Foldable Fan"},{label:" ()",value:"Hwando (Korean Sword)"},{label:" ()",value:"Cloth Bundle/Backpack (Bojim)"},{label:"",value:"Bokjumeoni (Lucky pouch)"},{label:"",value:"Norigae (Pendant)"},{label:"",value:"Eunjangdo (Silver knife)"},{label:"",value:"Wooden Walking Stick"}],bg:[{label:"  (Green)",value:"Green Screen"},{label:"  (Blue)",value:"Blue Screen"},{label:" ",value:"Solid White"},{label:" ",value:"Solid Black"}]},Lm=({onClose:t,initialName:e="",initialDesign:n,initialAge:r="30"})=>{var H,oe,he,ie,Ee,Ne,we,Be,tn,Ze,zt,Oe,nn,Nt,ft,Yn;const{apiKey:o,selectedStyle:i,setReferenceImages:s,referenceImages:a,setCharacters:u,characters:c,showToast:f,userOptions:m,addUserOption:p,removeUserOption:g}=Qt(),[E,v]=ne.useState(e),[T,y]=ne.useState(r),[x,w]=ne.useState(null),[_,b]=ne.useState(""),[M,R]=ne.useState(""),[F,D]=ne.useState(null),[V,K]=ne.useState(!1),A=ne.useMemo(()=>{const se={...QC};return m&&Object.keys(m).forEach(ye=>{const Te=ye;se[Te]&&(se[Te]=[...se[Te],...m[Te]||[]])}),se},[m]),z=(se,ye)=>{const Te=ye.replace(/^\d+\.\s*/,"");w({category:se,label:Te}),b(""),R("")},C=se=>{var be;const ye=(be=se.target.files)==null?void 0:be[0];if(!ye)return;if(ye.size>5*1024*1024){f("  5MB  .","warning");return}const Te=new FileReader;Te.onloadend=()=>{D(Te.result)},Te.readAsDataURL(ye)},q=async()=>{if(!(!F||!x)){if(!o){f("API  .","warning");return}K(!0);try{const se=await BC(o,F,x.category);R(ye=>(ye?ye+", ":"")+se),f("  .  .","success")}catch{f("  ","error")}finally{K(!1)}}},ue=()=>{if(x){if(!_.trim()||!M.trim()){f("    .","warning");return}p(x.category,{label:_,value:M}),w(null)}},[$,Y]=ne.useState(""),[L,Z]=ne.useState({gender:(n==null?void 0:n.gender)||A.gender[0].value,class:(n==null?void 0:n.class)||A.class[0].value,race:(n==null?void 0:n.race)||A.race[0].value,hair:(n==null?void 0:n.hair)||A.hair[0].value,headwear:(n==null?void 0:n.headwear)||A.headwear[0].value,outer:(n==null?void 0:n.outer)||A.outer[0].value,top:(n==null?void 0:n.top)||A.top[0].value,bottom:(n==null?void 0:n.bottom)||A.bottom[0].value,shoes:(n==null?void 0:n.shoes)||A.shoes[0].value,accessories:(n==null?void 0:n.accessories)||A.accessories[0].value,clothingColor:(n==null?void 0:n.clothingColor)||"",backgroundColor:A.bg[0].value,extraDetails:(n==null?void 0:n.extraDetails)||"",scale:(n==null?void 0:n.scale)||90,optionFlags:(n==null?void 0:n.optionFlags)||{}}),[G,B]=ne.useState(!1),[me,de]=ne.useState(!1),[re,_e]=ne.useState(null),[Ie,ve]=ne.useState(null),[ee,le]=ne.useState([]),te=se=>{v(se.name),y(se.age||"30");let ye="";if(se.description&&se.description.includes("[Visual Analysis]")){const Te=se.description.split("[Visual Analysis]");if(Te.length>1){const be=Te[1].split("[Basic Info]")[0].trim();be&&(ye=be)}}else se.description&&(ye=se.description);Z(Te=>({...Te,extraDetails:ye})),se.visualGuide,ye?f(`'${se.name}'  .   ' ' .`,"success"):f(`'${se.name}'  . (   )`,"info")},xe=se=>{const ye=a==null?void 0:a.find(Te=>Te.name===se.name);if(ye&&ye.imageUrl){if(ve(ye.imageUrl),te(se),ye.design){const Te=ye.design;let be=Te.gender||"Male";be.includes("Male")&&(be="Male"),be.includes("Female")&&(be="Female"),Z(Ve=>({...Ve,...Te,gender:be,optionFlags:Te.optionFlags||Ve.optionFlags}))}f(`'${se.name}'  .       !`,"success")}else f(`'${se.name}'   .`,"warning")};ne.useEffect(()=>{},[L.gender,T]);const ce=(se,ye)=>{Z(Te=>({...Te,[se]:ye}))},S=se=>{var be;const ye=(be=se.target.files)==null?void 0:be[0];if(!ye)return;if(ye.size>5*1024*1024){f("  5MB  .","warning");return}const Te=new FileReader;Te.onloadend=()=>{ve(Te.result)},Te.readAsDataURL(ye)},P=async()=>{if(!E.trim())return f("  ","warning");if(!T.trim())return f(" ","warning");if(!o)return f("API  ","warning");B(!0);try{const se={...L,gender:`${T} year old ${L.gender}`},ye=await JC(o,se,i,$,Ie||void 0);_e(ye),le(Te=>[ye,...Te]),f(" .   .","success")}catch(se){f(se.message,"error")}finally{B(!1)}},k=async()=>{if(!(!re||!E)){if(!o)return f("API  .","warning");de(!0);try{f("AI      ...","info");let se="";try{se=await Mm(o,re)}catch(xt){console.error("Image analysis failed",xt),se="   (  )"}const ye=`${T} ${L.class}. ${L.hair}, ${L.headwear}. ${L.facialFeatures?`(: ${L.facialFeatures}) `:""}${L.extraDetails}`,be=se&&!se.includes("")?se:ye,Ve=c.some(xt=>xt.name===E);let st=E;s(xt=>[...xt.filter(Ke=>Ke.name!==E),{id:`ref-${Date.now()}`,name:E,imageUrl:re,description:be,design:{...L,gender:`${T} year old ${L.gender}`}}]),u(xt=>{const un=xt.findIndex(Ke=>Ke.name===E);if(un>=0){const Ke=[...xt];return Ke[un]={...Ke[un],description:be,age:T,gender:L.gender},Ke}else return[...xt,{id:`char-builder-${Date.now()}`,name:E,description:be,visualGuide:"AI     ( )",age:T,gender:L.gender,hasDialogue:!0,chromaKeyColor:"green",actions:[]}]}),f(`'${E}'  . (   )`,"success"),t()}catch(se){f("   .","error"),console.error(se)}finally{de(!1)}}},I=(se,ye)=>{window.confirm(`'${ye}'   ?`)&&g(se,ye)},N=(se,ye,Te)=>{se.stopPropagation(),window.confirm(` '${Te}'  ?
(     )`)&&(u(be=>be.filter(Ve=>Ve.id!==ye)),s(be=>be.filter(Ve=>Ve.name!==Te)),f(`'${Te}'  .`,"success"),E===Te&&v(""))},U=(se,ye)=>((m==null?void 0:m[se])||[]).some(be=>be.label===ye),X=(se,ye)=>{Z(Te=>{const be=Te.optionFlags||{},Ve=be[se]||{enabled:!0,isMandatory:!1};return{...Te,optionFlags:{...be,[se]:{...Ve,[ye]:!Ve[ye]}}}})},W=(se,ye,Te,be)=>{var un;const Ve=((un=L.optionFlags)==null?void 0:un[ye])||{enabled:!0,isMandatory:!1},st=Ve.enabled,xt=Ve.isMandatory;return h.jsxs("div",{className:`flex flex-col gap-1 transition-opacity ${st?"":"opacity-50"}`,children:[h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold",children:se}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>X(ye,"enabled"),className:`text-[10px] px-2 py-0.5 rounded border font-bold ${st?"bg-indigo-600 text-white border-indigo-500":"bg-slate-700 text-slate-400 border-slate-600"}`,title:st?"  (AI )":"  (AI    -   )",children:st?"ON":"OFF"}),h.jsx("button",{onClick:()=>X(ye,"isMandatory"),disabled:!st,className:`text-[10px] px-2 py-0.5 rounded border font-bold ${xt?"bg-red-600 text-white border-red-500":"bg-slate-700 text-slate-400 border-slate-600"} ${st?"":"opacity-0 cursor-default"}`,title:"   ( )",children:xt?"":""}),h.jsx("button",{onClick:()=>z(be||ye,se),className:"text-[10px] text-indigo-400 hover:text-indigo-300 flex items-center gap-1 bg-indigo-900/30 px-2 py-0.5 rounded border border-indigo-500/30",title:"  ",children:h.jsx("i",{className:"fas fa-plus"})})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("select",{value:typeof L[ye]=="string"?L[ye]:"",onChange:Ke=>ce(ye,Ke.target.value),disabled:!st,className:"bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white focus:ring-indigo-500 flex-grow disabled:bg-slate-800 disabled:text-slate-500",children:Te.map((Ke,dr)=>h.jsxs("option",{value:Ke.value,children:[Ke.label," ",U(be||ye,Ke.label)?"( )":""]},dr))}),(()=>{var dr;const Ke=(dr=Te.find(Os=>Os.value===L[ye]))==null?void 0:dr.label;return Ke&&U(be||ye,Ke)?h.jsx("button",{onClick:()=>I(be||ye,Ke),className:"bg-red-900/30 text-red-400 border border-red-500/30 px-2 rounded hover:bg-red-900/50",title:"   ",children:h.jsx("i",{className:"fas fa-trash"})}):null})()]})]})};return h.jsxs("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-[100] flex items-center justify-center p-4 animate-fade-in overflow-hidden",children:[x&&h.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center bg-black/80 backdrop-blur-sm",children:h.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-600 shadow-2xl w-full max-w-md animate-fade-in",children:[h.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-plus-circle text-indigo-400"})," '",x.label,"'  "]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-slate-400 mb-1",children:"  (  )"}),h.jsx("input",{type:"text",value:_,onChange:se=>b(se.target.value),placeholder:":  ( 9)",className:"w-full bg-slate-900 border border-slate-700 rounded p-3 text-white focus:ring-indigo-500",autoFocus:!0})]}),h.jsxs("div",{className:"bg-slate-900/50 p-3 rounded border border-slate-700",children:[h.jsxs("label",{className:"block text-xs font-bold text-indigo-400 mb-2 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-camera"}),"    ()"]}),h.jsxs("div",{className:"flex gap-3 items-center",children:[F?h.jsxs("div",{className:"relative h-16 w-16 bg-black rounded overflow-hidden border border-slate-600 flex-shrink-0",children:[h.jsx("img",{src:F,alt:"Option Ref",className:"h-full w-full object-cover"}),h.jsx("button",{onClick:()=>D(null),className:"absolute inset-0 bg-black/50 flex items-center justify-center text-white opacity-0 hover:opacity-100 transition-opacity",children:h.jsx("i",{className:"fas fa-times"})})]}):h.jsxs("label",{className:"cursor-pointer h-16 w-16 bg-slate-800 rounded border border-dashed border-slate-600 flex items-center justify-center text-slate-500 hover:text-white hover:border-indigo-500 transition-colors flex-shrink-0",children:[h.jsx("i",{className:"fas fa-plus"}),h.jsx("input",{type:"file",accept:"image/*",onChange:C,className:"hidden"})]}),h.jsxs("div",{className:"flex-grow",children:[h.jsx("p",{className:"text-[10px] text-slate-500 mb-2 leading-relaxed",children:"       AI    ."}),h.jsxs("button",{onClick:q,disabled:!F||V,className:`w-full py-2 rounded text-xs font-bold flex items-center justify-center gap-2 ${F?"bg-indigo-600 hover:bg-indigo-500 text-white":"bg-slate-700 text-slate-500 cursor-not-allowed"}`,children:[V?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-magic"}),V?" ...":"    "]})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-bold text-slate-400 mb-1",children:"AI   (  )"}),h.jsx("textarea",{value:M,onChange:se=>R(se.target.value),placeholder:":  9  ,  ,  ,    (  )",className:"w-full bg-slate-900 border border-slate-700 rounded p-3 text-white focus:ring-indigo-500 h-24 resize-none"}),h.jsx("p",{className:"text-[10px] text-slate-500 mt-1",children:"   AI    ."})]}),h.jsxs("div",{className:"flex gap-2 pt-2",children:[h.jsx("button",{onClick:()=>w(null),className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white py-3 rounded-lg font-bold",children:""}),h.jsx("button",{onClick:ue,className:"flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-lg font-bold",children:""})]})]})]})}),h.jsxs("div",{className:"bg-slate-800 w-full max-w-6xl h-[90vh] rounded-2xl border border-slate-600 shadow-2xl flex flex-col md:flex-row overflow-hidden",children:[h.jsxs("div",{className:"w-full md:w-1/2 p-6 overflow-y-auto border-r border-slate-700 custom-scrollbar bg-slate-800 z-10",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-user-edit text-indigo-400"}),"   "]}),h.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white",children:h.jsx("i",{className:"fas fa-times text-xl"})})]}),c&&c.length>0&&h.jsxs("div",{className:"mb-6 bg-slate-900/50 p-3 rounded-lg border border-slate-700",children:[h.jsxs("label",{className:"text-xs text-indigo-400 font-bold block mb-2 flex items-center gap-1",children:[h.jsx("i",{className:"fas fa-users"}),"   (  )"]}),h.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(se=>h.jsxs("div",{className:"relative group",children:[h.jsxs("button",{onClick:()=>{te(se),se.isGroup&&f(`'${se.name}'() /.       . (  '  ' )`,"info")},className:`px-3 py-1.5 rounded-full text-xs font-bold transition-all border shadow-sm pr-14 flex items-center gap-1
                                    ${E===se.name?"bg-indigo-600 text-white border-indigo-400 ring-2 ring-indigo-400/50":se.isGroup?"bg-slate-800 text-slate-400 border-slate-700 hover:bg-slate-700 hover:text-slate-200 border-dashed":"bg-slate-700 text-slate-300 border-slate-600 hover:bg-slate-600 hover:text-white"}`,children:[se.isGroup&&h.jsx("i",{className:"fas fa-users text-[10px] opacity-70"}),se.name]}),h.jsxs("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 flex gap-1",children:[h.jsx("button",{onClick:ye=>{ye.stopPropagation(),xe(se)},className:"w-5 h-5 rounded-full bg-slate-800 text-slate-400 hover:text-indigo-400 hover:bg-slate-900 border border-slate-600 flex items-center justify-center transition-colors",title:"     (/ )",children:h.jsx("i",{className:"fas fa-edit text-[9px]"})}),h.jsx("button",{onClick:ye=>N(ye,se.id,se.name),className:"w-5 h-5 rounded-full bg-slate-800 text-slate-400 hover:text-red-400 hover:bg-slate-900 border border-slate-600 flex items-center justify-center transition-colors",title:"  ( )",children:h.jsx("i",{className:"fas fa-trash text-[9px]"})})]})]},se.id))}),h.jsxs("p",{className:"text-[10px] text-slate-500 mt-2",children:[h.jsx("i",{className:"fas fa-info-circle"}),"  ()       ."]})]}),n&&h.jsxs("div",{className:"mb-4 bg-indigo-900/40 border border-indigo-500/50 p-3 rounded-lg flex items-center gap-3",children:[h.jsx("i",{className:"fas fa-robot text-indigo-300 text-xl"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-indigo-200 text-sm font-bold",children:"AI   "}),h.jsx("p",{className:"text-xs text-indigo-400",children:"   , ,   ."})]})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-bold text-slate-300 block mb-2",children:"  ( )"}),h.jsx("input",{type:"text",value:E,onChange:se=>v(se.target.value),placeholder:": , ",className:"w-full bg-slate-900 border border-slate-700 rounded p-3 text-white focus:ring-indigo-500 font-bold text-lg"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"col-span-2 flex gap-4",children:[h.jsxs("div",{className:`flex-1 transition-opacity ${((oe=(H=L.optionFlags)==null?void 0:H.gender)==null?void 0:oe.enabled)===!1?"opacity-50":""}`,children:[h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold mb-1 block",children:"1. "}),h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("button",{onClick:()=>X("gender","enabled"),className:`text-[10px] px-2 py-0.5 rounded border font-bold ${((ie=(he=L.optionFlags)==null?void 0:he.gender)==null?void 0:ie.enabled)!==!1?"bg-indigo-600 text-white border-indigo-500":"bg-slate-700 text-slate-400 border-slate-600"}`,title:((Ne=(Ee=L.optionFlags)==null?void 0:Ee.gender)==null?void 0:Ne.enabled)!==!1?" ":" ",children:((Be=(we=L.optionFlags)==null?void 0:we.gender)==null?void 0:Be.enabled)!==!1?"ON":"OFF"}),h.jsx("button",{onClick:()=>X("gender","isMandatory"),disabled:((Ze=(tn=L.optionFlags)==null?void 0:tn.gender)==null?void 0:Ze.enabled)===!1,className:`text-[10px] px-2 py-0.5 rounded border font-bold ${(Oe=(zt=L.optionFlags)==null?void 0:zt.gender)!=null&&Oe.isMandatory?"bg-red-600 text-white border-red-500":"bg-slate-700 text-slate-400 border-slate-600"}`,title:"  ",children:(Nt=(nn=L.optionFlags)==null?void 0:nn.gender)!=null&&Nt.isMandatory?"":""}),h.jsx("button",{onClick:()=>z("gender",""),className:"text-[10px] text-indigo-400 hover:text-indigo-300 flex items-center gap-1 bg-indigo-900/30 px-2 py-0.5 rounded border border-indigo-500/30",title:"   ",children:h.jsx("i",{className:"fas fa-plus"})})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("select",{value:L.gender,onChange:se=>ce("gender",se.target.value),disabled:((Yn=(ft=L.optionFlags)==null?void 0:ft.gender)==null?void 0:Yn.enabled)===!1,className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white disabled:bg-slate-800 disabled:text-slate-500",children:A.gender.map((se,ye)=>h.jsxs("option",{value:se.value,children:[se.label," ",U("gender",se.label)?"()":""]},ye))}),(()=>{const se=A.gender.find(ye=>ye.value===L.gender);return se&&U("gender",se.label)?h.jsx("button",{onClick:()=>I("gender",se.label),className:"bg-red-900/30 text-red-400 border border-red-500/30 px-2 rounded hover:bg-red-900/50",title:"  ",children:h.jsx("i",{className:"fas fa-trash"})}):null})()]})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold mb-1 block",children:" ( )"}),h.jsx("input",{type:"number",value:T,onChange:se=>y(se.target.value),placeholder:": 60",className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white"})]})]}),W("2. /","class",A.class),W("3. ","race",A.race),!(L.race.includes("Pure Animal")||L.race.includes(" ("))&&h.jsxs(h.Fragment,{children:[W("4.  ","hair",A.hair),W("5. /","headwear",A.headwear),W("6. ","outer",A.outer),W("7. ","top",A.top),W("8. ","bottom",A.bottom),W("9. ","shoes",A.shoes),W("10. /","accessories",A.accessories)]})]}),!(L.race.includes("Pure Animal")||L.race.includes(" ("))&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold",children:"11.   ( )"}),h.jsx("input",{type:"text",value:L.clothingColor,onChange:se=>ce("clothingColor",se.target.value),placeholder:":    ,  ",className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold",children:"12.   (:  )"}),h.jsx("input",{type:"text",value:L.facialFeatures||"",onChange:se=>ce("facialFeatures",se.target.value),placeholder:":  , , ,  , ...",className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white focus:ring-yellow-500"})]}),h.jsxs("div",{className:"space-y-2 bg-indigo-900/20 p-3 rounded border border-indigo-500/30",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("label",{className:"text-xs text-indigo-300 font-bold flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-plus-circle"}),"   /  ()"]}),h.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(L.extraDetails),f(" .","success")},className:"text-[10px] text-indigo-400 hover:text-indigo-200 flex items-center gap-1 px-2 py-1 rounded bg-indigo-900/50 border border-indigo-500/30 transition-all",title:" ",children:[h.jsx("i",{className:"fas fa-copy"})," "]})]}),h.jsx("textarea",{value:L.extraDetails,onChange:se=>ce("extraDetails",se.target.value),placeholder:":    ,  ,  ,  ...",className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white h-16 focus:ring-indigo-500 resize-none"})]}),h.jsxs("div",{className:"space-y-2 bg-yellow-900/10 p-3 rounded border border-yellow-500/30",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("label",{className:"text-xs text-yellow-400 font-bold flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-ruler-vertical"}),"  /   (Scale)"]}),h.jsxs("span",{className:"text-xs font-bold text-yellow-200",children:[L.scale||90,"%"]})]}),h.jsx("input",{type:"range",min:"30",max:"100",step:"5",value:L.scale||90,onChange:se=>{const ye=parseInt(se.target.value);ce("scale",ye)},className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-yellow-500"}),h.jsxs("p",{className:"text-[10px] text-slate-400 flex justify-between",children:[h.jsx("span",{children:" ()"}),h.jsx("span",{children:" ()"}),h.jsx("span",{children:" "})]}),h.jsxs("p",{className:"text-[10px] text-slate-400 mt-1",children:[" ",h.jsx("strong",{children:"30-40%"}),": , ",h.jsx("strong",{children:"80-90%"}),": , ",h.jsx("strong",{children:"100%"}),": "]})]}),h.jsxs("div",{className:"space-y-2 bg-red-900/10 p-3 rounded border border-red-500/30",children:[h.jsxs("label",{className:"text-xs text-red-400 font-bold flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-ban"}),"  /  (  )"]}),h.jsx("input",{type:"text",value:$,onChange:se=>Y(se.target.value),placeholder:": , ,  , , , ",className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white focus:ring-red-500 placeholder-slate-500"}),h.jsxs("p",{className:"text-[10px] text-slate-400",children:["    AI ",h.jsx("strong",{children:'"   !"'}),"  ."]})]}),h.jsxs("div",{className:"space-y-2 bg-indigo-900/20 p-3 rounded border border-indigo-500/30",children:[h.jsxs("label",{className:"text-xs text-indigo-300 font-bold flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-image"}),"    (/ )"]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("label",{className:"cursor-pointer bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded border border-slate-600 flex items-center gap-2 text-sm",children:[h.jsx("i",{className:"fas fa-upload"}),"  ",h.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"hidden"})]}),Ie&&h.jsxs("div",{className:"relative h-16 w-16 bg-black rounded border border-slate-600 overflow-hidden group",children:[h.jsx("img",{src:Ie,alt:"Reference",className:"h-full w-full object-cover"}),h.jsx("button",{onClick:()=>ve(null),className:"absolute inset-0 bg-black/50 hidden group-hover:flex items-center justify-center text-red-400",children:h.jsx("i",{className:"fas fa-trash"})})]})]}),h.jsx("p",{className:"text-[10px] text-slate-400",children:" , ,     AI   ."})]}),W("13.  ()","backgroundColor",A.bg,"bg"),h.jsxs("button",{onClick:P,disabled:G,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg flex items-center justify-center gap-2 mt-4",children:[G?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-paint-brush"}),"  "]})]})]}),h.jsxs("div",{className:"w-full md:w-1/2 bg-black flex flex-col relative h-full",children:[h.jsxs("div",{className:"p-4 flex-grow flex flex-col items-center justify-center overflow-hidden",children:[h.jsx("h3",{className:"text-slate-500 font-bold mb-4 absolute top-6 left-6",children:""}),h.jsxs("div",{className:"w-full max-w-sm aspect-[9/16] bg-slate-900 rounded-lg overflow-hidden border border-slate-700 flex items-center justify-center mb-4 relative shadow-2xl",children:[re?h.jsx("img",{src:re,alt:"Preview",className:"w-full h-full object-contain"}):h.jsxs("div",{className:"text-center text-slate-600",children:[h.jsx("i",{className:"fas fa-user-circle text-6xl mb-4 opacity-50"}),h.jsxs("p",{children:["  ",h.jsx("br",{}),"  ."]})]}),G&&h.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center backdrop-blur-sm",children:h.jsx("i",{className:"fas fa-spinner fa-spin text-4xl text-indigo-500"})})]}),re&&h.jsxs("div",{className:"flex gap-4 w-full max-w-sm",children:[h.jsx("button",{onClick:k,disabled:me,className:`flex-1 text-white py-3 rounded-lg font-bold shadow-lg transform hover:scale-105 transition-all ${me?"bg-slate-600 cursor-not-allowed":"bg-green-600 hover:bg-green-500"}`,children:me?h.jsxs("span",{children:[h.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"    ..."]}):h.jsxs("span",{children:[h.jsx("i",{className:"fas fa-check-circle mr-2"}),"    ()"]})}),h.jsx("a",{href:re,download:`${E}_reference.png`,className:"bg-slate-800 hover:bg-slate-700 text-white px-4 py-3 rounded-lg border border-slate-600",children:h.jsx("i",{className:"fas fa-download"})})]})]}),h.jsxs("div",{className:"bg-slate-900 border-t border-slate-700 p-4 h-48 flex-shrink-0 flex flex-col",children:[h.jsxs("p",{className:"text-xs text-slate-400 mb-2 font-bold flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-history text-indigo-400"}),"     (",ee.length,")",h.jsx("span",{className:"text-[10px] font-normal text-slate-500 ml-auto",children:" "})]}),ee.length===0?h.jsx("div",{className:"flex-grow flex items-center justify-center text-slate-600 text-xs border border-dashed border-slate-700 rounded-lg",children:"   ."}):h.jsx("div",{className:"flex gap-3 overflow-x-auto overflow-y-hidden pb-2 custom-scrollbar px-1 h-full items-center",children:ee.map((se,ye)=>h.jsx("div",{onClick:()=>_e(se),className:`flex-shrink-0 w-20 h-28 rounded-lg overflow-hidden cursor-pointer border-2 transition-all hover:scale-105 shadow-lg ${re===se?"border-indigo-500 ring-2 ring-indigo-500/50 scale-105":"border-slate-700 hover:border-slate-500 opacity-70 hover:opacity-100"}`,children:h.jsx("img",{src:se,alt:`History ${ye}`,className:"w-full h-full object-cover"})},ye))})]})]})]})]})},xi={types:[{label:" ",value:"Object"},{label:"/ ",value:"Evidence"},{label:" (/ )",value:"Weapon"},{label:" (/ )",value:"Accessory"},{label:"/ ",value:"Furniture"}],materials:[{label:" (Wood)",value:"Wooden"},{label:"/ (Metal)",value:"Metal, Iron, Steel"},{label:" (Gold)",value:"Gold"},{label:" (Silver)",value:"Silver"},{label:" (Jade)",value:"Jade"},{label:"/ (Fabric)",value:"Fabric, Silk, Cotton"},{label:" (Paper)",value:"Paper"},{label:" (Ceramic)",value:"Ceramic, Porcelain"},{label:" (Stone)",value:"Stone"}],colors:[{label:"/",value:"Natural"},{label:" (Red)",value:"Red"},{label:" (Blue)",value:"Blue"},{label:" (Black)",value:"Black"},{label:" (White)",value:"White"},{label:" (Gold)",value:"Gold"},{label:" (Silver)",value:"Silver"},{label:" (Green)",value:"Green"}]},e_=({onClose:t,initialName:e=""})=>{const{apiKey:n,selectedStyle:r,setProps:o,showToast:i}=Qt(),[s,a]=ne.useState(e),[u,c]=ne.useState(xi.types[0].value),[f,m]=ne.useState(""),[p,g]=ne.useState(""),[E,v]=ne.useState(""),[T,y]=ne.useState(!1),[x,w]=ne.useState(null),[_,b]=ne.useState(null),[M,R]=ne.useState([]),F=K=>{var C;const A=(C=K.target.files)==null?void 0:C[0];if(!A)return;if(A.size>5*1024*1024){i("  5MB  .","warning");return}const z=new FileReader;z.onloadend=()=>{b(z.result)},z.readAsDataURL(A)},D=async()=>{if(!s.trim())return i("  ","warning");if(!E.trim()&&!_)return i("     .","warning");if(!n)return i("API  ","warning");y(!0);try{let K=`Type: ${u}.
`;p&&(K+=`Color: ${p}.
`),f&&(K+=`Material: ${f}.
`),K+=`Details: ${E}`;const A=await KC(n,s,K,r,_||void 0);w(A),R(z=>[A,...z]),i(" .   .","success")}catch(K){i(K.message,"error")}finally{y(!1)}},V=()=>{if(!x||!s)return;const K=`${p} ${f} ${s}. ${E}`;o(A=>[...A,{id:`prop-builder-${Date.now()}`,name:s,imageUrl:x,description:K,type:"object"}]),i(`'${s}'  !`,"success"),t()};return h.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-[100] flex items-center justify-center p-4 animate-fade-in overflow-hidden",children:h.jsxs("div",{className:"bg-slate-800 w-full max-w-6xl h-[90vh] rounded-2xl border border-slate-600 shadow-2xl flex flex-col md:flex-row overflow-hidden",children:[h.jsxs("div",{className:"w-full md:w-1/2 p-6 overflow-y-auto border-r border-slate-700 custom-scrollbar bg-slate-800 z-10",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-cube text-amber-500"}),"   "]}),h.jsx("button",{onClick:t,className:"text-slate-400 hover:text-white",children:h.jsx("i",{className:"fas fa-times text-xl"})})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-bold text-slate-300 block mb-2",children:" "}),h.jsx("input",{type:"text",value:s,onChange:K=>a(K.target.value),placeholder:": , , ",className:"w-full bg-slate-900 border border-slate-700 rounded p-3 text-white focus:ring-amber-500 font-bold text-lg"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold mb-1 block",children:"1.  "}),h.jsx("select",{value:u,onChange:K=>c(K.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white focus:ring-amber-500",children:xi.types.map((K,A)=>h.jsx("option",{value:K.value,children:K.label},A))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold mb-1 block",children:"2.  (Color)"}),h.jsx("input",{type:"text",value:p,onChange:K=>g(K.target.value),placeholder:": , ",className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white focus:ring-amber-500",list:"color-options"}),h.jsx("datalist",{id:"color-options",children:xi.colors.map((K,A)=>h.jsx("option",{value:K.label},A))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold mb-1 block",children:"3.  (Material)"}),h.jsx("input",{type:"text",value:f,onChange:K=>m(K.target.value),placeholder:": , , ",className:"w-full bg-slate-700 border border-slate-600 rounded p-2 text-sm text-white focus:ring-amber-500",list:"material-options"}),h.jsx("datalist",{id:"material-options",children:xi.materials.map((K,A)=>h.jsx("option",{value:K.label},A))})]})]}),h.jsxs("div",{className:"space-y-2 bg-slate-900/50 p-3 rounded border border-slate-700",children:[h.jsxs("label",{className:"text-xs text-amber-400 font-bold flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-pen"}),"    (, )"]}),h.jsx("textarea",{value:E,onChange:K=>v(K.target.value),placeholder:":     ,     .   .",className:"w-full bg-slate-800 border border-slate-600 rounded p-2 text-sm text-white h-24 focus:ring-amber-500 resize-none"})]}),h.jsxs("div",{className:"space-y-2 bg-amber-900/20 p-3 rounded border border-amber-500/30",children:[h.jsxs("label",{className:"text-xs text-amber-300 font-bold flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-image"}),"    (/ )"]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("label",{className:"cursor-pointer bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded border border-slate-600 flex items-center gap-2 text-sm transition-colors",children:[h.jsx("i",{className:"fas fa-upload"}),"  ",h.jsx("input",{type:"file",accept:"image/*",onChange:F,className:"hidden"})]}),_&&h.jsxs("div",{className:"relative h-16 w-16 bg-black rounded border border-slate-600 overflow-hidden group",children:[h.jsx("img",{src:_,alt:"Reference",className:"h-full w-full object-cover"}),h.jsx("button",{onClick:()=>b(null),className:"absolute inset-0 bg-black/50 hidden group-hover:flex items-center justify-center text-red-400",children:h.jsx("i",{className:"fas fa-trash"})})]})]}),h.jsx("p",{className:"text-[10px] text-slate-400",children:"   AI       ."})]}),h.jsxs("button",{onClick:D,disabled:T,className:"w-full bg-amber-600 hover:bg-amber-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg flex items-center justify-center gap-2 mt-4 transition-all hover:shadow-amber-500/20",children:[T?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-paint-brush"})," "]})]})]}),h.jsxs("div",{className:"w-full md:w-1/2 bg-black/50 p-6 flex flex-col relative",children:[h.jsx("div",{className:"flex-grow flex items-center justify-center relative bg-[url('/grid.png')]",children:x?h.jsxs("div",{className:"relative w-full max-w-md aspect-square shadow-2xl rounded-lg overflow-hidden border-2 border-slate-700 group",children:[h.jsx("img",{src:x,alt:"Preview",className:"w-full h-full object-contain bg-[#202020]"}),h.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 p-4 transform translate-y-full group-hover:translate-y-0 transition-transform",children:h.jsxs("button",{onClick:V,className:"w-full bg-green-600 hover:bg-green-500 text-white py-3 rounded-lg font-bold shadow-lg",children:[h.jsx("i",{className:"fas fa-check mr-2"}),"   "]})})]}):h.jsxs("div",{className:"text-center text-slate-500",children:[h.jsx("i",{className:"fas fa-cube text-6xl mb-4 opacity-20"}),h.jsx("p",{className:"text-lg",children:"  '' ."})]})}),M.length>0&&h.jsx("div",{className:"h-24 border-t border-slate-700 bg-slate-900/80 p-2 flex gap-2 overflow-x-auto custom-scrollbar mt-4",children:M.map((K,A)=>h.jsx("div",{onClick:()=>w(K),className:`aspect-square h-full rounded cursor-pointer border-2 overflow-hidden flex-shrink-0 ${x===K?"border-amber-500":"border-transparent opacity-50 hover:opacity-100"}`,children:h.jsx("img",{src:K,alt:`History ${A}`,className:"w-full h-full object-cover"})},A))})]})]})})},t_=({id:t,style:e,selected:n,onSelect:r})=>h.jsxs("div",{onClick:()=>r(t),className:`cursor-pointer rounded-xl p-4 border-2 transition-all h-full flex flex-col gap-2 relative overflow-hidden ${n?"border-indigo-500 bg-indigo-900/30 ring-2 ring-indigo-500/50":"border-slate-700 bg-slate-800 hover:border-slate-500"}`,children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:`text-lg font-bold ${n?"text-indigo-300":"text-slate-200"}`,children:e.name}),n&&h.jsx("i",{className:"fas fa-check-circle text-indigo-400 text-xl"})]}),h.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:e.desc})]}),n_=({selected:t,onChange:e})=>{const n=[{id:"16:9",label:" (16:9)",icon:"fa-tv"},{id:"9:16",label:" (9:16)",icon:"fa-mobile-alt"},{id:"1:1",label:" (1:1)",icon:"fa-square"}];return h.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(r=>h.jsxs("button",{onClick:()=>e(r.id),className:`px-3 py-1.5 rounded-lg text-sm font-medium flex items-center gap-2 border transition-all ${t===r.id?"bg-indigo-600 text-white border-indigo-500 shadow-md":"bg-slate-800 text-slate-400 border-slate-700 hover:bg-slate-700"}`,children:[h.jsx("i",{className:`fas ${r.icon}`}),r.label]},r.id))})},r_=({onAnalyze:t,isAnalyzing:e})=>{const{apiKey:n,script:r,scriptSegments:o,addScriptSegment:i,removeScriptSegment:s,clearScriptSegments:a,selectedStyle:u,setSelectedStyle:c,globalAspectRatio:f,setGlobalAspectRatio:m,isContinuityMode:p,setIsContinuityMode:g,referenceImages:E,setReferenceImages:v,characters:T,setCharacters:y,props:x,setProps:w,showToast:_,openModal:b}=Qt(),[M,R]=ne.useState(!1),[F,D]=ne.useState(!1),[V,K]=ne.useState(null),[A,z]=ne.useState(""),[C,q]=ne.useState(""),ue=ne.useRef(null),$=ne.useRef(null),Y=ne.useRef(null),L=ne.useRef(null),Z=()=>{var P;return(P=ue.current)==null?void 0:P.scrollIntoView({behavior:"smooth"})},G=()=>{var P;return(P=$.current)==null?void 0:P.scrollIntoView({behavior:"smooth"})},B=(P,k,I)=>{P.preventDefault(),P.stopPropagation(),b({type:"confirm",title:"  ",message:`'${I}'    ?
(   .)`,onConfirm:()=>{v(N=>N.filter(U=>U.id!==k)),_(".","success")}})},me=()=>{Y.current&&(Y.current.value="",Y.current.click())},de=P=>{var N;const k=(N=P.target.files)==null?void 0:N[0];if(!k)return;if(k.size>5*1024*1024){_("   5MB  .","warning");return}const I=new FileReader;I.onload=async U=>{var W;const X=(W=U.target)==null?void 0:W.result;X&&b({type:"prompt",title:"  ",message:"    (: )",confirmText:": AI ",onConfirm:async H=>{if(H&&H.trim()){const oe=H.trim();let he="Imported external character. (Auto-analysis failed)";if(n){_("AI    ...","success");try{he=await Mm(n,X)}catch(ie){console.error(ie),_(" .  .","error"),he=" .       ."}}b({type:"textarea",title:`${oe} /  ()`,message:`AI  . 
      ** **. 
 , ,     !`,defaultValue:he,confirmText:"  (  )",onConfirm:ie=>{const Ee=ie||he;v(Ne=>[...Ne,{id:`ref-upload-${Date.now()}`,name:oe,imageUrl:X,description:Ee}]),y(Ne=>{const we=Ne.findIndex(Be=>Be.name===oe);if(we!==-1){const Be=[...Ne];return Be[we]={...Be[we],description:Ee,visualGuide:"   ( )"},Be}return[...Ne,{id:`char-manual-${Date.now()}`,name:oe,description:Ee,visualGuide:"   ( )",age:"",gender:"",hasDialogue:!0,chromaKeyColor:"green",actions:[]}]}),_(`'${oe}'   !`,"success")}})}}})},I.onerror=()=>{_("   .","error")},I.readAsDataURL(k)},re=()=>{L.current&&(L.current.value="",L.current.click())},_e=P=>{var N;const k=(N=P.target.files)==null?void 0:N[0];if(!k)return;if(k.size>5*1024*1024){_("   5MB  .","warning");return}const I=new FileReader;I.onload=async U=>{var W;const X=(W=U.target)==null?void 0:W.result;X&&b({type:"prompt",title:"/  ",message:"    (: ,   )",confirmText:"",onConfirm:H=>{if(H&&H.trim()){const oe=H.trim();b({type:"textarea",title:`${oe}  `,message:`     .
(AI      .)`,defaultValue:"  , ,  ...",confirmText:"",onConfirm:he=>{w(ie=>[...ie,{id:`prop-upload-${Date.now()}`,name:oe,imageUrl:X,description:he||" ",type:"object"}]),_(`'${oe}'  !`,"success")}})}}})},I.readAsDataURL(k)},Ie=()=>{if(!n){_("API  .","warning");return}D(!0)},ve=(P,k,I)=>{P.preventDefault(),P.stopPropagation(),b({type:"confirm",title:" ",message:`'${I}'  ?`,onConfirm:()=>{w(N=>N.filter(U=>U.id!==k)),_(".","success")}})},ee=()=>{b({type:"confirm",title:"  ",message:"  () ?",confirmText:"",onConfirm:()=>a()})},le=()=>{if(!A.trim()){_(" .","warning");return}const P=C.trim()||`Chapter ${o.length+1}`;i(P,A),z(""),q(""),_(`${P} !`,"success")},te=(P,k)=>{navigator.clipboard.writeText(P),_(`'${k}'  .`,"success")},xe=()=>{if(o.length===0)return;const P=o.map(k=>`[${k.title}]
${k.content}`).join(`

`);navigator.clipboard.writeText(P),_("  .","success")},[ce,S]=ne.useState(30);return h.jsxs("div",{className:"space-y-10 animate-fade-in relative",children:[h.jsx("div",{ref:ue}),h.jsxs("div",{className:"fixed left-6 bottom-20 flex flex-col gap-2 z-50",children:[h.jsx("button",{onClick:Z,className:"bg-slate-700/80 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg backdrop-blur-sm border border-slate-600 transition-all",title:" ",children:h.jsx("i",{className:"fas fa-arrow-up"})}),h.jsx("button",{onClick:G,className:"bg-slate-700/80 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg backdrop-blur-sm border border-slate-600 transition-all",title:" ",children:h.jsx("i",{className:"fas fa-arrow-down"})})]}),h.jsxs("section",{className:"space-y-4",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[h.jsx("span",{className:"w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-sm",children:"1"}),"  ( )"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"file",ref:Y,onChange:de,accept:"image/*",className:"hidden"}),h.jsxs("button",{onClick:me,className:"bg-slate-700 hover:bg-slate-600 text-slate-200 px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2 border border-slate-600",children:[h.jsx("i",{className:"fas fa-upload"}),"   "]}),h.jsxs("button",{onClick:()=>R(!0),className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2 shadow-lg",children:[h.jsx("i",{className:"fas fa-plus"}),"  "]})]})]}),E.length===0?h.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 border-dashed rounded-xl p-6 text-center text-slate-500",children:[h.jsx("i",{className:"fas fa-users text-4xl mb-3 opacity-30"}),h.jsx("p",{children:"   ."})]}):h.jsx("div",{className:"flex gap-4 overflow-x-auto pt-2 pb-4 custom-scrollbar px-1",children:E.map(P=>h.jsxs("div",{className:"min-w-[180px] w-48 bg-slate-800 rounded-lg border border-slate-700 p-3 relative group hover:border-indigo-500 transition-colors",children:[h.jsx("button",{onClick:k=>B(k,P.id,P.name),className:"absolute top-2 right-2 bg-red-600 hover:bg-red-500 text-white w-7 h-7 rounded-full flex items-center justify-center shadow-lg z-20 opacity-0 group-hover:opacity-100 transition-opacity",title:"",children:h.jsx("i",{className:"fas fa-times text-xs"})}),h.jsxs("div",{className:"aspect-[9/16] bg-black rounded overflow-hidden mb-2 relative cursor-zoom-in",onClick:()=>K({url:P.imageUrl,title:P.name}),children:[h.jsx("img",{src:P.imageUrl,alt:P.name,className:"w-full h-full object-cover hover:scale-110 transition-transform duration-300"}),h.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:h.jsx("i",{className:"fas fa-search-plus text-white opacity-0 group-hover:opacity-100 text-2xl drop-shadow-lg transform scale-50 group-hover:scale-100 transition-all"})})]}),h.jsx("p",{className:"font-bold text-center text-white text-base truncate mb-2",children:P.name}),h.jsxs("div",{className:"flex gap-2 justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:k=>{k.stopPropagation(),b({type:"alert",title:`${P.name} AI  `,message:P.description||"  .",confirmText:"",showCopyButton:!0,onConfirm:()=>{}})},className:"bg-green-600 hover:bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center shadow-lg",title:"AI   ",children:h.jsx("i",{className:"fas fa-file-alt text-xs"})}),h.jsx("button",{onClick:k=>{k.stopPropagation(),Y.current&&me()},className:"bg-indigo-600 hover:bg-indigo-500 text-white w-8 h-8 rounded-full flex items-center justify-center shadow-lg",title:" /",children:h.jsx("i",{className:"fas fa-sync-alt text-xs"})})]})]},P.id))})]}),h.jsxs("section",{className:"space-y-4",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[h.jsx("span",{className:"w-8 h-8 rounded-full bg-amber-600 flex items-center justify-center text-sm",children:"1.5"}),"  ( /)"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"file",ref:L,onChange:_e,accept:"image/*",className:"hidden"}),h.jsxs("button",{onClick:re,className:"bg-slate-700 hover:bg-slate-600 text-slate-200 px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2 border border-slate-600",children:[h.jsx("i",{className:"fas fa-upload"}),"   "]}),h.jsxs("button",{onClick:Ie,className:"bg-amber-600 hover:bg-amber-500 text-white px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2 shadow-lg",children:[h.jsx("i",{className:"fas fa-cube"}),"  "]})]})]}),x.length===0?h.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 border-dashed rounded-xl p-6 text-center text-slate-500",children:[h.jsx("i",{className:"fas fa-box-open text-4xl mb-3 opacity-30"}),h.jsx("p",{children:"   . (: , ,   )"})]}):h.jsx("div",{className:"flex gap-4 overflow-x-auto pt-2 pb-4 custom-scrollbar px-1",children:x.map(P=>h.jsxs("div",{className:"min-w-[100px] w-28 bg-slate-800 rounded-lg border border-slate-700 p-2 relative group hover:border-amber-500 transition-colors",children:[h.jsxs("div",{className:"aspect-square bg-black rounded overflow-hidden mb-2 relative cursor-zoom-in",onClick:()=>K({url:P.imageUrl,title:P.name}),children:[h.jsx("img",{src:P.imageUrl,alt:P.name,className:"w-full h-full object-cover hover:scale-110 transition-transform duration-300"}),h.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:h.jsx("i",{className:"fas fa-search-plus text-white opacity-0 group-hover:opacity-100 text-lg drop-shadow-lg transform scale-50 group-hover:scale-100 transition-all"})})]}),h.jsx("p",{className:"font-bold text-center text-white text-xs truncate",children:P.name}),h.jsx("button",{onClick:k=>ve(k,P.id,P.name),className:"absolute top-1 right-1 bg-red-600 hover:bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center shadow-lg z-20 transition-transform active:scale-95",title:"",children:h.jsx("i",{className:"fas fa-times text-xs"})})]},P.id))})]}),h.jsxs("section",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[h.jsx("span",{className:"w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-sm",children:"2"}),"  ( )"]}),h.jsxs("div",{className:"text-slate-400 text-sm",children:["  : ",h.jsx("span",{className:"text-indigo-400 font-bold",children:r.length}),"  / ",o.length," "]})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-slate-800 p-5 rounded-xl border border-slate-700 shadow-lg flex flex-col h-full",children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{className:"text-xs text-slate-400 font-bold block mb-1",children:"  ()"}),h.jsx("input",{type:"text",value:C,onChange:P=>q(P.target.value),placeholder:`Chapter ${o.length+1}`,className:"w-full bg-slate-900 border border-slate-600 rounded p-2 text-white focus:ring-indigo-500 text-sm"})]}),h.jsx("label",{className:"text-xs text-slate-400 font-bold block mb-1",children:" "}),h.jsx("textarea",{value:A,onChange:P=>z(P.target.value),placeholder:"    . (:    ...)",className:"w-full flex-grow min-h-[200px] bg-slate-900 text-base p-4 rounded-lg border border-slate-700 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 text-slate-100 placeholder-slate-500 resize-none mb-4"}),h.jsxs("button",{onClick:le,className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-lg font-bold shadow-lg flex items-center justify-center gap-2 transition-all",children:[h.jsx("i",{className:"fas fa-plus-circle"}),"  "]})]}),h.jsxs("div",{className:"bg-slate-900/50 p-5 rounded-xl border border-slate-700 h-full flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("h3",{className:"text-lg font-bold text-slate-200",children:[h.jsx("i",{className:"fas fa-list-ol mr-2 text-indigo-400"}),"  "]}),h.jsxs("div",{className:"flex gap-2",children:[o.length>0&&h.jsxs("button",{onClick:xe,className:"text-xs text-green-400 hover:text-green-300 underline mr-2",children:[h.jsx("i",{className:"fas fa-copy mr-1"})," "]}),o.length>0&&h.jsx("button",{onClick:ee,className:"text-xs text-red-400 hover:text-red-300 underline",children:" "})]})]}),h.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar space-y-3 pr-2",style:{maxHeight:"400px"},children:o.length===0?h.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-600 opacity-50",children:[h.jsx("i",{className:"fas fa-book-open text-5xl mb-3"}),h.jsxs("p",{children:["  ",h.jsx("br",{}),"'' ."]})]}):o.map((P,k)=>h.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-600 relative group hover:border-indigo-500 transition-colors",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs font-bold text-indigo-300 bg-indigo-900/50 px-2 py-0.5 rounded uppercase",children:P.title||`Chapter ${k+1}`}),h.jsx("button",{onClick:()=>te(P.content,P.title||`Chapter ${k+1}`),className:"text-slate-500 hover:text-green-400 p-1 transition-colors",title:" ",children:h.jsx("i",{className:"fas fa-copy"})})]}),h.jsx("button",{onClick:()=>s(P.id),className:"text-slate-500 hover:text-red-500 p-1",children:h.jsx("i",{className:"fas fa-trash-alt"})})]}),h.jsx("p",{className:"text-sm text-slate-300 line-clamp-3",children:P.content})]},P.id))})]})]})]}),h.jsxs("section",{className:"space-y-4",children:[h.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[h.jsx("span",{className:"w-8 h-8 rounded-full bg-indigo-500 flex items-center justify-center text-sm",children:"3"}),""]}),h.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 mb-4",children:[h.jsxs("div",{className:"mb-2 font-bold text-slate-300 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-crop-alt"}),"  "]}),h.jsx(n_,{selected:f,onChange:m})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.keys(St).map(P=>h.jsx(t_,{id:P,style:St[P],selected:u===P,onSelect:c},P))})]}),h.jsxs("div",{className:"flex flex-col items-center gap-4 pt-8",children:[h.jsxs("label",{className:"flex items-center gap-3 bg-slate-800 px-6 py-3 rounded-full border border-slate-600 cursor-pointer hover:bg-slate-750 select-none",children:[h.jsx("input",{type:"checkbox",checked:p,onChange:P=>g(P.target.checked),className:"w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500 border-gray-300"}),h.jsx("span",{className:"text-lg font-bold text-indigo-300",children:"  "}),h.jsx("span",{className:"text-xs text-slate-400 border-l border-slate-600 pl-3",children:"      ."})]}),o.length===0&&h.jsx("p",{className:"text-red-400 text-sm font-bold animate-pulse",children:"   !"}),h.jsxs("div",{className:"flex items-center gap-4 bg-slate-800 p-4 rounded-xl border border-slate-700",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("label",{className:"text-sm font-bold text-indigo-300 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-cut"}),"  ()  "]}),h.jsx("p",{className:"text-xs text-slate-400",children:"AI     ."})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>S(Math.max(5,ce-5)),className:"w-8 h-8 rounded-full bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center border border-slate-600",children:h.jsx("i",{className:"fas fa-minus"})}),h.jsx("input",{type:"number",value:ce,onChange:P=>S(parseInt(P.target.value)||0),className:"w-20 bg-slate-900 border border-indigo-500 rounded-lg p-2 text-center text-xl font-bold text-white focus:ring-2 focus:ring-indigo-500",min:"1"}),h.jsx("button",{onClick:()=>S(ce+5),className:"w-8 h-8 rounded-full bg-slate-700 hover:bg-slate-600 text-white flex items-center justify-center border border-slate-600",children:h.jsx("i",{className:"fas fa-plus"})})]})]}),h.jsx("div",{className:"text-center bg-indigo-900/30 p-2 rounded-lg border border-indigo-500/30 w-full max-w-lg",children:h.jsxs("p",{className:"text-indigo-300 font-bold text-sm",children:[h.jsx("i",{className:"fas fa-check-circle mr-2"}),"     ."]})}),h.jsxs("button",{onClick:()=>t(ce),disabled:e||o.length===0,className:"bg-indigo-600 hover:bg-indigo-500 text-white text-xl font-bold px-12 py-5 rounded-full shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 w-full max-w-lg justify-center",children:[e?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-magic"}),e?" ...":"   /  "]})]}),V&&h.jsx("div",{className:"fixed inset-0 z-[100] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:()=>K(null),children:h.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] flex flex-col items-center",children:[h.jsx("img",{src:V.url,alt:V.title,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl border border-slate-700",onClick:P=>P.stopPropagation()}),h.jsx("p",{className:"text-white font-bold text-xl mt-4 drop-shadow-md",children:V.title}),h.jsx("button",{onClick:()=>K(null),className:"absolute -top-12 right-0 text-slate-400 hover:text-white transition-colors",children:h.jsx("i",{className:"fas fa-times text-4xl"})})]})}),M&&h.jsx(Lm,{onClose:()=>R(!1)}),F&&h.jsx(e_,{onClose:()=>D(!1)}),h.jsx("div",{ref:$})]})};var Dm={exports:{}};(function(t,e){(function(n,r){r()})(fn,function(){function n(c,f){return typeof f>"u"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function r(c,f,m){var p=new XMLHttpRequest;p.open("GET",c),p.responseType="blob",p.onload=function(){u(p.response,f,m)},p.onerror=function(){console.error("could not download file")},p.send()}function o(c){var f=new XMLHttpRequest;f.open("HEAD",c,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function i(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(f)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof fn=="object"&&fn.global===fn?fn:void 0,a=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,f,m){var p=s.URL||s.webkitURL,g=document.createElement("a");f=f||c.name||"download",g.download=f,g.rel="noopener",typeof c=="string"?(g.href=c,g.origin===location.origin?i(g):o(g.href)?r(c,f,m):i(g,g.target="_blank")):(g.href=p.createObjectURL(c),setTimeout(function(){p.revokeObjectURL(g.href)},4e4),setTimeout(function(){i(g)},0))}:"msSaveOrOpenBlob"in navigator?function(c,f,m){if(f=f||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(n(c,m),f);else if(o(c))r(c,f,m);else{var p=document.createElement("a");p.href=c,p.target="_blank",setTimeout(function(){i(p)})}}:function(c,f,m,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof c=="string")return r(c,f,m);var g=c.type==="application/octet-stream",E=/constructor/i.test(s.HTMLElement)||s.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||g&&E||a)&&typeof FileReader<"u"){var T=new FileReader;T.onloadend=function(){var w=T.result;w=v?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=w:location=w,p=null},T.readAsDataURL(c)}else{var y=s.URL||s.webkitURL,x=y.createObjectURL(c);p?p.location=x:location.href=x,p=null,setTimeout(function(){y.revokeObjectURL(x)},4e4)}});s.saveAs=u.saveAs=u,t.exports=u})})(Dm);var Tl=Dm.exports;function Si(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Om={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,o,i){function s(c,f){if(!o[c]){if(!r[c]){var m=typeof Si=="function"&&Si;if(!f&&m)return m(c,!0);if(a)return a(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var g=o[c]={exports:{}};r[c][0].call(g.exports,function(E){var v=r[c][1][E];return s(v||E)},g,g.exports,n,r,o,i)}return o[c].exports}for(var a=typeof Si=="function"&&Si,u=0;u<i.length;u++)s(i[u]);return s}({1:[function(n,r,o){var i=n("./utils"),s=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(u){for(var c,f,m,p,g,E,v,T=[],y=0,x=u.length,w=x,_=i.getTypeOf(u)!=="string";y<u.length;)w=x-y,m=_?(c=u[y++],f=y<x?u[y++]:0,y<x?u[y++]:0):(c=u.charCodeAt(y++),f=y<x?u.charCodeAt(y++):0,y<x?u.charCodeAt(y++):0),p=c>>2,g=(3&c)<<4|f>>4,E=1<w?(15&f)<<2|m>>6:64,v=2<w?63&m:64,T.push(a.charAt(p)+a.charAt(g)+a.charAt(E)+a.charAt(v));return T.join("")},o.decode=function(u){var c,f,m,p,g,E,v=0,T=0,y="data:";if(u.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var x,w=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===a.charAt(64)&&w--,u.charAt(u.length-2)===a.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=s.uint8array?new Uint8Array(0|w):new Array(0|w);v<u.length;)c=a.indexOf(u.charAt(v++))<<2|(p=a.indexOf(u.charAt(v++)))>>4,f=(15&p)<<4|(g=a.indexOf(u.charAt(v++)))>>2,m=(3&g)<<6|(E=a.indexOf(u.charAt(v++))),x[T++]=c,g!==64&&(x[T++]=f),E!==64&&(x[T++]=m);return x}},{"./support":30,"./utils":32}],2:[function(n,r,o){var i=n("./external"),s=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),u=n("./stream/DataLengthProbe");function c(f,m,p,g,E){this.compressedSize=f,this.uncompressedSize=m,this.crc32=p,this.compression=g,this.compressedContent=E}c.prototype={getContentWorker:function(){var f=new s(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),m=this;return f.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),f},getCompressedWorker:function(){return new s(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(f,m,p){return f.pipe(new a).pipe(new u("uncompressedSize")).pipe(m.compressWorker(p)).pipe(new u("compressedSize")).withStreamInfo("compression",m)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,o){var i=n("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},o.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,o){var i=n("./utils"),s=function(){for(var a,u=[],c=0;c<256;c++){a=c;for(var f=0;f<8;f++)a=1&a?3988292384^a>>>1:a>>>1;u[c]=a}return u}();r.exports=function(a,u){return a!==void 0&&a.length?i.getTypeOf(a)!=="string"?function(c,f,m,p){var g=s,E=p+m;c^=-1;for(var v=p;v<E;v++)c=c>>>8^g[255&(c^f[v])];return-1^c}(0|u,a,a.length,0):function(c,f,m,p){var g=s,E=p+m;c^=-1;for(var v=p;v<E;v++)c=c>>>8^g[255&(c^f.charCodeAt(v))];return-1^c}(0|u,a,a.length,0):0}},{"./utils":32}],5:[function(n,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(n,r,o){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=n("pako"),a=n("./utils"),u=n("./stream/GenericWorker"),c=i?"uint8array":"array";function f(m,p){u.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=p,this.meta={}}o.magic="\b\0",a.inherits(f,u),f.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,m.data),!1)},f.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},f.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},f.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(p){m.push({data:p,meta:m.meta})}},o.compressWorker=function(m){return new f("Deflate",m)},o.uncompressWorker=function(){return new f("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,o){function i(g,E){var v,T="";for(v=0;v<E;v++)T+=String.fromCharCode(255&g),g>>>=8;return T}function s(g,E,v,T,y,x){var w,_,b=g.file,M=g.compression,R=x!==c.utf8encode,F=a.transformTo("string",x(b.name)),D=a.transformTo("string",c.utf8encode(b.name)),V=b.comment,K=a.transformTo("string",x(V)),A=a.transformTo("string",c.utf8encode(V)),z=D.length!==b.name.length,C=A.length!==V.length,q="",ue="",$="",Y=b.dir,L=b.date,Z={crc32:0,compressedSize:0,uncompressedSize:0};E&&!v||(Z.crc32=g.crc32,Z.compressedSize=g.compressedSize,Z.uncompressedSize=g.uncompressedSize);var G=0;E&&(G|=8),R||!z&&!C||(G|=2048);var B=0,me=0;Y&&(B|=16),y==="UNIX"?(me=798,B|=function(re,_e){var Ie=re;return re||(Ie=_e?16893:33204),(65535&Ie)<<16}(b.unixPermissions,Y)):(me=20,B|=function(re){return 63&(re||0)}(b.dosPermissions)),w=L.getUTCHours(),w<<=6,w|=L.getUTCMinutes(),w<<=5,w|=L.getUTCSeconds()/2,_=L.getUTCFullYear()-1980,_<<=4,_|=L.getUTCMonth()+1,_<<=5,_|=L.getUTCDate(),z&&(ue=i(1,1)+i(f(F),4)+D,q+="up"+i(ue.length,2)+ue),C&&($=i(1,1)+i(f(K),4)+A,q+="uc"+i($.length,2)+$);var de="";return de+=`
\0`,de+=i(G,2),de+=M.magic,de+=i(w,2),de+=i(_,2),de+=i(Z.crc32,4),de+=i(Z.compressedSize,4),de+=i(Z.uncompressedSize,4),de+=i(F.length,2),de+=i(q.length,2),{fileRecord:m.LOCAL_FILE_HEADER+de+F+q,dirRecord:m.CENTRAL_FILE_HEADER+i(me,2)+de+i(K.length,2)+"\0\0\0\0"+i(B,4)+i(T,4)+F+q+K}}var a=n("../utils"),u=n("../stream/GenericWorker"),c=n("../utf8"),f=n("../crc32"),m=n("../signature");function p(g,E,v,T){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=E,this.zipPlatform=v,this.encodeFileName=T,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(p,u),p.prototype.push=function(g){var E=g.meta.percent||0,v=this.entriesCount,T=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,u.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:v?(E+100*(v-T-1))/v:100}}))},p.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var E=this.streamFiles&&!g.file.dir;if(E){var v=s(g,E,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(g){this.accumulate=!1;var E=this.streamFiles&&!g.file.dir,v=s(g,E,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),E)this.push({data:function(T){return m.DATA_DESCRIPTOR+i(T.crc32,4)+i(T.compressedSize,4)+i(T.uncompressedSize,4)}(g),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var g=this.bytesWritten,E=0;E<this.dirRecords.length;E++)this.push({data:this.dirRecords[E],meta:{percent:100}});var v=this.bytesWritten-g,T=function(y,x,w,_,b){var M=a.transformTo("string",b(_));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(y,2)+i(y,2)+i(x,4)+i(w,4)+i(M.length,2)+M}(this.dirRecords.length,v,g,this.zipComment,this.encodeFileName);this.push({data:T,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(g){this._sources.push(g);var E=this;return g.on("data",function(v){E.processChunk(v)}),g.on("end",function(){E.closedSource(E.previous.streamInfo),E._sources.length?E.prepareNextSource():E.end()}),g.on("error",function(v){E.error(v)}),this},p.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(g){var E=this._sources;if(!u.prototype.error.call(this,g))return!1;for(var v=0;v<E.length;v++)try{E[v].error(g)}catch{}return!0},p.prototype.lock=function(){u.prototype.lock.call(this);for(var g=this._sources,E=0;E<g.length;E++)g[E].lock()},r.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,o){var i=n("../compressions"),s=n("./ZipFileWorker");o.generateWorker=function(a,u,c){var f=new s(u.streamFiles,c,u.platform,u.encodeFileName),m=0;try{a.forEach(function(p,g){m++;var E=function(x,w){var _=x||w,b=i[_];if(!b)throw new Error(_+" is not a valid compression method !");return b}(g.options.compression,u.compression),v=g.options.compressionOptions||u.compressionOptions||{},T=g.dir,y=g.date;g._compressWorker(E,v).withStreamInfo("file",{name:p,dir:T,date:y,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(f)}),f.entriesCount=m}catch(p){f.error(p)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,o){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new i;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(s,a){return new i().loadAsync(s,a)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,o){var i=n("./utils"),s=n("./external"),a=n("./utf8"),u=n("./zipEntries"),c=n("./stream/Crc32Probe"),f=n("./nodejsUtils");function m(p){return new s.Promise(function(g,E){var v=p.decompressed.getContentWorker().pipe(new c);v.on("error",function(T){E(T)}).on("end",function(){v.streamInfo.crc32!==p.decompressed.crc32?E(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}r.exports=function(p,g){var E=this;return g=i.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),f.isNode&&f.isStream(p)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",p,!0,g.optimizedBinaryString,g.base64).then(function(v){var T=new u(g);return T.load(v),T}).then(function(v){var T=[s.Promise.resolve(v)],y=v.files;if(g.checkCRC32)for(var x=0;x<y.length;x++)T.push(m(y[x]));return s.Promise.all(T)}).then(function(v){for(var T=v.shift(),y=T.files,x=0;x<y.length;x++){var w=y[x],_=w.fileNameStr,b=i.resolve(w.fileNameStr);E.file(b,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:g.createFolders}),w.dir||(E.file(b).unsafeOriginalName=_)}return T.zipComment.length&&(E.comment=T.zipComment),E})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,o){var i=n("../utils"),s=n("../stream/GenericWorker");function a(u,c){s.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(a,s),a.prototype._bindStream=function(u){var c=this;(this._stream=u).pause(),u.on("data",function(f){c.push({data:f,meta:{percent:0}})}).on("error",function(f){c.isPaused?this.generatedError=f:c.error(f)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,o){var i=n("readable-stream").Readable;function s(a,u,c){i.call(this,u),this._helper=a;var f=this;a.on("data",function(m,p){f.push(m)||f._helper.pause(),c&&c(p)}).on("error",function(m){f.emit("error",m)}).on("end",function(){f.push(null)})}n("../utils").inherits(s,i),s.prototype._read=function(){this._helper.resume()},r.exports=s},{"../utils":32,"readable-stream":16}],14:[function(n,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,s);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,s)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var s=new Buffer(i);return s.fill(0),s},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,o){function i(b,M,R){var F,D=a.getTypeOf(M),V=a.extend(R||{},f);V.date=V.date||new Date,V.compression!==null&&(V.compression=V.compression.toUpperCase()),typeof V.unixPermissions=="string"&&(V.unixPermissions=parseInt(V.unixPermissions,8)),V.unixPermissions&&16384&V.unixPermissions&&(V.dir=!0),V.dosPermissions&&16&V.dosPermissions&&(V.dir=!0),V.dir&&(b=y(b)),V.createFolders&&(F=T(b))&&x.call(this,F,!0);var K=D==="string"&&V.binary===!1&&V.base64===!1;R&&R.binary!==void 0||(V.binary=!K),(M instanceof m&&M.uncompressedSize===0||V.dir||!M||M.length===0)&&(V.base64=!1,V.binary=!0,M="",V.compression="STORE",D="string");var A=null;A=M instanceof m||M instanceof u?M:E.isNode&&E.isStream(M)?new v(b,M):a.prepareContent(b,M,V.binary,V.optimizedBinaryString,V.base64);var z=new p(b,A,V);this.files[b]=z}var s=n("./utf8"),a=n("./utils"),u=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),f=n("./defaults"),m=n("./compressedObject"),p=n("./zipObject"),g=n("./generate"),E=n("./nodejsUtils"),v=n("./nodejs/NodejsStreamInputAdapter"),T=function(b){b.slice(-1)==="/"&&(b=b.substring(0,b.length-1));var M=b.lastIndexOf("/");return 0<M?b.substring(0,M):""},y=function(b){return b.slice(-1)!=="/"&&(b+="/"),b},x=function(b,M){return M=M!==void 0?M:f.createFolders,b=y(b),this.files[b]||i.call(this,b,null,{dir:!0,createFolders:M}),this.files[b]};function w(b){return Object.prototype.toString.call(b)==="[object RegExp]"}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(b){var M,R,F;for(M in this.files)F=this.files[M],(R=M.slice(this.root.length,M.length))&&M.slice(0,this.root.length)===this.root&&b(R,F)},filter:function(b){var M=[];return this.forEach(function(R,F){b(R,F)&&M.push(F)}),M},file:function(b,M,R){if(arguments.length!==1)return b=this.root+b,i.call(this,b,M,R),this;if(w(b)){var F=b;return this.filter(function(V,K){return!K.dir&&F.test(V)})}var D=this.files[this.root+b];return D&&!D.dir?D:null},folder:function(b){if(!b)return this;if(w(b))return this.filter(function(D,V){return V.dir&&b.test(D)});var M=this.root+b,R=x.call(this,M),F=this.clone();return F.root=R.name,F},remove:function(b){b=this.root+b;var M=this.files[b];if(M||(b.slice(-1)!=="/"&&(b+="/"),M=this.files[b]),M&&!M.dir)delete this.files[b];else for(var R=this.filter(function(D,V){return V.name.slice(0,b.length)===b}),F=0;F<R.length;F++)delete this.files[R[F].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(b){var M,R={};try{if((R=a.extend(b||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");a.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var F=R.comment||this.comment||"";M=g.generateWorker(this,R,F)}catch(D){(M=new u("error")).error(D)}return new c(M,R.type||"string",R.mimeType)},generateAsync:function(b,M){return this.generateInternalStream(b).accumulate(M)},generateNodeStream:function(b,M){return(b=b||{}).type||(b.type="nodebuffer"),this.generateInternalStream(b).toNodejsStream(M)}};r.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,o){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,o){var i=n("./DataReader");function s(a){i.call(this,a);for(var u=0;u<this.data.length;u++)a[u]=255&a[u]}n("../utils").inherits(s,i),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var u=a.charCodeAt(0),c=a.charCodeAt(1),f=a.charCodeAt(2),m=a.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===u&&this.data[p+1]===c&&this.data[p+2]===f&&this.data[p+3]===m)return p-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var u=a.charCodeAt(0),c=a.charCodeAt(1),f=a.charCodeAt(2),m=a.charCodeAt(3),p=this.readData(4);return u===p[0]&&c===p[1]&&f===p[2]&&m===p[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,u},r.exports=s},{"../utils":32,"./DataReader":18}],18:[function(n,r,o){var i=n("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var u,c=0;for(this.checkOffset(a),u=this.index+a-1;u>=this.index;u--)c=(c<<8)+this.byteAt(u);return this.index+=a,c},readString:function(a){return i.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=s},{"../utils":32}],19:[function(n,r,o){var i=n("./Uint8ArrayReader");function s(a){i.call(this,a)}n("../utils").inherits(s,i),s.prototype.readData=function(a){this.checkOffset(a);var u=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,u},r.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,o){var i=n("./DataReader");function s(a){i.call(this,a)}n("../utils").inherits(s,i),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var u=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,u},r.exports=s},{"../utils":32,"./DataReader":18}],21:[function(n,r,o){var i=n("./ArrayReader");function s(a){i.call(this,a)}n("../utils").inherits(s,i),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,u},r.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,o){var i=n("../utils"),s=n("../support"),a=n("./ArrayReader"),u=n("./StringReader"),c=n("./NodeBufferReader"),f=n("./Uint8ArrayReader");r.exports=function(m){var p=i.getTypeOf(m);return i.checkSupport(p),p!=="string"||s.uint8array?p==="nodebuffer"?new c(m):s.uint8array?new f(i.transformTo("uint8array",m)):new a(i.transformTo("array",m)):new u(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,o){var i=n("./GenericWorker"),s=n("../utils");function a(u){i.call(this,"ConvertWorker to "+u),this.destType=u}s.inherits(a,i),a.prototype.processChunk=function(u){this.push({data:s.transformTo(this.destType,u.data),meta:u.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,o){var i=n("./GenericWorker"),s=n("../crc32");function a(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,i),a.prototype.processChunk=function(u){this.streamInfo.crc32=s(u.data,this.streamInfo.crc32||0),this.push(u)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,o){var i=n("../utils"),s=n("./GenericWorker");function a(u){s.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}i.inherits(a,s),a.prototype.processChunk=function(u){if(u){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+u.data.length}s.prototype.processChunk.call(this,u)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,o){var i=n("../utils"),s=n("./GenericWorker");function a(u){s.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(f){c.dataIsReady=!0,c.data=f,c.max=f&&f.length||0,c.type=i.getTypeOf(f),c.isPaused||c._tickAndRepeat()},function(f){c.error(f)})}i.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,c);break;case"uint8array":u=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":u=this.data.slice(this.index,c)}return this.index=c,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,o){function i(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var u=0;u<this._listeners[s].length;u++)this._listeners[s][u].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(u){a.processChunk(u)}),s.on("end",function(){a.end()}),s.on("error",function(u){a.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},r.exports=i},{}],29:[function(n,r,o){var i=n("../utils"),s=n("./ConvertWorker"),a=n("./GenericWorker"),u=n("../base64"),c=n("../support"),f=n("../external"),m=null;if(c.nodestream)try{m=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(E,v){return new f.Promise(function(T,y){var x=[],w=E._internalType,_=E._outputType,b=E._mimeType;E.on("data",function(M,R){x.push(M),v&&v(R)}).on("error",function(M){x=[],y(M)}).on("end",function(){try{var M=function(R,F,D){switch(R){case"blob":return i.newBlob(i.transformTo("arraybuffer",F),D);case"base64":return u.encode(F);default:return i.transformTo(R,F)}}(_,function(R,F){var D,V=0,K=null,A=0;for(D=0;D<F.length;D++)A+=F[D].length;switch(R){case"string":return F.join("");case"array":return Array.prototype.concat.apply([],F);case"uint8array":for(K=new Uint8Array(A),D=0;D<F.length;D++)K.set(F[D],V),V+=F[D].length;return K;case"nodebuffer":return Buffer.concat(F);default:throw new Error("concat : unsupported type '"+R+"'")}}(w,x),b);T(M)}catch(R){y(R)}x=[]}).resume()})}function g(E,v,T){var y=v;switch(v){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=v,this._mimeType=T,i.checkSupport(y),this._worker=E.pipe(new s(y)),E.lock()}catch(x){this._worker=new a("error"),this._worker.error(x)}}g.prototype={accumulate:function(E){return p(this,E)},on:function(E,v){var T=this;return E==="data"?this._worker.on(E,function(y){v.call(T,y.data,y.meta)}):this._worker.on(E,function(){i.delay(v,arguments,T)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(E){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},E)}},r.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var i=new ArrayBuffer(0);try{o.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(i),o.blob=s.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!n("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,o){for(var i=n("./utils"),s=n("./support"),a=n("./nodejsUtils"),u=n("./stream/GenericWorker"),c=new Array(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;c[254]=c[254]=1;function m(){u.call(this,"utf-8 decode"),this.leftOver=null}function p(){u.call(this,"utf-8 encode")}o.utf8encode=function(g){return s.nodebuffer?a.newBufferFrom(g,"utf-8"):function(E){var v,T,y,x,w,_=E.length,b=0;for(x=0;x<_;x++)(64512&(T=E.charCodeAt(x)))==55296&&x+1<_&&(64512&(y=E.charCodeAt(x+1)))==56320&&(T=65536+(T-55296<<10)+(y-56320),x++),b+=T<128?1:T<2048?2:T<65536?3:4;for(v=s.uint8array?new Uint8Array(b):new Array(b),x=w=0;w<b;x++)(64512&(T=E.charCodeAt(x)))==55296&&x+1<_&&(64512&(y=E.charCodeAt(x+1)))==56320&&(T=65536+(T-55296<<10)+(y-56320),x++),T<128?v[w++]=T:(T<2048?v[w++]=192|T>>>6:(T<65536?v[w++]=224|T>>>12:(v[w++]=240|T>>>18,v[w++]=128|T>>>12&63),v[w++]=128|T>>>6&63),v[w++]=128|63&T);return v}(g)},o.utf8decode=function(g){return s.nodebuffer?i.transformTo("nodebuffer",g).toString("utf-8"):function(E){var v,T,y,x,w=E.length,_=new Array(2*w);for(v=T=0;v<w;)if((y=E[v++])<128)_[T++]=y;else if(4<(x=c[y]))_[T++]=65533,v+=x-1;else{for(y&=x===2?31:x===3?15:7;1<x&&v<w;)y=y<<6|63&E[v++],x--;1<x?_[T++]=65533:y<65536?_[T++]=y:(y-=65536,_[T++]=55296|y>>10&1023,_[T++]=56320|1023&y)}return _.length!==T&&(_.subarray?_=_.subarray(0,T):_.length=T),i.applyFromCharCode(_)}(g=i.transformTo(s.uint8array?"uint8array":"array",g))},i.inherits(m,u),m.prototype.processChunk=function(g){var E=i.transformTo(s.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var v=E;(E=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),E.set(v,this.leftOver.length)}else E=this.leftOver.concat(E);this.leftOver=null}var T=function(x,w){var _;for((w=w||x.length)>x.length&&(w=x.length),_=w-1;0<=_&&(192&x[_])==128;)_--;return _<0||_===0?w:_+c[x[_]]>w?_:w}(E),y=E;T!==E.length&&(s.uint8array?(y=E.subarray(0,T),this.leftOver=E.subarray(T,E.length)):(y=E.slice(0,T),this.leftOver=E.slice(T,E.length))),this.push({data:o.utf8decode(y),meta:g.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=m,i.inherits(p,u),p.prototype.processChunk=function(g){this.push({data:o.utf8encode(g.data),meta:g.meta})},o.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,o){var i=n("./support"),s=n("./base64"),a=n("./nodejsUtils"),u=n("./external");function c(v){return v}function f(v,T){for(var y=0;y<v.length;++y)T[y]=255&v.charCodeAt(y);return T}n("setimmediate"),o.newBlob=function(v,T){o.checkSupport("blob");try{return new Blob([v],{type:T})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(v),y.getBlob(T)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(v,T,y){var x=[],w=0,_=v.length;if(_<=y)return String.fromCharCode.apply(null,v);for(;w<_;)T==="array"||T==="nodebuffer"?x.push(String.fromCharCode.apply(null,v.slice(w,Math.min(w+y,_)))):x.push(String.fromCharCode.apply(null,v.subarray(w,Math.min(w+y,_)))),w+=y;return x.join("")},stringifyByChar:function(v){for(var T="",y=0;y<v.length;y++)T+=String.fromCharCode(v[y]);return T},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function p(v){var T=65536,y=o.getTypeOf(v),x=!0;if(y==="uint8array"?x=m.applyCanBeUsed.uint8array:y==="nodebuffer"&&(x=m.applyCanBeUsed.nodebuffer),x)for(;1<T;)try{return m.stringifyByChunk(v,y,T)}catch{T=Math.floor(T/2)}return m.stringifyByChar(v)}function g(v,T){for(var y=0;y<v.length;y++)T[y]=v[y];return T}o.applyFromCharCode=p;var E={};E.string={string:c,array:function(v){return f(v,new Array(v.length))},arraybuffer:function(v){return E.string.uint8array(v).buffer},uint8array:function(v){return f(v,new Uint8Array(v.length))},nodebuffer:function(v){return f(v,a.allocBuffer(v.length))}},E.array={string:p,array:c,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return a.newBufferFrom(v)}},E.arraybuffer={string:function(v){return p(new Uint8Array(v))},array:function(v){return g(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:c,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return a.newBufferFrom(new Uint8Array(v))}},E.uint8array={string:p,array:function(v){return g(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:c,nodebuffer:function(v){return a.newBufferFrom(v)}},E.nodebuffer={string:p,array:function(v){return g(v,new Array(v.length))},arraybuffer:function(v){return E.nodebuffer.uint8array(v).buffer},uint8array:function(v){return g(v,new Uint8Array(v.length))},nodebuffer:c},o.transformTo=function(v,T){if(T=T||"",!v)return T;o.checkSupport(v);var y=o.getTypeOf(T);return E[y][v](T)},o.resolve=function(v){for(var T=v.split("/"),y=[],x=0;x<T.length;x++){var w=T[x];w==="."||w===""&&x!==0&&x!==T.length-1||(w===".."?y.pop():y.push(w))}return y.join("/")},o.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":i.nodebuffer&&a.isBuffer(v)?"nodebuffer":i.uint8array&&v instanceof Uint8Array?"uint8array":i.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(v){if(!i[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(v){var T,y,x="";for(y=0;y<(v||"").length;y++)x+="\\x"+((T=v.charCodeAt(y))<16?"0":"")+T.toString(16).toUpperCase();return x},o.delay=function(v,T,y){setImmediate(function(){v.apply(y||null,T||[])})},o.inherits=function(v,T){function y(){}y.prototype=T.prototype,v.prototype=new y},o.extend=function(){var v,T,y={};for(v=0;v<arguments.length;v++)for(T in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],T)&&y[T]===void 0&&(y[T]=arguments[v][T]);return y},o.prepareContent=function(v,T,y,x,w){return u.Promise.resolve(T).then(function(_){return i.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader<"u"?new u.Promise(function(b,M){var R=new FileReader;R.onload=function(F){b(F.target.result)},R.onerror=function(F){M(F.target.error)},R.readAsArrayBuffer(_)}):_}).then(function(_){var b=o.getTypeOf(_);return b?(b==="arraybuffer"?_=o.transformTo("uint8array",_):b==="string"&&(w?_=s.decode(_):y&&x!==!0&&(_=function(M){return f(M,i.uint8array?new Uint8Array(M.length):new Array(M.length))}(_))),_):u.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,o){var i=n("./reader/readerFor"),s=n("./utils"),a=n("./signature"),u=n("./zipEntry"),c=n("./support");function f(m){this.files=[],this.loadOptions=m}f.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(p)+", expected "+s.pretty(m)+")")}},isSignature:function(m,p){var g=this.reader.index;this.reader.setIndex(m);var E=this.reader.readString(4)===p;return this.reader.setIndex(g),E},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),p=c.uint8array?"uint8array":"array",g=s.transformTo(p,m);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,p,g,E=this.zip64EndOfCentralSize-44;0<E;)m=this.reader.readInt(2),p=this.reader.readInt(4),g=this.reader.readData(p),this.zip64ExtensibleData[m]={id:m,length:p,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,p;for(m=0;m<this.files.length;m++)p=this.files[m],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(m=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var p=m;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var E=p-g;if(0<E)this.isSignature(p,a.CENTRAL_FILE_HEADER)||(this.reader.zero=E);else if(E<0)throw new Error("Corrupted zip: missing "+Math.abs(E)+" bytes.")},prepareReader:function(m){this.reader=i(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=f},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,o){var i=n("./reader/readerFor"),s=n("./utils"),a=n("./compressedObject"),u=n("./crc32"),c=n("./utf8"),f=n("./compressions"),m=n("./support");function p(g,E){this.options=g,this.loadOptions=E}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var E,v;if(g.skip(22),this.fileNameLength=g.readInt(2),v=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((E=function(T){for(var y in f)if(Object.prototype.hasOwnProperty.call(f,y)&&f[y].magic===T)return f[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,E,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var E=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(E),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var E,v,T,y=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<y;)E=g.readInt(2),v=g.readInt(2),T=g.readData(v),this.extraFields[E]={id:E,length:v,value:T};g.setIndex(y)},handleUTF8:function(){var g=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var E=this.findExtraFieldUnicodePath();if(E!==null)this.fileNameStr=E;else{var v=s.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var T=this.findExtraFieldUnicodeComment();if(T!==null)this.fileCommentStr=T;else{var y=s.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var E=i(g.value);return E.readInt(1)!==1||u(this.fileName)!==E.readInt(4)?null:c.utf8decode(E.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var E=i(g.value);return E.readInt(1)!==1||u(this.fileComment)!==E.readInt(4)?null:c.utf8decode(E.readData(g.length-5))}return null}},r.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,o){function i(E,v,T){this.name=E,this.dir=T.dir,this.date=T.date,this.comment=T.comment,this.unixPermissions=T.unixPermissions,this.dosPermissions=T.dosPermissions,this._data=v,this._dataBinary=T.binary,this.options={compression:T.compression,compressionOptions:T.compressionOptions}}var s=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),u=n("./utf8"),c=n("./compressedObject"),f=n("./stream/GenericWorker");i.prototype={internalStream:function(E){var v=null,T="string";try{if(!E)throw new Error("No output type specified.");var y=(T=E.toLowerCase())==="string"||T==="text";T!=="binarystring"&&T!=="text"||(T="string"),v=this._decompressWorker();var x=!this._dataBinary;x&&!y&&(v=v.pipe(new u.Utf8EncodeWorker)),!x&&y&&(v=v.pipe(new u.Utf8DecodeWorker))}catch(w){(v=new f("error")).error(w)}return new s(v,T,"")},async:function(E,v){return this.internalStream(E).accumulate(v)},nodeStream:function(E,v){return this.internalStream(E||"nodebuffer").toNodejsStream(v)},_compressWorker:function(E,v){if(this._data instanceof c&&this._data.compression.magic===E.magic)return this._data.getCompressedWorker();var T=this._decompressWorker();return this._dataBinary||(T=T.pipe(new u.Utf8EncodeWorker)),c.createWorkerFrom(T,E,v)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof f?this._data:new a(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<m.length;g++)i.prototype[m[g]]=p;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,o){(function(i){var s,a,u=i.MutationObserver||i.WebKitMutationObserver;if(u){var c=0,f=new u(E),m=i.document.createTextNode("");f.observe(m,{characterData:!0}),s=function(){m.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)s="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var v=i.document.createElement("script");v.onreadystatechange=function(){E(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},i.document.documentElement.appendChild(v)}:function(){setTimeout(E,0)};else{var p=new i.MessageChannel;p.port1.onmessage=E,s=function(){p.port2.postMessage(0)}}var g=[];function E(){var v,T;a=!0;for(var y=g.length;y;){for(T=g,g=[],v=-1;++v<y;)T[v]();y=g.length}a=!1}r.exports=function(v){g.push(v)!==1||a||s()}}).call(this,typeof fn<"u"?fn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,o){var i=n("immediate");function s(){}var a={},u=["REJECTED"],c=["FULFILLED"],f=["PENDING"];function m(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,y!==s&&v(this,y)}function p(y,x,w){this.promise=y,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function g(y,x,w){i(function(){var _;try{_=x(w)}catch(b){return a.reject(y,b)}_===y?a.reject(y,new TypeError("Cannot resolve promise with itself")):a.resolve(y,_)})}function E(y){var x=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof x=="function")return function(){x.apply(y,arguments)}}function v(y,x){var w=!1;function _(R){w||(w=!0,a.reject(y,R))}function b(R){w||(w=!0,a.resolve(y,R))}var M=T(function(){x(b,_)});M.status==="error"&&_(M.value)}function T(y,x){var w={};try{w.value=y(x),w.status="success"}catch(_){w.status="error",w.value=_}return w}(r.exports=m).prototype.finally=function(y){if(typeof y!="function")return this;var x=this.constructor;return this.then(function(w){return x.resolve(y()).then(function(){return w})},function(w){return x.resolve(y()).then(function(){throw w})})},m.prototype.catch=function(y){return this.then(null,y)},m.prototype.then=function(y,x){if(typeof y!="function"&&this.state===c||typeof x!="function"&&this.state===u)return this;var w=new this.constructor(s);return this.state!==f?g(w,this.state===c?y:x,this.outcome):this.queue.push(new p(w,y,x)),w},p.prototype.callFulfilled=function(y){a.resolve(this.promise,y)},p.prototype.otherCallFulfilled=function(y){g(this.promise,this.onFulfilled,y)},p.prototype.callRejected=function(y){a.reject(this.promise,y)},p.prototype.otherCallRejected=function(y){g(this.promise,this.onRejected,y)},a.resolve=function(y,x){var w=T(E,x);if(w.status==="error")return a.reject(y,w.value);var _=w.value;if(_)v(y,_);else{y.state=c,y.outcome=x;for(var b=-1,M=y.queue.length;++b<M;)y.queue[b].callFulfilled(x)}return y},a.reject=function(y,x){y.state=u,y.outcome=x;for(var w=-1,_=y.queue.length;++w<_;)y.queue[w].callRejected(x);return y},m.resolve=function(y){return y instanceof this?y:a.resolve(new this(s),y)},m.reject=function(y){var x=new this(s);return a.reject(x,y)},m.all=function(y){var x=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=y.length,_=!1;if(!w)return this.resolve([]);for(var b=new Array(w),M=0,R=-1,F=new this(s);++R<w;)D(y[R],R);return F;function D(V,K){x.resolve(V).then(function(A){b[K]=A,++M!==w||_||(_=!0,a.resolve(F,b))},function(A){_||(_=!0,a.reject(F,A))})}},m.race=function(y){var x=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=y.length,_=!1;if(!w)return this.resolve([]);for(var b=-1,M=new this(s);++b<w;)R=y[b],x.resolve(R).then(function(F){_||(_=!0,a.resolve(M,F))},function(F){_||(_=!0,a.reject(M,F))});var R;return M}},{immediate:36}],38:[function(n,r,o){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,o){var i=n("./zlib/deflate"),s=n("./utils/common"),a=n("./utils/strings"),u=n("./zlib/messages"),c=n("./zlib/zstream"),f=Object.prototype.toString,m=0,p=-1,g=0,E=8;function v(y){if(!(this instanceof v))return new v(y);this.options=s.assign({level:p,method:E,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},y||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var w=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(w!==m)throw new Error(u[w]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var _;if(_=typeof x.dictionary=="string"?a.string2buf(x.dictionary):f.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(w=i.deflateSetDictionary(this.strm,_))!==m)throw new Error(u[w]);this._dict_set=!0}}function T(y,x){var w=new v(x);if(w.push(y,!0),w.err)throw w.msg||u[w.err];return w.result}v.prototype.push=function(y,x){var w,_,b=this.strm,M=this.options.chunkSize;if(this.ended)return!1;_=x===~~x?x:x===!0?4:0,typeof y=="string"?b.input=a.string2buf(y):f.call(y)==="[object ArrayBuffer]"?b.input=new Uint8Array(y):b.input=y,b.next_in=0,b.avail_in=b.input.length;do{if(b.avail_out===0&&(b.output=new s.Buf8(M),b.next_out=0,b.avail_out=M),(w=i.deflate(b,_))!==1&&w!==m)return this.onEnd(w),!(this.ended=!0);b.avail_out!==0&&(b.avail_in!==0||_!==4&&_!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(b.output,b.next_out))):this.onData(s.shrinkBuf(b.output,b.next_out)))}while((0<b.avail_in||b.avail_out===0)&&w!==1);return _===4?(w=i.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===m):_!==2||(this.onEnd(m),!(b.avail_out=0))},v.prototype.onData=function(y){this.chunks.push(y)},v.prototype.onEnd=function(y){y===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},o.Deflate=v,o.deflate=T,o.deflateRaw=function(y,x){return(x=x||{}).raw=!0,T(y,x)},o.gzip=function(y,x){return(x=x||{}).gzip=!0,T(y,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,o){var i=n("./zlib/inflate"),s=n("./utils/common"),a=n("./utils/strings"),u=n("./zlib/constants"),c=n("./zlib/messages"),f=n("./zlib/zstream"),m=n("./zlib/gzheader"),p=Object.prototype.toString;function g(v){if(!(this instanceof g))return new g(v);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},v||{});var T=this.options;T.raw&&0<=T.windowBits&&T.windowBits<16&&(T.windowBits=-T.windowBits,T.windowBits===0&&(T.windowBits=-15)),!(0<=T.windowBits&&T.windowBits<16)||v&&v.windowBits||(T.windowBits+=32),15<T.windowBits&&T.windowBits<48&&!(15&T.windowBits)&&(T.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var y=i.inflateInit2(this.strm,T.windowBits);if(y!==u.Z_OK)throw new Error(c[y]);this.header=new m,i.inflateGetHeader(this.strm,this.header)}function E(v,T){var y=new g(T);if(y.push(v,!0),y.err)throw y.msg||c[y.err];return y.result}g.prototype.push=function(v,T){var y,x,w,_,b,M,R=this.strm,F=this.options.chunkSize,D=this.options.dictionary,V=!1;if(this.ended)return!1;x=T===~~T?T:T===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof v=="string"?R.input=a.binstring2buf(v):p.call(v)==="[object ArrayBuffer]"?R.input=new Uint8Array(v):R.input=v,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new s.Buf8(F),R.next_out=0,R.avail_out=F),(y=i.inflate(R,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&D&&(M=typeof D=="string"?a.string2buf(D):p.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,y=i.inflateSetDictionary(this.strm,M)),y===u.Z_BUF_ERROR&&V===!0&&(y=u.Z_OK,V=!1),y!==u.Z_STREAM_END&&y!==u.Z_OK)return this.onEnd(y),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&y!==u.Z_STREAM_END&&(R.avail_in!==0||x!==u.Z_FINISH&&x!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=a.utf8border(R.output,R.next_out),_=R.next_out-w,b=a.buf2string(R.output,w),R.next_out=_,R.avail_out=F-_,_&&s.arraySet(R.output,R.output,w,_,0),this.onData(b)):this.onData(s.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(V=!0)}while((0<R.avail_in||R.avail_out===0)&&y!==u.Z_STREAM_END);return y===u.Z_STREAM_END&&(x=u.Z_FINISH),x===u.Z_FINISH?(y=i.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===u.Z_OK):x!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(R.avail_out=0))},g.prototype.onData=function(v){this.chunks.push(v)},g.prototype.onEnd=function(v){v===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},o.Inflate=g,o.inflate=E,o.inflateRaw=function(v,T){return(T=T||{}).raw=!0,E(v,T)},o.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,o){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(u){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var f=c.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var m in f)f.hasOwnProperty(m)&&(u[m]=f[m])}}return u},o.shrinkBuf=function(u,c){return u.length===c?u:u.subarray?u.subarray(0,c):(u.length=c,u)};var s={arraySet:function(u,c,f,m,p){if(c.subarray&&u.subarray)u.set(c.subarray(f,f+m),p);else for(var g=0;g<m;g++)u[p+g]=c[f+g]},flattenChunks:function(u){var c,f,m,p,g,E;for(c=m=0,f=u.length;c<f;c++)m+=u[c].length;for(E=new Uint8Array(m),c=p=0,f=u.length;c<f;c++)g=u[c],E.set(g,p),p+=g.length;return E}},a={arraySet:function(u,c,f,m,p){for(var g=0;g<m;g++)u[p+g]=c[f+g]},flattenChunks:function(u){return[].concat.apply([],u)}};o.setTyped=function(u){u?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,s)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,a))},o.setTyped(i)},{}],42:[function(n,r,o){var i=n("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var u=new i.Buf8(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function f(m,p){if(p<65537&&(m.subarray&&a||!m.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(m,p));for(var g="",E=0;E<p;E++)g+=String.fromCharCode(m[E]);return g}u[254]=u[254]=1,o.string2buf=function(m){var p,g,E,v,T,y=m.length,x=0;for(v=0;v<y;v++)(64512&(g=m.charCodeAt(v)))==55296&&v+1<y&&(64512&(E=m.charCodeAt(v+1)))==56320&&(g=65536+(g-55296<<10)+(E-56320),v++),x+=g<128?1:g<2048?2:g<65536?3:4;for(p=new i.Buf8(x),v=T=0;T<x;v++)(64512&(g=m.charCodeAt(v)))==55296&&v+1<y&&(64512&(E=m.charCodeAt(v+1)))==56320&&(g=65536+(g-55296<<10)+(E-56320),v++),g<128?p[T++]=g:(g<2048?p[T++]=192|g>>>6:(g<65536?p[T++]=224|g>>>12:(p[T++]=240|g>>>18,p[T++]=128|g>>>12&63),p[T++]=128|g>>>6&63),p[T++]=128|63&g);return p},o.buf2binstring=function(m){return f(m,m.length)},o.binstring2buf=function(m){for(var p=new i.Buf8(m.length),g=0,E=p.length;g<E;g++)p[g]=m.charCodeAt(g);return p},o.buf2string=function(m,p){var g,E,v,T,y=p||m.length,x=new Array(2*y);for(g=E=0;g<y;)if((v=m[g++])<128)x[E++]=v;else if(4<(T=u[v]))x[E++]=65533,g+=T-1;else{for(v&=T===2?31:T===3?15:7;1<T&&g<y;)v=v<<6|63&m[g++],T--;1<T?x[E++]=65533:v<65536?x[E++]=v:(v-=65536,x[E++]=55296|v>>10&1023,x[E++]=56320|1023&v)}return f(x,E)},o.utf8border=function(m,p){var g;for((p=p||m.length)>m.length&&(p=m.length),g=p-1;0<=g&&(192&m[g])==128;)g--;return g<0||g===0?p:g+u[m[g]]>p?g:p}},{"./common":41}],43:[function(n,r,o){r.exports=function(i,s,a,u){for(var c=65535&i|0,f=i>>>16&65535|0,m=0;a!==0;){for(a-=m=2e3<a?2e3:a;f=f+(c=c+s[u++]|0)|0,--m;);c%=65521,f%=65521}return c|f<<16|0}},{}],44:[function(n,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,o){var i=function(){for(var s,a=[],u=0;u<256;u++){s=u;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;a[u]=s}return a}();r.exports=function(s,a,u,c){var f=i,m=c+u;s^=-1;for(var p=c;p<m;p++)s=s>>>8^f[255&(s^a[p])];return-1^s}},{}],46:[function(n,r,o){var i,s=n("../utils/common"),a=n("./trees"),u=n("./adler32"),c=n("./crc32"),f=n("./messages"),m=0,p=4,g=0,E=-2,v=-1,T=4,y=2,x=8,w=9,_=286,b=30,M=19,R=2*_+1,F=15,D=3,V=258,K=V+D+1,A=42,z=113,C=1,q=2,ue=3,$=4;function Y(S,P){return S.msg=f[P],P}function L(S){return(S<<1)-(4<S?9:0)}function Z(S){for(var P=S.length;0<=--P;)S[P]=0}function G(S){var P=S.state,k=P.pending;k>S.avail_out&&(k=S.avail_out),k!==0&&(s.arraySet(S.output,P.pending_buf,P.pending_out,k,S.next_out),S.next_out+=k,P.pending_out+=k,S.total_out+=k,S.avail_out-=k,P.pending-=k,P.pending===0&&(P.pending_out=0))}function B(S,P){a._tr_flush_block(S,0<=S.block_start?S.block_start:-1,S.strstart-S.block_start,P),S.block_start=S.strstart,G(S.strm)}function me(S,P){S.pending_buf[S.pending++]=P}function de(S,P){S.pending_buf[S.pending++]=P>>>8&255,S.pending_buf[S.pending++]=255&P}function re(S,P){var k,I,N=S.max_chain_length,U=S.strstart,X=S.prev_length,W=S.nice_match,H=S.strstart>S.w_size-K?S.strstart-(S.w_size-K):0,oe=S.window,he=S.w_mask,ie=S.prev,Ee=S.strstart+V,Ne=oe[U+X-1],we=oe[U+X];S.prev_length>=S.good_match&&(N>>=2),W>S.lookahead&&(W=S.lookahead);do if(oe[(k=P)+X]===we&&oe[k+X-1]===Ne&&oe[k]===oe[U]&&oe[++k]===oe[U+1]){U+=2,k++;do;while(oe[++U]===oe[++k]&&oe[++U]===oe[++k]&&oe[++U]===oe[++k]&&oe[++U]===oe[++k]&&oe[++U]===oe[++k]&&oe[++U]===oe[++k]&&oe[++U]===oe[++k]&&oe[++U]===oe[++k]&&U<Ee);if(I=V-(Ee-U),U=Ee-V,X<I){if(S.match_start=P,W<=(X=I))break;Ne=oe[U+X-1],we=oe[U+X]}}while((P=ie[P&he])>H&&--N!=0);return X<=S.lookahead?X:S.lookahead}function _e(S){var P,k,I,N,U,X,W,H,oe,he,ie=S.w_size;do{if(N=S.window_size-S.lookahead-S.strstart,S.strstart>=ie+(ie-K)){for(s.arraySet(S.window,S.window,ie,ie,0),S.match_start-=ie,S.strstart-=ie,S.block_start-=ie,P=k=S.hash_size;I=S.head[--P],S.head[P]=ie<=I?I-ie:0,--k;);for(P=k=ie;I=S.prev[--P],S.prev[P]=ie<=I?I-ie:0,--k;);N+=ie}if(S.strm.avail_in===0)break;if(X=S.strm,W=S.window,H=S.strstart+S.lookahead,oe=N,he=void 0,he=X.avail_in,oe<he&&(he=oe),k=he===0?0:(X.avail_in-=he,s.arraySet(W,X.input,X.next_in,he,H),X.state.wrap===1?X.adler=u(X.adler,W,he,H):X.state.wrap===2&&(X.adler=c(X.adler,W,he,H)),X.next_in+=he,X.total_in+=he,he),S.lookahead+=k,S.lookahead+S.insert>=D)for(U=S.strstart-S.insert,S.ins_h=S.window[U],S.ins_h=(S.ins_h<<S.hash_shift^S.window[U+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[U+D-1])&S.hash_mask,S.prev[U&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=U,U++,S.insert--,!(S.lookahead+S.insert<D)););}while(S.lookahead<K&&S.strm.avail_in!==0)}function Ie(S,P){for(var k,I;;){if(S.lookahead<K){if(_e(S),S.lookahead<K&&P===m)return C;if(S.lookahead===0)break}if(k=0,S.lookahead>=D&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+D-1])&S.hash_mask,k=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),k!==0&&S.strstart-k<=S.w_size-K&&(S.match_length=re(S,k)),S.match_length>=D)if(I=a._tr_tally(S,S.strstart-S.match_start,S.match_length-D),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=D){for(S.match_length--;S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+D-1])&S.hash_mask,k=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart,--S.match_length!=0;);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else I=a._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(I&&(B(S,!1),S.strm.avail_out===0))return C}return S.insert=S.strstart<D-1?S.strstart:D-1,P===p?(B(S,!0),S.strm.avail_out===0?ue:$):S.last_lit&&(B(S,!1),S.strm.avail_out===0)?C:q}function ve(S,P){for(var k,I,N;;){if(S.lookahead<K){if(_e(S),S.lookahead<K&&P===m)return C;if(S.lookahead===0)break}if(k=0,S.lookahead>=D&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+D-1])&S.hash_mask,k=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=D-1,k!==0&&S.prev_length<S.max_lazy_match&&S.strstart-k<=S.w_size-K&&(S.match_length=re(S,k),S.match_length<=5&&(S.strategy===1||S.match_length===D&&4096<S.strstart-S.match_start)&&(S.match_length=D-1)),S.prev_length>=D&&S.match_length<=S.prev_length){for(N=S.strstart+S.lookahead-D,I=a._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-D),S.lookahead-=S.prev_length-1,S.prev_length-=2;++S.strstart<=N&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+D-1])&S.hash_mask,k=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),--S.prev_length!=0;);if(S.match_available=0,S.match_length=D-1,S.strstart++,I&&(B(S,!1),S.strm.avail_out===0))return C}else if(S.match_available){if((I=a._tr_tally(S,0,S.window[S.strstart-1]))&&B(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return C}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(I=a._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<D-1?S.strstart:D-1,P===p?(B(S,!0),S.strm.avail_out===0?ue:$):S.last_lit&&(B(S,!1),S.strm.avail_out===0)?C:q}function ee(S,P,k,I,N){this.good_length=S,this.max_lazy=P,this.nice_length=k,this.max_chain=I,this.func=N}function le(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*R),this.dyn_dtree=new s.Buf16(2*(2*b+1)),this.bl_tree=new s.Buf16(2*(2*M+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(F+1),this.heap=new s.Buf16(2*_+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*_+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function te(S){var P;return S&&S.state?(S.total_in=S.total_out=0,S.data_type=y,(P=S.state).pending=0,P.pending_out=0,P.wrap<0&&(P.wrap=-P.wrap),P.status=P.wrap?A:z,S.adler=P.wrap===2?0:1,P.last_flush=m,a._tr_init(P),g):Y(S,E)}function xe(S){var P=te(S);return P===g&&function(k){k.window_size=2*k.w_size,Z(k.head),k.max_lazy_match=i[k.level].max_lazy,k.good_match=i[k.level].good_length,k.nice_match=i[k.level].nice_length,k.max_chain_length=i[k.level].max_chain,k.strstart=0,k.block_start=0,k.lookahead=0,k.insert=0,k.match_length=k.prev_length=D-1,k.match_available=0,k.ins_h=0}(S.state),P}function ce(S,P,k,I,N,U){if(!S)return E;var X=1;if(P===v&&(P=6),I<0?(X=0,I=-I):15<I&&(X=2,I-=16),N<1||w<N||k!==x||I<8||15<I||P<0||9<P||U<0||T<U)return Y(S,E);I===8&&(I=9);var W=new le;return(S.state=W).strm=S,W.wrap=X,W.gzhead=null,W.w_bits=I,W.w_size=1<<W.w_bits,W.w_mask=W.w_size-1,W.hash_bits=N+7,W.hash_size=1<<W.hash_bits,W.hash_mask=W.hash_size-1,W.hash_shift=~~((W.hash_bits+D-1)/D),W.window=new s.Buf8(2*W.w_size),W.head=new s.Buf16(W.hash_size),W.prev=new s.Buf16(W.w_size),W.lit_bufsize=1<<N+6,W.pending_buf_size=4*W.lit_bufsize,W.pending_buf=new s.Buf8(W.pending_buf_size),W.d_buf=1*W.lit_bufsize,W.l_buf=3*W.lit_bufsize,W.level=P,W.strategy=U,W.method=k,xe(S)}i=[new ee(0,0,0,0,function(S,P){var k=65535;for(k>S.pending_buf_size-5&&(k=S.pending_buf_size-5);;){if(S.lookahead<=1){if(_e(S),S.lookahead===0&&P===m)return C;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var I=S.block_start+k;if((S.strstart===0||S.strstart>=I)&&(S.lookahead=S.strstart-I,S.strstart=I,B(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-K&&(B(S,!1),S.strm.avail_out===0))return C}return S.insert=0,P===p?(B(S,!0),S.strm.avail_out===0?ue:$):(S.strstart>S.block_start&&(B(S,!1),S.strm.avail_out),C)}),new ee(4,4,8,4,Ie),new ee(4,5,16,8,Ie),new ee(4,6,32,32,Ie),new ee(4,4,16,16,ve),new ee(8,16,32,32,ve),new ee(8,16,128,128,ve),new ee(8,32,128,256,ve),new ee(32,128,258,1024,ve),new ee(32,258,258,4096,ve)],o.deflateInit=function(S,P){return ce(S,P,x,15,8,0)},o.deflateInit2=ce,o.deflateReset=xe,o.deflateResetKeep=te,o.deflateSetHeader=function(S,P){return S&&S.state?S.state.wrap!==2?E:(S.state.gzhead=P,g):E},o.deflate=function(S,P){var k,I,N,U;if(!S||!S.state||5<P||P<0)return S?Y(S,E):E;if(I=S.state,!S.output||!S.input&&S.avail_in!==0||I.status===666&&P!==p)return Y(S,S.avail_out===0?-5:E);if(I.strm=S,k=I.last_flush,I.last_flush=P,I.status===A)if(I.wrap===2)S.adler=0,me(I,31),me(I,139),me(I,8),I.gzhead?(me(I,(I.gzhead.text?1:0)+(I.gzhead.hcrc?2:0)+(I.gzhead.extra?4:0)+(I.gzhead.name?8:0)+(I.gzhead.comment?16:0)),me(I,255&I.gzhead.time),me(I,I.gzhead.time>>8&255),me(I,I.gzhead.time>>16&255),me(I,I.gzhead.time>>24&255),me(I,I.level===9?2:2<=I.strategy||I.level<2?4:0),me(I,255&I.gzhead.os),I.gzhead.extra&&I.gzhead.extra.length&&(me(I,255&I.gzhead.extra.length),me(I,I.gzhead.extra.length>>8&255)),I.gzhead.hcrc&&(S.adler=c(S.adler,I.pending_buf,I.pending,0)),I.gzindex=0,I.status=69):(me(I,0),me(I,0),me(I,0),me(I,0),me(I,0),me(I,I.level===9?2:2<=I.strategy||I.level<2?4:0),me(I,3),I.status=z);else{var X=x+(I.w_bits-8<<4)<<8;X|=(2<=I.strategy||I.level<2?0:I.level<6?1:I.level===6?2:3)<<6,I.strstart!==0&&(X|=32),X+=31-X%31,I.status=z,de(I,X),I.strstart!==0&&(de(I,S.adler>>>16),de(I,65535&S.adler)),S.adler=1}if(I.status===69)if(I.gzhead.extra){for(N=I.pending;I.gzindex<(65535&I.gzhead.extra.length)&&(I.pending!==I.pending_buf_size||(I.gzhead.hcrc&&I.pending>N&&(S.adler=c(S.adler,I.pending_buf,I.pending-N,N)),G(S),N=I.pending,I.pending!==I.pending_buf_size));)me(I,255&I.gzhead.extra[I.gzindex]),I.gzindex++;I.gzhead.hcrc&&I.pending>N&&(S.adler=c(S.adler,I.pending_buf,I.pending-N,N)),I.gzindex===I.gzhead.extra.length&&(I.gzindex=0,I.status=73)}else I.status=73;if(I.status===73)if(I.gzhead.name){N=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>N&&(S.adler=c(S.adler,I.pending_buf,I.pending-N,N)),G(S),N=I.pending,I.pending===I.pending_buf_size)){U=1;break}U=I.gzindex<I.gzhead.name.length?255&I.gzhead.name.charCodeAt(I.gzindex++):0,me(I,U)}while(U!==0);I.gzhead.hcrc&&I.pending>N&&(S.adler=c(S.adler,I.pending_buf,I.pending-N,N)),U===0&&(I.gzindex=0,I.status=91)}else I.status=91;if(I.status===91)if(I.gzhead.comment){N=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>N&&(S.adler=c(S.adler,I.pending_buf,I.pending-N,N)),G(S),N=I.pending,I.pending===I.pending_buf_size)){U=1;break}U=I.gzindex<I.gzhead.comment.length?255&I.gzhead.comment.charCodeAt(I.gzindex++):0,me(I,U)}while(U!==0);I.gzhead.hcrc&&I.pending>N&&(S.adler=c(S.adler,I.pending_buf,I.pending-N,N)),U===0&&(I.status=103)}else I.status=103;if(I.status===103&&(I.gzhead.hcrc?(I.pending+2>I.pending_buf_size&&G(S),I.pending+2<=I.pending_buf_size&&(me(I,255&S.adler),me(I,S.adler>>8&255),S.adler=0,I.status=z)):I.status=z),I.pending!==0){if(G(S),S.avail_out===0)return I.last_flush=-1,g}else if(S.avail_in===0&&L(P)<=L(k)&&P!==p)return Y(S,-5);if(I.status===666&&S.avail_in!==0)return Y(S,-5);if(S.avail_in!==0||I.lookahead!==0||P!==m&&I.status!==666){var W=I.strategy===2?function(H,oe){for(var he;;){if(H.lookahead===0&&(_e(H),H.lookahead===0)){if(oe===m)return C;break}if(H.match_length=0,he=a._tr_tally(H,0,H.window[H.strstart]),H.lookahead--,H.strstart++,he&&(B(H,!1),H.strm.avail_out===0))return C}return H.insert=0,oe===p?(B(H,!0),H.strm.avail_out===0?ue:$):H.last_lit&&(B(H,!1),H.strm.avail_out===0)?C:q}(I,P):I.strategy===3?function(H,oe){for(var he,ie,Ee,Ne,we=H.window;;){if(H.lookahead<=V){if(_e(H),H.lookahead<=V&&oe===m)return C;if(H.lookahead===0)break}if(H.match_length=0,H.lookahead>=D&&0<H.strstart&&(ie=we[Ee=H.strstart-1])===we[++Ee]&&ie===we[++Ee]&&ie===we[++Ee]){Ne=H.strstart+V;do;while(ie===we[++Ee]&&ie===we[++Ee]&&ie===we[++Ee]&&ie===we[++Ee]&&ie===we[++Ee]&&ie===we[++Ee]&&ie===we[++Ee]&&ie===we[++Ee]&&Ee<Ne);H.match_length=V-(Ne-Ee),H.match_length>H.lookahead&&(H.match_length=H.lookahead)}if(H.match_length>=D?(he=a._tr_tally(H,1,H.match_length-D),H.lookahead-=H.match_length,H.strstart+=H.match_length,H.match_length=0):(he=a._tr_tally(H,0,H.window[H.strstart]),H.lookahead--,H.strstart++),he&&(B(H,!1),H.strm.avail_out===0))return C}return H.insert=0,oe===p?(B(H,!0),H.strm.avail_out===0?ue:$):H.last_lit&&(B(H,!1),H.strm.avail_out===0)?C:q}(I,P):i[I.level].func(I,P);if(W!==ue&&W!==$||(I.status=666),W===C||W===ue)return S.avail_out===0&&(I.last_flush=-1),g;if(W===q&&(P===1?a._tr_align(I):P!==5&&(a._tr_stored_block(I,0,0,!1),P===3&&(Z(I.head),I.lookahead===0&&(I.strstart=0,I.block_start=0,I.insert=0))),G(S),S.avail_out===0))return I.last_flush=-1,g}return P!==p?g:I.wrap<=0?1:(I.wrap===2?(me(I,255&S.adler),me(I,S.adler>>8&255),me(I,S.adler>>16&255),me(I,S.adler>>24&255),me(I,255&S.total_in),me(I,S.total_in>>8&255),me(I,S.total_in>>16&255),me(I,S.total_in>>24&255)):(de(I,S.adler>>>16),de(I,65535&S.adler)),G(S),0<I.wrap&&(I.wrap=-I.wrap),I.pending!==0?g:1)},o.deflateEnd=function(S){var P;return S&&S.state?(P=S.state.status)!==A&&P!==69&&P!==73&&P!==91&&P!==103&&P!==z&&P!==666?Y(S,E):(S.state=null,P===z?Y(S,-3):g):E},o.deflateSetDictionary=function(S,P){var k,I,N,U,X,W,H,oe,he=P.length;if(!S||!S.state||(U=(k=S.state).wrap)===2||U===1&&k.status!==A||k.lookahead)return E;for(U===1&&(S.adler=u(S.adler,P,he,0)),k.wrap=0,he>=k.w_size&&(U===0&&(Z(k.head),k.strstart=0,k.block_start=0,k.insert=0),oe=new s.Buf8(k.w_size),s.arraySet(oe,P,he-k.w_size,k.w_size,0),P=oe,he=k.w_size),X=S.avail_in,W=S.next_in,H=S.input,S.avail_in=he,S.next_in=0,S.input=P,_e(k);k.lookahead>=D;){for(I=k.strstart,N=k.lookahead-(D-1);k.ins_h=(k.ins_h<<k.hash_shift^k.window[I+D-1])&k.hash_mask,k.prev[I&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=I,I++,--N;);k.strstart=I,k.lookahead=D-1,_e(k)}return k.strstart+=k.lookahead,k.block_start=k.strstart,k.insert=k.lookahead,k.lookahead=0,k.match_length=k.prev_length=D-1,k.match_available=0,S.next_in=W,S.input=H,S.avail_in=X,k.wrap=U,g},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,o){r.exports=function(i,s){var a,u,c,f,m,p,g,E,v,T,y,x,w,_,b,M,R,F,D,V,K,A,z,C,q;a=i.state,u=i.next_in,C=i.input,c=u+(i.avail_in-5),f=i.next_out,q=i.output,m=f-(s-i.avail_out),p=f+(i.avail_out-257),g=a.dmax,E=a.wsize,v=a.whave,T=a.wnext,y=a.window,x=a.hold,w=a.bits,_=a.lencode,b=a.distcode,M=(1<<a.lenbits)-1,R=(1<<a.distbits)-1;e:do{w<15&&(x+=C[u++]<<w,w+=8,x+=C[u++]<<w,w+=8),F=_[x&M];t:for(;;){if(x>>>=D=F>>>24,w-=D,(D=F>>>16&255)===0)q[f++]=65535&F;else{if(!(16&D)){if(!(64&D)){F=_[(65535&F)+(x&(1<<D)-1)];continue t}if(32&D){a.mode=12;break e}i.msg="invalid literal/length code",a.mode=30;break e}V=65535&F,(D&=15)&&(w<D&&(x+=C[u++]<<w,w+=8),V+=x&(1<<D)-1,x>>>=D,w-=D),w<15&&(x+=C[u++]<<w,w+=8,x+=C[u++]<<w,w+=8),F=b[x&R];n:for(;;){if(x>>>=D=F>>>24,w-=D,!(16&(D=F>>>16&255))){if(!(64&D)){F=b[(65535&F)+(x&(1<<D)-1)];continue n}i.msg="invalid distance code",a.mode=30;break e}if(K=65535&F,w<(D&=15)&&(x+=C[u++]<<w,(w+=8)<D&&(x+=C[u++]<<w,w+=8)),g<(K+=x&(1<<D)-1)){i.msg="invalid distance too far back",a.mode=30;break e}if(x>>>=D,w-=D,(D=f-m)<K){if(v<(D=K-D)&&a.sane){i.msg="invalid distance too far back",a.mode=30;break e}if(z=y,(A=0)===T){if(A+=E-D,D<V){for(V-=D;q[f++]=y[A++],--D;);A=f-K,z=q}}else if(T<D){if(A+=E+T-D,(D-=T)<V){for(V-=D;q[f++]=y[A++],--D;);if(A=0,T<V){for(V-=D=T;q[f++]=y[A++],--D;);A=f-K,z=q}}}else if(A+=T-D,D<V){for(V-=D;q[f++]=y[A++],--D;);A=f-K,z=q}for(;2<V;)q[f++]=z[A++],q[f++]=z[A++],q[f++]=z[A++],V-=3;V&&(q[f++]=z[A++],1<V&&(q[f++]=z[A++]))}else{for(A=f-K;q[f++]=q[A++],q[f++]=q[A++],q[f++]=q[A++],2<(V-=3););V&&(q[f++]=q[A++],1<V&&(q[f++]=q[A++]))}break}}break}}while(u<c&&f<p);u-=V=w>>3,x&=(1<<(w-=V<<3))-1,i.next_in=u,i.next_out=f,i.avail_in=u<c?c-u+5:5-(u-c),i.avail_out=f<p?p-f+257:257-(f-p),a.hold=x,a.bits=w}},{}],49:[function(n,r,o){var i=n("../utils/common"),s=n("./adler32"),a=n("./crc32"),u=n("./inffast"),c=n("./inftrees"),f=1,m=2,p=0,g=-2,E=1,v=852,T=592;function y(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(A){var z;return A&&A.state?(z=A.state,A.total_in=A.total_out=z.total=0,A.msg="",z.wrap&&(A.adler=1&z.wrap),z.mode=E,z.last=0,z.havedict=0,z.dmax=32768,z.head=null,z.hold=0,z.bits=0,z.lencode=z.lendyn=new i.Buf32(v),z.distcode=z.distdyn=new i.Buf32(T),z.sane=1,z.back=-1,p):g}function _(A){var z;return A&&A.state?((z=A.state).wsize=0,z.whave=0,z.wnext=0,w(A)):g}function b(A,z){var C,q;return A&&A.state?(q=A.state,z<0?(C=0,z=-z):(C=1+(z>>4),z<48&&(z&=15)),z&&(z<8||15<z)?g:(q.window!==null&&q.wbits!==z&&(q.window=null),q.wrap=C,q.wbits=z,_(A))):g}function M(A,z){var C,q;return A?(q=new x,(A.state=q).window=null,(C=b(A,z))!==p&&(A.state=null),C):g}var R,F,D=!0;function V(A){if(D){var z;for(R=new i.Buf32(512),F=new i.Buf32(32),z=0;z<144;)A.lens[z++]=8;for(;z<256;)A.lens[z++]=9;for(;z<280;)A.lens[z++]=7;for(;z<288;)A.lens[z++]=8;for(c(f,A.lens,0,288,R,0,A.work,{bits:9}),z=0;z<32;)A.lens[z++]=5;c(m,A.lens,0,32,F,0,A.work,{bits:5}),D=!1}A.lencode=R,A.lenbits=9,A.distcode=F,A.distbits=5}function K(A,z,C,q){var ue,$=A.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new i.Buf8($.wsize)),q>=$.wsize?(i.arraySet($.window,z,C-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(q<(ue=$.wsize-$.wnext)&&(ue=q),i.arraySet($.window,z,C-q,ue,$.wnext),(q-=ue)?(i.arraySet($.window,z,C-q,q,0),$.wnext=q,$.whave=$.wsize):($.wnext+=ue,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=ue))),0}o.inflateReset=_,o.inflateReset2=b,o.inflateResetKeep=w,o.inflateInit=function(A){return M(A,15)},o.inflateInit2=M,o.inflate=function(A,z){var C,q,ue,$,Y,L,Z,G,B,me,de,re,_e,Ie,ve,ee,le,te,xe,ce,S,P,k,I,N=0,U=new i.Buf8(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return g;(C=A.state).mode===12&&(C.mode=13),Y=A.next_out,ue=A.output,Z=A.avail_out,$=A.next_in,q=A.input,L=A.avail_in,G=C.hold,B=C.bits,me=L,de=Z,P=p;e:for(;;)switch(C.mode){case E:if(C.wrap===0){C.mode=13;break}for(;B<16;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(2&C.wrap&&G===35615){U[C.check=0]=255&G,U[1]=G>>>8&255,C.check=a(C.check,U,2,0),B=G=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&G)<<8)+(G>>8))%31){A.msg="incorrect header check",C.mode=30;break}if((15&G)!=8){A.msg="unknown compression method",C.mode=30;break}if(B-=4,S=8+(15&(G>>>=4)),C.wbits===0)C.wbits=S;else if(S>C.wbits){A.msg="invalid window size",C.mode=30;break}C.dmax=1<<S,A.adler=C.check=1,C.mode=512&G?10:12,B=G=0;break;case 2:for(;B<16;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(C.flags=G,(255&C.flags)!=8){A.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){A.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=G>>8&1),512&C.flags&&(U[0]=255&G,U[1]=G>>>8&255,C.check=a(C.check,U,2,0)),B=G=0,C.mode=3;case 3:for(;B<32;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}C.head&&(C.head.time=G),512&C.flags&&(U[0]=255&G,U[1]=G>>>8&255,U[2]=G>>>16&255,U[3]=G>>>24&255,C.check=a(C.check,U,4,0)),B=G=0,C.mode=4;case 4:for(;B<16;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}C.head&&(C.head.xflags=255&G,C.head.os=G>>8),512&C.flags&&(U[0]=255&G,U[1]=G>>>8&255,C.check=a(C.check,U,2,0)),B=G=0,C.mode=5;case 5:if(1024&C.flags){for(;B<16;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}C.length=G,C.head&&(C.head.extra_len=G),512&C.flags&&(U[0]=255&G,U[1]=G>>>8&255,C.check=a(C.check,U,2,0)),B=G=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(L<(re=C.length)&&(re=L),re&&(C.head&&(S=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),i.arraySet(C.head.extra,q,$,re,S)),512&C.flags&&(C.check=a(C.check,q,re,$)),L-=re,$+=re,C.length-=re),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(L===0)break e;for(re=0;S=q[$+re++],C.head&&S&&C.length<65536&&(C.head.name+=String.fromCharCode(S)),S&&re<L;);if(512&C.flags&&(C.check=a(C.check,q,re,$)),L-=re,$+=re,S)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(L===0)break e;for(re=0;S=q[$+re++],C.head&&S&&C.length<65536&&(C.head.comment+=String.fromCharCode(S)),S&&re<L;);if(512&C.flags&&(C.check=a(C.check,q,re,$)),L-=re,$+=re,S)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;B<16;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(G!==(65535&C.check)){A.msg="header crc mismatch",C.mode=30;break}B=G=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),A.adler=C.check=0,C.mode=12;break;case 10:for(;B<32;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}A.adler=C.check=y(G),B=G=0,C.mode=11;case 11:if(C.havedict===0)return A.next_out=Y,A.avail_out=Z,A.next_in=$,A.avail_in=L,C.hold=G,C.bits=B,2;A.adler=C.check=1,C.mode=12;case 12:if(z===5||z===6)break e;case 13:if(C.last){G>>>=7&B,B-=7&B,C.mode=27;break}for(;B<3;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}switch(C.last=1&G,B-=1,3&(G>>>=1)){case 0:C.mode=14;break;case 1:if(V(C),C.mode=20,z!==6)break;G>>>=2,B-=2;break e;case 2:C.mode=17;break;case 3:A.msg="invalid block type",C.mode=30}G>>>=2,B-=2;break;case 14:for(G>>>=7&B,B-=7&B;B<32;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if((65535&G)!=(G>>>16^65535)){A.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&G,B=G=0,C.mode=15,z===6)break e;case 15:C.mode=16;case 16:if(re=C.length){if(L<re&&(re=L),Z<re&&(re=Z),re===0)break e;i.arraySet(ue,q,$,re,Y),L-=re,$+=re,Z-=re,Y+=re,C.length-=re;break}C.mode=12;break;case 17:for(;B<14;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(C.nlen=257+(31&G),G>>>=5,B-=5,C.ndist=1+(31&G),G>>>=5,B-=5,C.ncode=4+(15&G),G>>>=4,B-=4,286<C.nlen||30<C.ndist){A.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;B<3;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}C.lens[X[C.have++]]=7&G,G>>>=3,B-=3}for(;C.have<19;)C.lens[X[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,k={bits:C.lenbits},P=c(0,C.lens,0,19,C.lencode,0,C.work,k),C.lenbits=k.bits,P){A.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;ee=(N=C.lencode[G&(1<<C.lenbits)-1])>>>16&255,le=65535&N,!((ve=N>>>24)<=B);){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(le<16)G>>>=ve,B-=ve,C.lens[C.have++]=le;else{if(le===16){for(I=ve+2;B<I;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(G>>>=ve,B-=ve,C.have===0){A.msg="invalid bit length repeat",C.mode=30;break}S=C.lens[C.have-1],re=3+(3&G),G>>>=2,B-=2}else if(le===17){for(I=ve+3;B<I;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}B-=ve,S=0,re=3+(7&(G>>>=ve)),G>>>=3,B-=3}else{for(I=ve+7;B<I;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}B-=ve,S=0,re=11+(127&(G>>>=ve)),G>>>=7,B-=7}if(C.have+re>C.nlen+C.ndist){A.msg="invalid bit length repeat",C.mode=30;break}for(;re--;)C.lens[C.have++]=S}}if(C.mode===30)break;if(C.lens[256]===0){A.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,k={bits:C.lenbits},P=c(f,C.lens,0,C.nlen,C.lencode,0,C.work,k),C.lenbits=k.bits,P){A.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,k={bits:C.distbits},P=c(m,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,k),C.distbits=k.bits,P){A.msg="invalid distances set",C.mode=30;break}if(C.mode=20,z===6)break e;case 20:C.mode=21;case 21:if(6<=L&&258<=Z){A.next_out=Y,A.avail_out=Z,A.next_in=$,A.avail_in=L,C.hold=G,C.bits=B,u(A,de),Y=A.next_out,ue=A.output,Z=A.avail_out,$=A.next_in,q=A.input,L=A.avail_in,G=C.hold,B=C.bits,C.mode===12&&(C.back=-1);break}for(C.back=0;ee=(N=C.lencode[G&(1<<C.lenbits)-1])>>>16&255,le=65535&N,!((ve=N>>>24)<=B);){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(ee&&!(240&ee)){for(te=ve,xe=ee,ce=le;ee=(N=C.lencode[ce+((G&(1<<te+xe)-1)>>te)])>>>16&255,le=65535&N,!(te+(ve=N>>>24)<=B);){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}G>>>=te,B-=te,C.back+=te}if(G>>>=ve,B-=ve,C.back+=ve,C.length=le,ee===0){C.mode=26;break}if(32&ee){C.back=-1,C.mode=12;break}if(64&ee){A.msg="invalid literal/length code",C.mode=30;break}C.extra=15&ee,C.mode=22;case 22:if(C.extra){for(I=C.extra;B<I;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}C.length+=G&(1<<C.extra)-1,G>>>=C.extra,B-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;ee=(N=C.distcode[G&(1<<C.distbits)-1])>>>16&255,le=65535&N,!((ve=N>>>24)<=B);){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(!(240&ee)){for(te=ve,xe=ee,ce=le;ee=(N=C.distcode[ce+((G&(1<<te+xe)-1)>>te)])>>>16&255,le=65535&N,!(te+(ve=N>>>24)<=B);){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}G>>>=te,B-=te,C.back+=te}if(G>>>=ve,B-=ve,C.back+=ve,64&ee){A.msg="invalid distance code",C.mode=30;break}C.offset=le,C.extra=15&ee,C.mode=24;case 24:if(C.extra){for(I=C.extra;B<I;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}C.offset+=G&(1<<C.extra)-1,G>>>=C.extra,B-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){A.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(Z===0)break e;if(re=de-Z,C.offset>re){if((re=C.offset-re)>C.whave&&C.sane){A.msg="invalid distance too far back",C.mode=30;break}_e=re>C.wnext?(re-=C.wnext,C.wsize-re):C.wnext-re,re>C.length&&(re=C.length),Ie=C.window}else Ie=ue,_e=Y-C.offset,re=C.length;for(Z<re&&(re=Z),Z-=re,C.length-=re;ue[Y++]=Ie[_e++],--re;);C.length===0&&(C.mode=21);break;case 26:if(Z===0)break e;ue[Y++]=C.length,Z--,C.mode=21;break;case 27:if(C.wrap){for(;B<32;){if(L===0)break e;L--,G|=q[$++]<<B,B+=8}if(de-=Z,A.total_out+=de,C.total+=de,de&&(A.adler=C.check=C.flags?a(C.check,ue,de,Y-de):s(C.check,ue,de,Y-de)),de=Z,(C.flags?G:y(G))!==C.check){A.msg="incorrect data check",C.mode=30;break}B=G=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;B<32;){if(L===0)break e;L--,G+=q[$++]<<B,B+=8}if(G!==(4294967295&C.total)){A.msg="incorrect length check",C.mode=30;break}B=G=0}C.mode=29;case 29:P=1;break e;case 30:P=-3;break e;case 31:return-4;case 32:default:return g}return A.next_out=Y,A.avail_out=Z,A.next_in=$,A.avail_in=L,C.hold=G,C.bits=B,(C.wsize||de!==A.avail_out&&C.mode<30&&(C.mode<27||z!==4))&&K(A,A.output,A.next_out,de-A.avail_out)?(C.mode=31,-4):(me-=A.avail_in,de-=A.avail_out,A.total_in+=me,A.total_out+=de,C.total+=de,C.wrap&&de&&(A.adler=C.check=C.flags?a(C.check,ue,de,A.next_out-de):s(C.check,ue,de,A.next_out-de)),A.data_type=C.bits+(C.last?64:0)+(C.mode===12?128:0)+(C.mode===20||C.mode===15?256:0),(me==0&&de===0||z===4)&&P===p&&(P=-5),P)},o.inflateEnd=function(A){if(!A||!A.state)return g;var z=A.state;return z.window&&(z.window=null),A.state=null,p},o.inflateGetHeader=function(A,z){var C;return A&&A.state&&2&(C=A.state).wrap?((C.head=z).done=!1,p):g},o.inflateSetDictionary=function(A,z){var C,q=z.length;return A&&A.state?(C=A.state).wrap!==0&&C.mode!==11?g:C.mode===11&&s(1,z,q,0)!==C.check?-3:K(A,z,q,q)?(C.mode=31,-4):(C.havedict=1,p):g},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,o){var i=n("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(f,m,p,g,E,v,T,y){var x,w,_,b,M,R,F,D,V,K=y.bits,A=0,z=0,C=0,q=0,ue=0,$=0,Y=0,L=0,Z=0,G=0,B=null,me=0,de=new i.Buf16(16),re=new i.Buf16(16),_e=null,Ie=0;for(A=0;A<=15;A++)de[A]=0;for(z=0;z<g;z++)de[m[p+z]]++;for(ue=K,q=15;1<=q&&de[q]===0;q--);if(q<ue&&(ue=q),q===0)return E[v++]=20971520,E[v++]=20971520,y.bits=1,0;for(C=1;C<q&&de[C]===0;C++);for(ue<C&&(ue=C),A=L=1;A<=15;A++)if(L<<=1,(L-=de[A])<0)return-1;if(0<L&&(f===0||q!==1))return-1;for(re[1]=0,A=1;A<15;A++)re[A+1]=re[A]+de[A];for(z=0;z<g;z++)m[p+z]!==0&&(T[re[m[p+z]]++]=z);if(R=f===0?(B=_e=T,19):f===1?(B=s,me-=257,_e=a,Ie-=257,256):(B=u,_e=c,-1),A=C,M=v,Y=z=G=0,_=-1,b=(Z=1<<($=ue))-1,f===1&&852<Z||f===2&&592<Z)return 1;for(;;){for(F=A-Y,V=T[z]<R?(D=0,T[z]):T[z]>R?(D=_e[Ie+T[z]],B[me+T[z]]):(D=96,0),x=1<<A-Y,C=w=1<<$;E[M+(G>>Y)+(w-=x)]=F<<24|D<<16|V|0,w!==0;);for(x=1<<A-1;G&x;)x>>=1;if(x!==0?(G&=x-1,G+=x):G=0,z++,--de[A]==0){if(A===q)break;A=m[p+T[z]]}if(ue<A&&(G&b)!==_){for(Y===0&&(Y=ue),M+=C,L=1<<($=A-Y);$+Y<q&&!((L-=de[$+Y])<=0);)$++,L<<=1;if(Z+=1<<$,f===1&&852<Z||f===2&&592<Z)return 1;E[_=G&b]=ue<<24|$<<16|M-v|0}}return G!==0&&(E[M+G]=A-Y<<24|64<<16|0),y.bits=ue,0}},{"../utils/common":41}],51:[function(n,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,o){var i=n("../utils/common"),s=0,a=1;function u(N){for(var U=N.length;0<=--U;)N[U]=0}var c=0,f=29,m=256,p=m+1+f,g=30,E=19,v=2*p+1,T=15,y=16,x=7,w=256,_=16,b=17,M=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(p+2));u(K);var A=new Array(2*g);u(A);var z=new Array(512);u(z);var C=new Array(256);u(C);var q=new Array(f);u(q);var ue,$,Y,L=new Array(g);function Z(N,U,X,W,H){this.static_tree=N,this.extra_bits=U,this.extra_base=X,this.elems=W,this.max_length=H,this.has_stree=N&&N.length}function G(N,U){this.dyn_tree=N,this.max_code=0,this.stat_desc=U}function B(N){return N<256?z[N]:z[256+(N>>>7)]}function me(N,U){N.pending_buf[N.pending++]=255&U,N.pending_buf[N.pending++]=U>>>8&255}function de(N,U,X){N.bi_valid>y-X?(N.bi_buf|=U<<N.bi_valid&65535,me(N,N.bi_buf),N.bi_buf=U>>y-N.bi_valid,N.bi_valid+=X-y):(N.bi_buf|=U<<N.bi_valid&65535,N.bi_valid+=X)}function re(N,U,X){de(N,X[2*U],X[2*U+1])}function _e(N,U){for(var X=0;X|=1&N,N>>>=1,X<<=1,0<--U;);return X>>>1}function Ie(N,U,X){var W,H,oe=new Array(T+1),he=0;for(W=1;W<=T;W++)oe[W]=he=he+X[W-1]<<1;for(H=0;H<=U;H++){var ie=N[2*H+1];ie!==0&&(N[2*H]=_e(oe[ie]++,ie))}}function ve(N){var U;for(U=0;U<p;U++)N.dyn_ltree[2*U]=0;for(U=0;U<g;U++)N.dyn_dtree[2*U]=0;for(U=0;U<E;U++)N.bl_tree[2*U]=0;N.dyn_ltree[2*w]=1,N.opt_len=N.static_len=0,N.last_lit=N.matches=0}function ee(N){8<N.bi_valid?me(N,N.bi_buf):0<N.bi_valid&&(N.pending_buf[N.pending++]=N.bi_buf),N.bi_buf=0,N.bi_valid=0}function le(N,U,X,W){var H=2*U,oe=2*X;return N[H]<N[oe]||N[H]===N[oe]&&W[U]<=W[X]}function te(N,U,X){for(var W=N.heap[X],H=X<<1;H<=N.heap_len&&(H<N.heap_len&&le(U,N.heap[H+1],N.heap[H],N.depth)&&H++,!le(U,W,N.heap[H],N.depth));)N.heap[X]=N.heap[H],X=H,H<<=1;N.heap[X]=W}function xe(N,U,X){var W,H,oe,he,ie=0;if(N.last_lit!==0)for(;W=N.pending_buf[N.d_buf+2*ie]<<8|N.pending_buf[N.d_buf+2*ie+1],H=N.pending_buf[N.l_buf+ie],ie++,W===0?re(N,H,U):(re(N,(oe=C[H])+m+1,U),(he=R[oe])!==0&&de(N,H-=q[oe],he),re(N,oe=B(--W),X),(he=F[oe])!==0&&de(N,W-=L[oe],he)),ie<N.last_lit;);re(N,w,U)}function ce(N,U){var X,W,H,oe=U.dyn_tree,he=U.stat_desc.static_tree,ie=U.stat_desc.has_stree,Ee=U.stat_desc.elems,Ne=-1;for(N.heap_len=0,N.heap_max=v,X=0;X<Ee;X++)oe[2*X]!==0?(N.heap[++N.heap_len]=Ne=X,N.depth[X]=0):oe[2*X+1]=0;for(;N.heap_len<2;)oe[2*(H=N.heap[++N.heap_len]=Ne<2?++Ne:0)]=1,N.depth[H]=0,N.opt_len--,ie&&(N.static_len-=he[2*H+1]);for(U.max_code=Ne,X=N.heap_len>>1;1<=X;X--)te(N,oe,X);for(H=Ee;X=N.heap[1],N.heap[1]=N.heap[N.heap_len--],te(N,oe,1),W=N.heap[1],N.heap[--N.heap_max]=X,N.heap[--N.heap_max]=W,oe[2*H]=oe[2*X]+oe[2*W],N.depth[H]=(N.depth[X]>=N.depth[W]?N.depth[X]:N.depth[W])+1,oe[2*X+1]=oe[2*W+1]=H,N.heap[1]=H++,te(N,oe,1),2<=N.heap_len;);N.heap[--N.heap_max]=N.heap[1],function(we,Be){var tn,Ze,zt,Oe,nn,Nt,ft=Be.dyn_tree,Yn=Be.max_code,se=Be.stat_desc.static_tree,ye=Be.stat_desc.has_stree,Te=Be.stat_desc.extra_bits,be=Be.stat_desc.extra_base,Ve=Be.stat_desc.max_length,st=0;for(Oe=0;Oe<=T;Oe++)we.bl_count[Oe]=0;for(ft[2*we.heap[we.heap_max]+1]=0,tn=we.heap_max+1;tn<v;tn++)Ve<(Oe=ft[2*ft[2*(Ze=we.heap[tn])+1]+1]+1)&&(Oe=Ve,st++),ft[2*Ze+1]=Oe,Yn<Ze||(we.bl_count[Oe]++,nn=0,be<=Ze&&(nn=Te[Ze-be]),Nt=ft[2*Ze],we.opt_len+=Nt*(Oe+nn),ye&&(we.static_len+=Nt*(se[2*Ze+1]+nn)));if(st!==0){do{for(Oe=Ve-1;we.bl_count[Oe]===0;)Oe--;we.bl_count[Oe]--,we.bl_count[Oe+1]+=2,we.bl_count[Ve]--,st-=2}while(0<st);for(Oe=Ve;Oe!==0;Oe--)for(Ze=we.bl_count[Oe];Ze!==0;)Yn<(zt=we.heap[--tn])||(ft[2*zt+1]!==Oe&&(we.opt_len+=(Oe-ft[2*zt+1])*ft[2*zt],ft[2*zt+1]=Oe),Ze--)}}(N,U),Ie(oe,Ne,N.bl_count)}function S(N,U,X){var W,H,oe=-1,he=U[1],ie=0,Ee=7,Ne=4;for(he===0&&(Ee=138,Ne=3),U[2*(X+1)+1]=65535,W=0;W<=X;W++)H=he,he=U[2*(W+1)+1],++ie<Ee&&H===he||(ie<Ne?N.bl_tree[2*H]+=ie:H!==0?(H!==oe&&N.bl_tree[2*H]++,N.bl_tree[2*_]++):ie<=10?N.bl_tree[2*b]++:N.bl_tree[2*M]++,oe=H,Ne=(ie=0)===he?(Ee=138,3):H===he?(Ee=6,3):(Ee=7,4))}function P(N,U,X){var W,H,oe=-1,he=U[1],ie=0,Ee=7,Ne=4;for(he===0&&(Ee=138,Ne=3),W=0;W<=X;W++)if(H=he,he=U[2*(W+1)+1],!(++ie<Ee&&H===he)){if(ie<Ne)for(;re(N,H,N.bl_tree),--ie!=0;);else H!==0?(H!==oe&&(re(N,H,N.bl_tree),ie--),re(N,_,N.bl_tree),de(N,ie-3,2)):ie<=10?(re(N,b,N.bl_tree),de(N,ie-3,3)):(re(N,M,N.bl_tree),de(N,ie-11,7));oe=H,Ne=(ie=0)===he?(Ee=138,3):H===he?(Ee=6,3):(Ee=7,4)}}u(L);var k=!1;function I(N,U,X,W){de(N,(c<<1)+(W?1:0),3),function(H,oe,he,ie){ee(H),me(H,he),me(H,~he),i.arraySet(H.pending_buf,H.window,oe,he,H.pending),H.pending+=he}(N,U,X)}o._tr_init=function(N){k||(function(){var U,X,W,H,oe,he=new Array(T+1);for(H=W=0;H<f-1;H++)for(q[H]=W,U=0;U<1<<R[H];U++)C[W++]=H;for(C[W-1]=H,H=oe=0;H<16;H++)for(L[H]=oe,U=0;U<1<<F[H];U++)z[oe++]=H;for(oe>>=7;H<g;H++)for(L[H]=oe<<7,U=0;U<1<<F[H]-7;U++)z[256+oe++]=H;for(X=0;X<=T;X++)he[X]=0;for(U=0;U<=143;)K[2*U+1]=8,U++,he[8]++;for(;U<=255;)K[2*U+1]=9,U++,he[9]++;for(;U<=279;)K[2*U+1]=7,U++,he[7]++;for(;U<=287;)K[2*U+1]=8,U++,he[8]++;for(Ie(K,p+1,he),U=0;U<g;U++)A[2*U+1]=5,A[2*U]=_e(U,5);ue=new Z(K,R,m+1,p,T),$=new Z(A,F,0,g,T),Y=new Z(new Array(0),D,0,E,x)}(),k=!0),N.l_desc=new G(N.dyn_ltree,ue),N.d_desc=new G(N.dyn_dtree,$),N.bl_desc=new G(N.bl_tree,Y),N.bi_buf=0,N.bi_valid=0,ve(N)},o._tr_stored_block=I,o._tr_flush_block=function(N,U,X,W){var H,oe,he=0;0<N.level?(N.strm.data_type===2&&(N.strm.data_type=function(ie){var Ee,Ne=4093624447;for(Ee=0;Ee<=31;Ee++,Ne>>>=1)if(1&Ne&&ie.dyn_ltree[2*Ee]!==0)return s;if(ie.dyn_ltree[18]!==0||ie.dyn_ltree[20]!==0||ie.dyn_ltree[26]!==0)return a;for(Ee=32;Ee<m;Ee++)if(ie.dyn_ltree[2*Ee]!==0)return a;return s}(N)),ce(N,N.l_desc),ce(N,N.d_desc),he=function(ie){var Ee;for(S(ie,ie.dyn_ltree,ie.l_desc.max_code),S(ie,ie.dyn_dtree,ie.d_desc.max_code),ce(ie,ie.bl_desc),Ee=E-1;3<=Ee&&ie.bl_tree[2*V[Ee]+1]===0;Ee--);return ie.opt_len+=3*(Ee+1)+5+5+4,Ee}(N),H=N.opt_len+3+7>>>3,(oe=N.static_len+3+7>>>3)<=H&&(H=oe)):H=oe=X+5,X+4<=H&&U!==-1?I(N,U,X,W):N.strategy===4||oe===H?(de(N,2+(W?1:0),3),xe(N,K,A)):(de(N,4+(W?1:0),3),function(ie,Ee,Ne,we){var Be;for(de(ie,Ee-257,5),de(ie,Ne-1,5),de(ie,we-4,4),Be=0;Be<we;Be++)de(ie,ie.bl_tree[2*V[Be]+1],3);P(ie,ie.dyn_ltree,Ee-1),P(ie,ie.dyn_dtree,Ne-1)}(N,N.l_desc.max_code+1,N.d_desc.max_code+1,he+1),xe(N,N.dyn_ltree,N.dyn_dtree)),ve(N),W&&ee(N)},o._tr_tally=function(N,U,X){return N.pending_buf[N.d_buf+2*N.last_lit]=U>>>8&255,N.pending_buf[N.d_buf+2*N.last_lit+1]=255&U,N.pending_buf[N.l_buf+N.last_lit]=255&X,N.last_lit++,U===0?N.dyn_ltree[2*X]++:(N.matches++,U--,N.dyn_ltree[2*(C[X]+m+1)]++,N.dyn_dtree[2*B(U)]++),N.last_lit===N.lit_bufsize-1},o._tr_align=function(N){de(N,2,3),re(N,w,K),function(U){U.bi_valid===16?(me(U,U.bi_buf),U.bi_buf=0,U.bi_valid=0):8<=U.bi_valid&&(U.pending_buf[U.pending++]=255&U.bi_buf,U.bi_buf>>=8,U.bi_valid-=8)}(N)}},{"../utils/common":41}],53:[function(n,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,o){(function(i){(function(s,a){if(!s.setImmediate){var u,c,f,m,p=1,g={},E=!1,v=s.document,T=Object.getPrototypeOf&&Object.getPrototypeOf(s);T=T&&T.setTimeout?T:s,u={}.toString.call(s.process)==="[object process]"?function(_){process.nextTick(function(){x(_)})}:function(){if(s.postMessage&&!s.importScripts){var _=!0,b=s.onmessage;return s.onmessage=function(){_=!1},s.postMessage("","*"),s.onmessage=b,_}}()?(m="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",w,!1):s.attachEvent("onmessage",w),function(_){s.postMessage(m+_,"*")}):s.MessageChannel?((f=new MessageChannel).port1.onmessage=function(_){x(_.data)},function(_){f.port2.postMessage(_)}):v&&"onreadystatechange"in v.createElement("script")?(c=v.documentElement,function(_){var b=v.createElement("script");b.onreadystatechange=function(){x(_),b.onreadystatechange=null,c.removeChild(b),b=null},c.appendChild(b)}):function(_){setTimeout(x,0,_)},T.setImmediate=function(_){typeof _!="function"&&(_=new Function(""+_));for(var b=new Array(arguments.length-1),M=0;M<b.length;M++)b[M]=arguments[M+1];var R={callback:_,args:b};return g[p]=R,u(p),p++},T.clearImmediate=y}function y(_){delete g[_]}function x(_){if(E)setTimeout(x,0,_);else{var b=g[_];if(b){E=!0;try{(function(M){var R=M.callback,F=M.args;switch(F.length){case 0:R();break;case 1:R(F[0]);break;case 2:R(F[0],F[1]);break;case 3:R(F[0],F[1],F[2]);break;default:R.apply(a,F)}})(b)}finally{y(_),E=!1}}}}function w(_){_.source===s&&typeof _.data=="string"&&_.data.indexOf(m)===0&&x(+_.data.slice(m.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof fn<"u"?fn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Om);var o_=Om.exports;const Um=_f(o_),ha=[{value:"action",label:" /"},{value:"emotion",label:" /"},{value:"landscape",label:" /"}],Lt=5,i_=({onNext:t,isNextLoading:e,isAnalyzing:n})=>{const{scenes:r,setScenes:o,characters:i,setCharacters:s,referenceImages:a,apiKey:u,showToast:c,openModal:f,globalScenePrompt:m,setGlobalScenePrompt:p,props:g,script:E,selectedStyle:v,scriptSegments:T,isContinuityMode:y}=Qt(),[x,w]=ne.useState(0),_=Math.ceil(r.length/Lt),b=r.slice(x*Lt,(x+1)*Lt),[M,R]=ne.useState(!1),[F,D]=ne.useState(!1),[V,K]=ne.useState(()=>{const te=localStorage.getItem("sceneTab_baseFolder");return te!==null?te:" "});ne.useEffect(()=>{localStorage.setItem("sceneTab_baseFolder",V)},[V]);const[A,z]=ne.useState(""),C=te=>{const xe=i.find(S=>S.id===te),ce=xe?`${xe.name}.png`:"";return`/${V}/${ce}`},[q,ue]=ne.useState([]),$=te=>te.replace(/[\[\]\(\):]/g,"").replace(/\s+/g," ").trim(),Y=(te,xe)=>{const ce=te.join(" "),S=$(ce),P=/\[(?:|Character)\s*:\s*([^\]]+)\]/gi,k=[...ce.matchAll(P)];let I=[];return k.length>0&&k.forEach(N=>{const X=N[1].split(",").map(W=>$(W)).filter(W=>W.length>0);I.push(...X)}),xe.filter(N=>{const U=N.name.trim(),X=$(U),W=U.split("(")[0].trim(),H=$(W);return I.length>0?!!(I.includes(X)||W.length>=1&&W!==U&&I.includes(H)):!!(S.includes(X)||W.length>=2&&S.includes(H))})};ne.useEffect(()=>{let te=!1;const xe=r.map(ce=>{if(!ce.casting&&i.length>0){const S=Y([ce.scriptSegment,ce.description,ce.englishPrompt||""],i),P=S.slice(0,3).map(H=>H.id),k=S.slice(3,6).map(H=>H.id),I=$(ce.scriptSegment),N=$(ce.description),U=$(ce.englishPrompt||""),W=(g?g.filter(H=>{const oe=$(H.name);return I.includes(oe)||N.includes(oe)||U.includes(oe)}):[]).map(H=>H.id);return te=!0,{...ce,casting:{mainIds:P,subIds:k,propIds:W}}}return ce});te&&o(xe)},[i.length,g==null?void 0:g.length,r.length]);const L=()=>{if(!A.trim())return c("  .","warning");const te={id:Date.now().toString(),name:A.trim(),description:"",visualGuide:"",age:"unknown",gender:"unknown",hasDialogue:!1,chromaKeyColor:"green",actions:[]};s(xe=>{const ce=[...xe,te],S=r.map(P=>{const k=P.casting||{mainIds:[],subIds:[],propIds:[]},I=[...k.mainIds],N=[...k.subIds];return Y([P.scriptSegment,P.description,P.englishPrompt||""],ce).forEach(X=>{X.id===te.id&&!I.includes(X.id)&&!N.includes(X.id)&&(I.length<6?I.push(X.id):N.length<6&&N.push(X.id))}),{...P,casting:{...k,mainIds:I,subIds:N}}});return o(S),ce}),z(""),c(`'${te.name}'  .       .`,"success")},Z=()=>{let te=0;const xe=r.map(ce=>{const S=ce.casting||{mainIds:[],subIds:[],propIds:[]},P=[...S.mainIds],k=[...S.subIds];return Y([ce.scriptSegment,ce.description,ce.englishPrompt||""],i).forEach(N=>{!P.includes(N.id)&&!k.includes(N.id)&&(P.length<6?(P.push(N.id),te++):k.length<6&&(k.push(N.id),te++))}),{...ce,casting:{...S,mainIds:P,subIds:k}}});te>0?(o(xe),c(`${te}    .`,"success")):c("   .","info")},G=()=>{ue(te=>[...te,r])},B=()=>{if(q.length===0)return;const te=q[q.length-1];o(te),ue(xe=>xe.slice(0,-1)),c("  .","success")},me=(te,xe,ce,S)=>{o(P=>P.map(k=>{if(k.id!==te)return k;const I=k.casting||{mainIds:[],subIds:[],propIds:[]};let N=[...I.mainIds],U=[...I.subIds],X=[...I.propIds||[]];if(S==="remove")N=N.filter(W=>W!==ce);else{if(N.length>=6)return c("  6.","warning"),k;N.includes(ce)||N.push(ce),U=U.filter(W=>W!==ce)}return{...k,casting:{mainIds:N,subIds:U,propIds:X}}}))},de=(te,xe,ce)=>{o(S=>S.map(P=>{var W;if(P.id!==te)return P;const k={...P,[xe]:ce},I=Y([k.scriptSegment,k.description,k.englishPrompt||""],i),N=I.slice(0,6).map(H=>H.id),U=I.slice(6,12).map(H=>H.id),X=((W=P.casting)==null?void 0:W.propIds)||[];return{...k,casting:{mainIds:N,subIds:U,propIds:X}}}))},re=(te,xe)=>{o(ce=>ce.map(S=>S.id===te?{...S,manualImagePaths:xe}:S))},_e=te=>{o(xe=>xe.map(ce=>{if(ce.id!==te)return ce;const S=ce.manualImagePaths!==void 0?ce.manualImagePaths:Ie(ce),P=`/${V}/`;return{...ce,manualImagePaths:S+P}}))},Ie=te=>{var S;let xe="",ce=!1;return(S=te.casting)!=null&&S.mainIds&&te.casting.mainIds.forEach(P=>{const k=i.find(I=>I.id===P);if(k&&!k.isGroup){const I=C(k.id);xe+=`${I}
`,ce=!0}}),ce||(xe+=`()
`),xe},ve=async()=>{const te=Math.ceil(r.length/Lt),xe=new Date().toISOString().slice(0,10);let ce="";i.length>0&&(ce=i[0].name.trim().replace(/[\\/:*?"<>|]/g,"")+"_");let S="Prompt_Export";if(T.length>0)if(y){const N=T[T.length-1].title.trim().replace(/[\\/:*?"<>|]/g,"_");S=`${ce}${N}_Ch${T.length}`}else{const N=T[0].title.trim().replace(/[\\/:*?"<>|]/g,"_");S=`${ce}${N}_Full`}else if(r.length>0){const I=r[0].scriptSegment.slice(0,10).trim().replace(/[\\/:*?"<>|]/g,"");S=`${ce}${I}_Prompt`}const P=new Um;if(a.length>0){const I=P.folder("__");a.forEach(N=>{if(N.imageUrl&&N.imageUrl.startsWith("data:image"))try{const U=N.imageUrl.split(",")[1],X=N.name.trim().replace(/[\\/:*?"<>|]/g,"_");I==null||I.file(`${X}.png`,U,{base64:!0})}catch(U){console.warn(`Failed to add image for ${N.name}`,U)}})}const k=St[v];if(k){let I=` [   ]

`;I+=` : ${k.name}
`,I+=`: ${k.desc}
`,I+=` : ${k.prompt}

`,I+=`
`,I+=` :      ' '  
`,I+=`         .
`,P.file(`__${k.name}.txt`,I)}for(let I=0;I<te;I++){const N=I*Lt,U=Math.min((I+1)*Lt,r.length),X=r.slice(N,U);let W="";const H=St[v];H&&(W+=` [  : ${H.name}]
`,W+=`: ${H.desc}
`,W+=`: ${H.prompt}
`,W+=`

`),X.forEach(ie=>{var Ne;const Ee=((Ne=ha.find(we=>we.value===ie.sceneType))==null?void 0:Ne.label)||" /";W+=`
`,W+=`  ${ie.sceneNumber} ( ${T.length>0&&y?T.length:"1"})
`,W+=` [ : ${Ee}]
`,W+=`

`,W+=` []
`,W+=`${ie.description||ie.scriptSegment}

`,W+=` [  ]
`,W+=`${ie.englishPrompt||"(   .)"}

`,W+=` [  ]
`,ie.manualImagePaths!==void 0?W+=ie.manualImagePaths:W+=Ie(ie),W+=`
`});const oe=(N+1).toString().padStart(2,"0"),he=U.toString().padStart(2,"0");P.file(`${S}_scenes${oe}-${he}.txt`,W)}try{const I=await P.generateAsync({type:"blob"});Tl.saveAs(I,`${S}_${xe}.zip`),c(`'${S}_${xe}.zip'  .`,"success")}catch(I){console.error(I),c("ZIP     .","error")}},ee=()=>{confirm(`      ?
(  () ,     .)`)&&(G(),o([]),s([]),w(0),c("    . (/ )","success"))},le=async()=>{if(!u)return c("API  .","warning");const te=x*Lt,xe=Math.min((x+1)*Lt,r.length),ce=r.slice(te,xe);R(!0),c(`${ce.length}   ... (AI    )`,"info");try{const S=await HC(u,ce,v,m,i,a),P=[...r];for(let k=0;k<ce.length;k++)if(S[k]){const I=te+k;let N=P[I].description||"";N=N.replace(/\[(|||||||Camera|Character|Background|Style).*?\]/gi,"").trim(),P[I]={...P[I],description:N,englishPrompt:S[k]}}o(P),c(`${te+1}~${xe}    .`,"success")}catch(S){c("  : "+S.message,"error")}finally{R(!1)}};return h.jsxs("div",{className:"w-full h-full flex flex-col gap-6 p-6 overflow-y-auto custom-scrollbar pb-32",children:[n&&h.jsxs("div",{className:"bg-indigo-900/80 border border-indigo-500 p-4 rounded-xl flex items-center justify-between animate-pulse shadow-lg shadow-indigo-500/20",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-6 h-6 border-2 border-indigo-400 border-t-transparent rounded-full animate-spin"}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-bold text-white",children:"AI    ..."}),h.jsx("p",{className:"text-indigo-200 text-sm",children:" .    ."})]})]}),h.jsxs("div",{className:"text-2xl font-bold text-indigo-300",children:[r.length,"  "]})]}),h.jsxs("div",{className:"flex flex-col xl:flex-row justify-between items-center bg-slate-800 p-6 rounded-xl border border-slate-700 gap-4",children:[h.jsxs("div",{children:[h.jsxs("h2",{className:"text-2xl font-bold text-white mb-2",children:["   (",r.length,")"]}),h.jsx("p",{className:"text-slate-400 text-sm",children:"       ."})]}),h.jsxs("div",{className:"flex gap-3 items-center",children:[q.length>0&&h.jsxs("button",{onClick:B,className:"px-4 py-3 rounded-lg font-bold bg-slate-700 hover:bg-slate-600 text-slate-200 border border-slate-600 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-undo"}),"  "]}),h.jsxs("button",{onClick:ee,className:"px-4 py-3 rounded-lg font-bold bg-red-900/50 hover:bg-red-800 text-red-200 border border-red-700 flex items-center gap-2 transition-all",title:"      . (// )",children:[h.jsx("i",{className:"fas fa-trash-alt"}),"  "]}),h.jsxs("button",{onClick:ve,className:"px-5 py-3 rounded-lg font-bold shadow-lg flex items-center gap-2 border transition-all bg-emerald-700 hover:bg-emerald-600 text-white border-emerald-500",children:[h.jsx("i",{className:"fas fa-file-alt"}),"    ( )"]})]})]}),i.length>0&&h.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl p-6 shadow-lg",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2 mb-2",children:[h.jsx("i",{className:"fas fa-folder-open text-amber-500"}),"    "]}),h.jsxs("p",{className:"text-slate-400 text-sm",children:["     ",h.jsx("code",{children:"//.png"}),"   ."]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:()=>D(!0),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-sm font-bold transition-all flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-user-plus"}),"  ()"]}),h.jsxs("div",{className:"flex items-center gap-1 bg-slate-900/50 rounded-lg p-1 border border-slate-600",children:[h.jsx("input",{type:"text",value:A,onChange:te=>z(te.target.value),onKeyDown:te=>te.key==="Enter"&&L(),placeholder:"  ",className:"bg-transparent text-white text-sm px-2 py-1 w-28 focus:outline-none"}),h.jsx("button",{onClick:L,className:"p-1.5 bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors",title:"    .",children:h.jsx("i",{className:"fas fa-plus"})})]}),h.jsxs("button",{onClick:Z,className:"px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg text-sm font-bold transition-all flex items-center gap-2",title:"           .",children:[h.jsx("i",{className:"fas fa-sync-alt"}),"     "]})]})]}),F&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 backdrop-blur-sm",children:h.jsx("div",{className:"w-full max-w-6xl h-[90vh] overflow-hidden rounded-2xl bg-slate-900 border border-slate-700 shadow-2xl relative",children:h.jsx(Lm,{onClose:()=>D(!1)})})}),h.jsxs("div",{className:"mb-6 bg-slate-900/50 p-4 rounded-lg border border-slate-600",children:[h.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-2",children:"    (  )"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-slate-500 font-mono text-lg",children:"/"}),h.jsx("input",{type:"text",value:V,onChange:te=>K(te.target.value),placeholder:":  ",className:"flex-1 bg-slate-800 border border-slate-600 rounded px-3 py-2 text-slate-200 focus:border-indigo-500"}),h.jsx("span",{className:"text-slate-500 font-mono text-lg",children:"/ ..."})]})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(te=>h.jsxs("div",{className:"bg-slate-900/50 p-3 rounded-lg border border-slate-700 flex flex-col gap-2 relative group",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("label",{className:"text-sm font-bold text-indigo-300 flex items-center gap-2",children:[te.name,te.isGroup&&h.jsx("span",{className:"text-[10px] bg-slate-700 text-slate-300 px-1 rounded",children:""})]}),h.jsx("button",{onClick:()=>{f({type:"confirm",title:" ",message:`'${te.name}'   ?`,onConfirm:()=>{s(xe=>xe.filter(ce=>ce.id!==te.id)),c(" .","success")}})},className:"text-slate-500 hover:text-red-500 transition-colors px-2",title:" ",children:h.jsx("i",{className:"fas fa-times"})})]}),h.jsx("div",{className:"flex flex-col gap-1",children:h.jsx("div",{className:"w-full bg-slate-800 border border-slate-600 rounded px-3 py-2 text-sm text-slate-200",children:C(te.id)})})]},te.id))})]}),r.length>0&&h.jsx("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 border-b border-slate-700 pb-4",children:h.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:_}).map((te,xe)=>h.jsxs("button",{onClick:()=>w(xe),className:`px-4 py-2 rounded-t-lg font-bold text-sm transition-all ${x===xe?"bg-indigo-600 text-white border-b-2 border-indigo-400":"bg-slate-800 text-slate-400 hover:bg-slate-700"}`,children:["TAB ",xe+1," ",h.jsxs("span",{className:"text-xs opacity-70",children:["(",xe*Lt+1,"~",Math.min((xe+1)*Lt,r.length),")"]})]},xe))})}),r.length>0&&h.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl p-4 shadow-inner",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("h3",{className:"text-lg font-bold text-emerald-400 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-align-left"}),"  (",x+1,")    (",x*Lt+1,"~",Math.min((x+1)*Lt,r.length),")"]}),h.jsxs("button",{onClick:()=>{const te=St[v];let xe="";te&&(xe+=` [  : ${te.name}]
`,xe+=`: ${te.desc}
`,xe+=`: ${te.prompt}
`,xe+=`      .
`,xe+=`

`),xe+=b.map(ce=>{var k;const S=((k=ha.find(I=>I.value===ce.sceneType))==null?void 0:k.label)||" /";let P=`
`;return P+=`  ${ce.sceneNumber} ( 1)
`,P+=` [ : ${S}]
`,P+=`

`,P+=` []
${ce.description||ce.scriptSegment}

`,P+=` [  ]
${ce.englishPrompt||"(   .)"}

`,P+=` [  ]
`,ce.manualImagePaths!==void 0?P+=ce.manualImagePaths:P+=Ie(ce),P}).join(`

`),navigator.clipboard.writeText(xe),c("    !","success")},className:"px-4 py-2 bg-emerald-700 hover:bg-emerald-600 text-white rounded-lg font-bold text-sm flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-copy"}),"   "]})]}),h.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-800 max-h-[800px] overflow-y-auto custom-scrollbar",children:[St[v]&&h.jsx("div",{className:"mb-6 p-4 bg-black border border-slate-800 rounded-lg text-slate-400 font-mono text-sm whitespace-pre-wrap select-text",children:` [  : ${St[v].name}]
: ${St[v].desc}
: ${St[v].prompt}
      .
`}),h.jsx("div",{className:"flex flex-col gap-6",children:b.map(te=>{var ce,S,P;const xe=((ce=ha.find(k=>k.value===te.sceneType))==null?void 0:ce.label)||" /";return h.jsxs("div",{className:"bg-black border border-slate-800 rounded-lg p-6 font-mono text-sm text-slate-300 shadow-sm transition-all hover:border-slate-600",children:[h.jsxs("div",{className:"text-slate-500 mb-4 select-none",children:["",h.jsx("br",{}),"  ",te.sceneNumber," ( ",T.length>0&&y?T.length:"1",")",h.jsx("br",{})," [ : ",xe,"]",h.jsx("br",{}),""]}),h.jsxs("div",{className:"mb-4",children:[h.jsx("div",{className:"text-emerald-500 font-bold mb-1 select-none",children:" []"}),h.jsx("textarea",{value:te.description||te.scriptSegment,onChange:k=>de(te.id,"description",k.target.value),className:"w-full h-24 bg-slate-900/50 border border-slate-700 rounded p-3 text-slate-300 focus:border-emerald-500 focus:outline-none resize-y custom-scrollbar transition-colors"})]}),h.jsxs("div",{className:"mb-4",children:[h.jsx("div",{className:"text-emerald-500 font-bold mb-1 select-none",children:" [ ]"}),h.jsx("textarea",{value:te.englishPrompt||"",onChange:k=>de(te.id,"englishPrompt",k.target.value),placeholder:"(   .)",className:"w-full h-32 bg-slate-900/50 border border-slate-700 rounded p-3 text-slate-300 focus:border-emerald-500 focus:outline-none resize-y custom-scrollbar transition-colors"})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-emerald-500 font-bold mb-2 select-none flex justify-between items-center",children:h.jsx("span",{children:" [  ]"})}),h.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3 p-2 bg-slate-900/80 rounded border border-slate-700",children:[(P=(S=te.casting)==null?void 0:S.mainIds)==null?void 0:P.map(k=>{const I=i.find(N=>N.id===k);return I?h.jsxs("div",{className:"flex items-center gap-2 bg-indigo-900/50 border border-indigo-500/50 px-2 py-1 rounded text-xs text-indigo-200",children:[h.jsx("span",{children:I.name}),h.jsx("button",{onClick:()=>me(te.id,"main",k,"remove"),className:"text-indigo-400 hover:text-red-400 transition-colors",title:"",children:h.jsx("i",{className:"fas fa-times"})})]},k):null}),h.jsxs("div",{className:"relative",children:[h.jsxs("select",{className:"bg-slate-800 border border-slate-600 text-slate-300 text-xs rounded px-2 py-1.5 w-40 focus:outline-none focus:border-emerald-500 transition-colors cursor-pointer hover:bg-slate-700",onChange:k=>{k.target.value&&(me(te.id,"main",k.target.value,"add"),k.target.value="")},defaultValue:"",children:[h.jsx("option",{value:"",disabled:!0,children:"+   "}),i.filter(k=>{var I,N;return!((N=(I=te.casting)==null?void 0:I.mainIds)!=null&&N.includes(k.id))}).sort((k,I)=>k.name.localeCompare(I.name)).map(k=>h.jsx("option",{value:k.id,children:k.name},k.id))]}),h.jsx("div",{className:"absolute right-2 top-1.5 pointer-events-none text-slate-500 text-xs",children:h.jsx("i",{className:"fas fa-chevron-down"})})]})]}),h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"flex justify-between items-center mb-1",children:[h.jsx("span",{className:"text-xs text-slate-400",children:"    ( )"}),h.jsxs("button",{onClick:()=>_e(te.id),className:"text-[10px] bg-slate-700 hover:bg-slate-600 text-white px-2 py-0.5 rounded border border-slate-600 flex items-center gap-1 transition-colors",title:"       .",children:[h.jsx("i",{className:"fas fa-folder-plus"}),"   "]})]}),h.jsx("textarea",{value:te.manualImagePaths!==void 0?te.manualImagePaths:Ie(te),onChange:k=>re(te.id,k.target.value),className:"w-full h-24 bg-slate-900/30 p-3 rounded border border-slate-800 text-slate-300 text-xs font-mono focus:border-indigo-500 focus:outline-none resize-y custom-scrollbar",placeholder:"    .   ."})]})]})]},te.id)})})]})]}),h.jsxs("div",{className:"bg-indigo-900/30 border border-indigo-500/50 rounded-xl p-6 shadow-lg",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("h3",{className:"text-lg font-bold text-indigo-200 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-globe-asia"})," []  / "]}),h.jsx("button",{onClick:le,disabled:M,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-bold shadow-lg transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:M?h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-spinner fa-spin"}),"    ..."]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-magic"}),"      ( )"]})})]}),h.jsx("textarea",{value:m,onChange:te=>p(te.target.value),placeholder:"     .",className:"w-full h-64 bg-slate-800 border border-slate-600 rounded-lg p-3 text-sm text-white focus:ring-2 focus:ring-indigo-500 resize-none leading-relaxed"})]})]})},s_=()=>{var ku;const{script:t,characters:e,referenceImages:n,apiKey:r,selectedStyle:o,showToast:i,openModal:s}=Qt(),a=ne.useRef(null),u=ne.useRef(null),c=ne.useRef(null),f=ne.useRef(null),m=()=>{var O;return(O=a.current)==null?void 0:O.scrollIntoView({behavior:"smooth"})},p=()=>{var O;return(O=u.current)==null?void 0:O.scrollIntoView({behavior:"smooth"})},[g,E]=ne.useState("single"),[v,T]=ne.useState(null),[y,x]=ne.useState(""),[w,_]=ne.useState({dialogue:!1,bgm:!0,sfx:!0}),[b,M]=ne.useState(null),[R,F]=ne.useState(!1),[D,V]=ne.useState(""),[K,A]=ne.useState(10),[z,C]=ne.useState(3),[q,ue]=ne.useState([]),[$,Y]=ne.useState(!1),L=async()=>{if(!r)return i("API  .","warning");if(!v)return i("     .","warning");if(!D.trim())return i("  .","warning");const O=q.length+1;Y(!0);try{const J=await qC(r,D,v,{sceneCount:z,startSceneNumber:O});ue(fe=>[...fe,...J]),i(`${J.length}  ! ( ${q.length+J.length})`,"success")}catch(J){i(J.message,"error")}finally{Y(!1)}},Z=async()=>{if(q.length!==0)try{const O=new Um;q.forEach((fe,Q)=>{const j=`scene_${(Q+1).toString().padStart(2,"0")}.json`;O.file(j,JSON.stringify(fe,null,2))});const J=await O.generateAsync({type:"blob"});Tl.saveAs(J,`story_scenes_${Date.now()}.zip`),i("  ZIP  .","success")}catch(O){console.error("ZIP creation failed",O),i("ZIP   .","error")}},[G,B]=ne.useState("auto"),[me,de]=ne.useState("auto"),[re,_e]=ne.useState(null),[Ie,ve]=ne.useState(!1),[ee,le]=ne.useState(null),[te,xe]=ne.useState(!1),[ce,S]=ne.useState(!1),[P,k]=ne.useState(null),[I,N]=ne.useState([]),[U,X]=ne.useState([]),[W,H]=ne.useState(!1),[oe,he]=ne.useState(!1),[ie,Ee]=ne.useState(null),[Ne,we]=ne.useState(!1),[Be,tn]=ne.useState(""),[Ze,zt]=ne.useState(""),[Oe,nn]=ne.useState([{name:" ()",value:"sans-serif"},{name:" ()",value:"serif"},{name:"",value:"Gungsuh, serif"},{name:"",value:"Gulim, sans-serif"},{name:"",value:"Dotum, sans-serif"},{name:"Impact ( )",value:"Impact, sans-serif"},{name:"Arial Black",value:'"Arial Black", sans-serif'},{name:"",value:'"Nanum Gothic", sans-serif'},{name:"",value:'"Nanum Myeongjo", serif'},{name:" ",value:'"BM DoHyeon", sans-serif'},{name:" ",value:'"BM Jua", sans-serif'}]),[Nt,ft]=ne.useState([]);ne.useEffect(()=>{(async()=>{if(typeof window<"u"){const J=await go("bangtong-hooking-texts");J&&N(J);const fe=await go("bangtong-thumbnail-data");fe&&(fe.characters&&Array.isArray(fe.characters)?le(fe):(await Mi("bangtong-thumbnail-data"),le(null)));const Q=await go("bangtong-suno-lyrics");Q&&_e(Q);const j=await go("bangtong-favorite-fonts");j&&Array.isArray(j)&&ft(j)}})()},[]),ne.useEffect(()=>{Nt.length>0&&mo("bangtong-favorite-fonts",Nt)},[Nt]),ne.useEffect(()=>{I.length>0&&mo("bangtong-hooking-texts",I)},[I]),ne.useEffect(()=>{ee&&mo("bangtong-thumbnail-data",ee)},[ee]),ne.useEffect(()=>{re&&mo("bangtong-suno-lyrics",re)},[re]);const Yn=()=>{confirm("    ?")&&(T(null),x(""),M(null),V(""),ue([]))},se=O=>{var Q;const J=(Q=O.target.files)==null?void 0:Q[0];if(!J)return;if(J.size>5*1024*1024){i("   5MB  .","warning");return}const fe=new FileReader;fe.onload=j=>{var pe;(pe=j.target)!=null&&pe.result&&T(j.target.result)},fe.readAsDataURL(J)},ye=async()=>{if(!r)return i("API  .","warning");if(!v)return i("  .","warning");if(!y.trim())return i(" () .","warning");F(!0);try{const O=await jC(r,v,y,w);M(O),i("  (JSON) !","success")}catch(O){i(O.message,"error")}finally{F(!1)}},Te=async()=>{if(!r)return i("API  .","warning");ve(!0);try{const O=await ZC(r,[],G,me);_e(O),i("Suno  !","success")}catch(O){i(O.message,"error")}finally{ve(!1)}},be=async()=>{confirm("  ?")&&(_e(null),await Mi("bangtong-suno-lyrics"))},Ve=async O=>{var J;if(!t)return i(" .","warning");if(!r)return i("API  .","warning");xe(!0);try{const fe=await WC(r,t,e,G,O),Q=fe.characters.map(pe=>{const Pe=e.find(Me=>Me.name===pe.name);return{...pe,appearance:Pe?Pe.description:""}}),j=O?[{id:"line-1",text:O,color:"#FFFFFF",size:48,x:10,y:50,fontFamily:"sans-serif",fontWeight:"900",outlineColor:"#000000",outlineWidth:8,heightScale:1,letterSpacing:0,enableShadow:!0}]:[{id:"line-1",text:fe.title,color:"#FFFFFF",size:48,x:10,y:50,fontFamily:"sans-serif",fontWeight:"900",outlineColor:"#000000",outlineWidth:8,heightScale:1,letterSpacing:0,enableShadow:!0}];le({title:fe.title,composition:(J=fe.composition)!=null&&J.toLowerCase().includes("right")?"right":"center",action:fe.action,characters:Q,textLines:j,gradientDirection:"left-to-right",gradientPosition:40,negativeSpaceRatio:40,enableGradient:!0}),i("  !","success")}catch(fe){i(fe.message,"error")}finally{xe(!1)}},st=(O,J)=>{le(fe=>fe?{...fe,[O]:J}:null)},xt=O=>{const J=e.find(fe=>fe.id===O);!J||!ee||le(fe=>fe?fe.characters.some(Q=>Q.name===J.name)?fe:{...fe,characters:[...fe.characters,{name:J.name,action:"Standing",appearance:J.description}]}:null)},un=(O,J,fe)=>{le(Q=>{if(!Q)return null;const j=[...Q.characters];return j[O]={...j[O],[J]:fe},{...Q,characters:j}})},Ke=O=>{le(J=>{if(!J)return null;const fe=J.characters.filter((Q,j)=>j!==O);return{...J,characters:fe}})},dr=O=>{if(!ee)return;const J=ee.characters[O];s({type:"textarea",title:`${J.name}  `,message:`${J.name}   .`,defaultValue:J.appearance||"",onConfirm:fe=>un(O,"appearance",fe||""),confirmText:"",showCopyButton:!0})},Os=async()=>{if(ee){xe(!0);try{const O=ee.characters.map(Le=>{const fr=e.find(Zr=>Zr.name===Le.name);if(!fr||!fr.referenceImageId)return null;const Ko=n.find(Zr=>Zr.id===fr.referenceImageId);return Ko?{name:Le.name,imageUrl:Ko.imageUrl}:null}).filter(Le=>Le!==null),J=O.map(Le=>Le.imageUrl),fe=O.map(Le=>Le.name),Q=ee.characters.map(Le=>` CHARACTER: ${Le.name}
  - ACTION: ${Le.action}
  - APPEARANCE: ${Le.appearance||"(Follow Reference Image)"}`).join(`
`),j=ee.composition||"center";let pe="";j==="right"?pe=`
        [YOUTUBE THUMBNAIL COMPOSITION - RIGHT SIDE FOCUS]
        - **RULE OF THIRDS**: The main character MUST be positioned on the **RIGHT SIDE** (Right 1/3) of the screen.
        - **BACKGROUND**: The left side should feature a detailed background relevant to the scene. **DO NOT LEAVE IT EMPTY/BLACK**. Fill it with environment/scenery.
        - **FACE POSITION**: The character's face must be located in the **RIGHT THIRD** of the image.
        - **CAMERA**: Wide shot or Medium shot allowing space on the left for text.
            `:pe=`
        [YOUTUBE THUMBNAIL COMPOSITION - CENTER FOCUS]
        - **CENTER PLACEMENT**: The main character MUST be positioned in the **CENTER** of the screen.
        - **SYMMETRY**: Balanced composition with the character in the middle.
        - **BACKGROUND**: Detailed background filling the entire screen behind the character.
            `;const Pe=`
        ${pe}
        
        [SCENE ACTION]
        ${ee.action}

        [CHARACTERS]
        ${Q}

        [STYLE ENFORCEMENT]
        - **ART STYLE**: ${St[o].name}
        - **DESCRIPTION**: ${St[o].desc}
        - **LIGHTING**: High contrast, dramatic lighting.
        - **NEGATIVE PROMPT**: **PHOTOREALISTIC**, **REALISTIC**, **3D RENDER**, Text, Font, Letter, Alphabet, Number, Logo, UI, Watermark, Split screen.
        `,Me=await YC(r,Pe,o,"16:9","character",J,void 0,void 0,void 0,void 0,void 0,fe);le(Le=>Le?{...Le,imageUrl:Me,imageHistory:[Me,...Le.imageHistory||[]]}:null),i("  !","success")}catch(O){i(O.message,"error")}finally{xe(!1)}}},Au=()=>{f.current&&(f.current.value="",f.current.click())},Gm=O=>{var Q;const J=(Q=O.target.files)==null?void 0:Q[0];if(!J)return;if(J.size>5*1024*1024){i("   5MB  .","warning");return}const fe=new FileReader;fe.onloadend=()=>{fe.result&&(le(j=>j?{...j,imageUrl:fe.result}:null),i("  .","success"))},fe.readAsDataURL(J)},Bm=async()=>{var O;if(!window.isSecureContext){i("   HTTPS  localhost  .","error");return}if(!("queryLocalFonts"in window)){i("      . (Chrome/Edge  )","error");return}we(!0);try{const J=await window.queryLocalFonts();if(!Array.isArray(J)||J.length===0){i("    . (    )","warning");return}const fe=new Set,Q=[];for(const j of J){const pe=j.fullName||j.family,Pe=j.family;fe.has(pe)||(fe.add(pe),Q.push({name:pe,value:`"${Pe}", sans-serif`}))}Q.sort((j,pe)=>j.name.localeCompare(pe.name,"ko")),nn(j=>{const pe=new Set(j.map(Me=>Me.name)),Pe=Q.filter(Me=>!pe.has(Me.name));return Pe.length===0&&Q.length>0?j:[...j,...Pe]}),i(`${Q.length}    !`,"success")}catch(J){console.error("Local Font Error:",J),J.name==="SecurityError"||(O=J.message)!=null&&O.includes("permission")?i("   .    .","error"):i(`  : ${J.message||"   "}`,"error")}finally{we(!1)}},Ru=()=>{if(!Ze.trim())return;const O=Ze.trim(),J=`"${O}", "${O.replace(/\s/g,"")}", sans-serif`;nn(fe=>{const Q=fe.findIndex(j=>j.name===O);if(Q>=0){const j=[...fe];return j[Q]={name:O,value:J},j}return[{name:O,value:J},...fe]}),zt(""),i(`'${O}'  .`,"success")},Hm=O=>{ft(J=>J.includes(O)?J.filter(fe=>fe!==O):[...J,O])},Vm=async()=>{if(!(!ee||!ee.imageUrl)){i("   ...","info");try{const J=await(await fetch(ee.imageUrl)).blob(),fe=await createImageBitmap(J),Q=document.createElement("canvas");Q.width=fe.width,Q.height=fe.height;const j=Q.getContext("2d");if(!j)throw new Error("Canvas context creation failed");if(j.drawImage(fe,0,0),ee.enableGradient&&ee.gradientDirection){const pe=ee.gradientDirection,Pe=ee.gradientPosition||40;let Me;if(pe==="left-to-right"){Me=j.createLinearGradient(0,0,Q.width,0);const Le=Pe/100;Me.addColorStop(0,"rgba(0,0,0,0.95)"),Me.addColorStop(Le*.4,"rgba(0,0,0,0.7)"),Me.addColorStop(Le,"rgba(0,0,0,0)")}else{Me=j.createLinearGradient(0,Q.height,0,0);const Le=Pe/100;Me.addColorStop(0,"rgba(0,0,0,0.95)"),Me.addColorStop(Le*.4,"rgba(0,0,0,0.7)"),Me.addColorStop(Le,"rgba(0,0,0,0)")}j.fillStyle=Me,j.fillRect(0,0,Q.width,Q.height)}ee.textLines&&(await document.fonts.ready,ee.textLines.forEach(pe=>{const Pe=Q.width*(pe.size/1e3);let Me="sans-serif";if(pe.fontFamily){const Qr=pe.fontFamily.match(/"([^"]+)"/);Qr?Me=Qr[1]:Me=pe.fontFamily.split(",")[0].trim()}const Le=pe.fontWeight||"900";j.font=`${Le} ${Pe}px "${Me}", sans-serif`,j.fillStyle=pe.color,j.textBaseline="middle";const fr=pe.heightScale||1;j.lineWidth=Pe*((pe.outlineWidth??8)/100)*(fr>=1?fr:1),j.strokeStyle=pe.outlineColor||"black",j.lineJoin="round",j.miterLimit=2,pe.letterSpacing?j.letterSpacing=`${pe.letterSpacing}px`:j.letterSpacing="0px",pe.enableShadow?(j.shadowBlur=Pe*.1,j.shadowColor="rgba(0,0,0,0.8)",j.shadowOffsetX=Pe*.05,j.shadowOffsetY=Pe*.05):(j.shadowBlur=0,j.shadowColor="transparent",j.shadowOffsetX=0,j.shadowOffsetY=0);const Ko=Q.width*(pe.x/100),Zr=Q.height*(pe.y/100),Pu=pe.text.split(`
`),Us=Pe*1.1,qm=Pu.length*Us;j.save(),j.translate(Ko,Zr),j.scale(1,pe.heightScale||1);const Ym=-(qm/2)+Us/2;Pu.forEach((Qr,Km)=>{const Mu=Ym+Km*Us;j.strokeText(Qr,0,Mu),j.fillText(Qr,0,Mu)}),j.restore()})),Q.toBlob(pe=>{if(pe){const Pe=URL.createObjectURL(pe),Me=document.createElement("a");Me.href=Pe,Me.download=`thumbnail_complete_${Date.now()}.png`,Me.click(),URL.revokeObjectURL(Pe),i("   .","success")}},"image/png")}catch(O){console.error("Thumbnail composite failed",O),i("   .","error")}}},zm=async()=>{if(!t)return i(" .","warning");if(!r)return i("API  .","warning");H(!0),X([]);try{const O=await XC(r,t);N(O),i(`  ${O.length} !`,"success")}catch(O){i(O.message,"error")}finally{H(!1)}},$m=O=>{X(J=>J.includes(O)?J.filter(fe=>fe!==O):[...J,O])},jm=()=>{if(U.length===0)return i("  .","warning");const O=U.join(`
`),J=new Blob([O],{type:"text/plain;charset=utf-8"});Tl.saveAs(J,"selected_hooking_texts.txt"),i(`${U.length}    .`,"success")},Wm=O=>{navigator.clipboard.writeText(O),i("!","success")};return h.jsxs("div",{className:"space-y-8 animate-fade-in pb-20 relative",children:[h.jsx("div",{ref:a}),h.jsx("input",{type:"file",ref:c,onChange:se,className:"hidden",accept:"image/*"}),h.jsx("input",{type:"file",ref:f,onChange:Gm,className:"hidden",accept:"image/*"}),h.jsxs("div",{className:"fixed left-6 bottom-20 flex flex-col gap-2 z-50",children:[h.jsx("button",{onClick:m,className:"bg-slate-700/80 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg backdrop-blur-sm border border-slate-600 transition-all",children:h.jsx("i",{className:"fas fa-arrow-up"})}),h.jsx("button",{onClick:p,className:"bg-slate-700/80 hover:bg-indigo-600 text-white p-3 rounded-full shadow-lg backdrop-blur-sm border border-slate-600 transition-all",children:h.jsx("i",{className:"fas fa-arrow-down"})})]}),h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-slate-800 p-8 rounded-2xl border border-slate-700 shadow-xl relative overflow-hidden mb-8",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500"}),h.jsxs("div",{className:"z-10 mb-4 md:mb-0",children:[h.jsxs("h2",{className:"text-3xl font-extrabold text-white mb-2 flex items-center gap-3",children:[h.jsx("i",{className:"fas fa-video text-red-500"}),"  ( )"]}),h.jsx("p",{className:"text-slate-400",children:"  (JSON), ,     ."})]}),h.jsx("div",{className:"flex items-center gap-3",children:h.jsxs("button",{onClick:Yn,className:"bg-slate-700 hover:bg-slate-600 text-slate-300 hover:text-white px-4 py-3 rounded-lg font-bold shadow-lg transition-all",title:"  ",children:[h.jsx("i",{className:"fas fa-trash-alt mr-2"})," "]})})]}),h.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-700 mb-10",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-clapperboard text-indigo-500"}),"    (Scene Maker)"]}),h.jsxs("div",{className:"flex bg-slate-800 p-1 rounded-lg",children:[h.jsx("button",{onClick:()=>E("single"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all ${g==="single"?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:" "}),h.jsx("button",{onClick:()=>E("story"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all ${g==="story"?"bg-purple-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:"  (10~15)"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"border-2 border-dashed border-slate-600 rounded-lg p-6 flex flex-col items-center justify-center min-h-[300px] cursor-pointer hover:border-indigo-500 hover:bg-slate-800/50 transition-all relative overflow-hidden group",onClick:()=>{var O;return(O=c.current)==null?void 0:O.click()},children:[v?h.jsx("img",{src:v,alt:"Input",className:"w-full h-full object-contain absolute inset-0"}):h.jsxs("div",{className:"text-center text-slate-500",children:[h.jsx("i",{className:"fas fa-image text-4xl mb-3"}),h.jsx("p",{children:" "}),h.jsx("p",{className:"text-xs mt-1",children:g==="story"?"(   )":"(    )"})]}),h.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity",children:h.jsxs("p",{className:"text-white font-bold",children:[h.jsx("i",{className:"fas fa-upload mr-2"})," "]})})]}),g==="single"?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-sm font-bold text-slate-400",children:"  ()"}),h.jsx("textarea",{value:y,onChange:O=>x(O.target.value),placeholder:":     . (   )",className:"w-full bg-slate-800 text-white border border-slate-600 rounded p-3 h-32 focus:ring-2 focus:ring-indigo-500 outline-none resize-none"})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-slate-300 select-none",children:[h.jsx("input",{type:"checkbox",checked:w.dialogue,onChange:O=>_(J=>({...J,dialogue:O.target.checked})),className:"w-4 h-4 accent-indigo-500"})," "]}),h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-slate-300 select-none",children:[h.jsx("input",{type:"checkbox",checked:w.bgm,onChange:O=>_(J=>({...J,bgm:O.target.checked})),className:"w-4 h-4 accent-indigo-500"}),"BGM "]}),h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-slate-300 select-none",children:[h.jsx("input",{type:"checkbox",checked:w.sfx,onChange:O=>_(J=>({...J,sfx:O.target.checked})),className:"w-4 h-4 accent-indigo-500"})," "]})]}),h.jsxs("button",{onClick:ye,disabled:R,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white py-4 rounded-lg font-bold shadow-lg flex items-center justify-center gap-2 transition-all",children:[R?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-magic"}),"  (JSON) "]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-sm font-bold text-slate-400",children:"  ()"}),h.jsx("textarea",{value:D,onChange:O=>V(O.target.value),placeholder:"   . AI   .",className:"w-full bg-slate-800 text-white border border-slate-600 rounded p-3 h-40 focus:ring-2 focus:ring-purple-500 outline-none resize-none"})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("label",{className:"text-sm font-bold text-slate-400",children:"  (  ):"}),h.jsx("input",{type:"number",value:z,onChange:O=>C(Number(O.target.value)),min:1,max:5,className:"bg-slate-800 text-white border border-slate-600 rounded px-3 py-2 w-20 focus:ring-2 focus:ring-purple-500 outline-none"}),h.jsx("span",{className:"text-xs text-slate-500",children:"(1~5 )"})]}),q.length>0&&h.jsxs("div",{className:"text-xs text-slate-400 bg-slate-900/50 p-2 rounded",children:["  : ",h.jsxs("span",{className:"text-white font-bold",children:[q.length,""]}),"(   Scene #",q.length+1," )"]}),h.jsxs("button",{onClick:L,disabled:$,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white py-4 rounded-lg font-bold shadow-lg flex items-center justify-center gap-2 transition-all",children:[$?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-film"}),q.length>0?` ${z}   (Append)`:"    "]})]})]}),h.jsxs("div",{className:"bg-slate-950 rounded-lg border border-slate-800 p-4 overflow-hidden flex flex-col h-[600px]",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2 shrink-0",children:[h.jsx("span",{className:"text-xs font-bold text-slate-500",children:"GENERATED JSON SPEC"}),h.jsxs("div",{className:"flex gap-2",children:[g==="story"&&q.length>0&&h.jsxs(h.Fragment,{children:[h.jsxs("button",{onClick:()=>{confirm("     ?")&&(ue([]),i(" .","info"))},className:"text-xs bg-red-900/50 hover:bg-red-800 text-red-200 px-3 py-1 rounded font-bold border border-red-800",title:"  ( )",children:[h.jsx("i",{className:"fas fa-trash-alt mr-1"})," "]}),h.jsxs("button",{onClick:Z,className:"text-xs bg-green-800 hover:bg-green-700 text-green-100 px-3 py-1 rounded font-bold",children:[h.jsx("i",{className:"fas fa-file-archive mr-1"})," ZIP "]})]}),h.jsxs("button",{onClick:()=>{var J,fe;let O="";g==="single"&&b?(O=b.video_prompt,(J=b.dialogue)!=null&&J.enabled&&((fe=b.dialogue)!=null&&fe.text)&&(O+=`

[KOREAN] "${b.dialogue.text}"`)):g==="story"&&q.length>0&&(O=q.map((Q,j)=>{var Pe,Me;let pe=`[Scene ${j+1}]
${Q.video_prompt}`;if((Pe=Q.dialogue)!=null&&Pe.enabled&&((Me=Q.dialogue)!=null&&Me.text)){let Le=Q.dialogue.text.trim();Le.startsWith("[KOREAN]")||(Le=`[KOREAN] "${Le}"`),pe+=`

${Le}`}return pe}).join(`

--------------------------------

`)),O&&(navigator.clipboard.writeText(O),i("  .","success"))},disabled:g==="single"&&!b||g==="story"&&q.length===0,className:"text-xs bg-indigo-800 hover:bg-indigo-700 text-indigo-100 px-3 py-1 rounded font-bold",title:"    ",children:[h.jsx("i",{className:"fas fa-align-left mr-1"}),"  "]}),h.jsxs("button",{onClick:()=>{const O=fe=>{const Q=j=>{const{base_image:pe,...Pe}=j;return Pe};return Array.isArray(fe)?fe.map(Q):Q(fe)},J=JSON.stringify(O(g==="single"?b:q),null,2);J&&J!=="null"&&J!=="[]"&&(navigator.clipboard.writeText(J),i("JSON(  ) .","success"))},disabled:g==="single"&&!b||g==="story"&&q.length===0,className:"text-xs bg-slate-800 hover:bg-slate-700 text-slate-300 px-2 py-1 rounded",title:"JSON    ( )",children:[h.jsx("i",{className:"fas fa-code mr-1"})," JSON "]})]})]}),h.jsx("div",{className:"flex-1 bg-black/50 rounded p-4 overflow-auto font-mono text-xs text-green-400 scrollbar-thin scrollbar-thumb-slate-700",children:g==="single"?b?h.jsx("pre",{className:"whitespace-pre-wrap break-all",children:JSON.stringify((({base_image:O,...J})=>J)(b),null,2)}):h.jsx("div",{className:"h-full flex items-center justify-center text-slate-700",children:"JSON   ."}):q.length>0?h.jsx("div",{className:"space-y-4",children:q.map((O,J)=>h.jsxs("div",{className:"border-b border-slate-800 pb-4 mb-4 last:border-0 last:pb-0",children:[h.jsxs("div",{className:"text-slate-500 font-bold mb-1",children:["[Scene ",J+1,"]"]}),h.jsx("pre",{className:"whitespace-pre-wrap break-all text-green-400",children:JSON.stringify((({base_image:fe,...Q})=>Q)(O),null,2)})]},J))}):h.jsx("div",{className:"h-full flex items-center justify-center text-slate-700",children:"    ."})})]})]})]}),h.jsxs("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-700 mb-10",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-music text-blue-400"}),"    (Suno AI)"]}),h.jsxs("div",{className:"flex gap-4 mt-2",children:[h.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700 w-fit",children:[h.jsx("span",{className:"text-xs font-bold text-slate-400 px-2",children:":"}),h.jsxs("select",{value:G,onChange:O=>B(O.target.value),className:"bg-slate-800 text-white text-sm border border-slate-600 rounded px-3 py-1.5 focus:ring-2 focus:ring-red-500 outline-none",children:[h.jsx("option",{value:"auto",children:" "}),h.jsx("option",{value:"mystery",children:" "}),h.jsx("option",{value:"comedy",children:" "}),h.jsx("option",{value:"destiny",children:" /"}),h.jsx("option",{value:"tragedy",children:" /"}),h.jsx("option",{value:"revenge",children:" "}),h.jsx("option",{value:"despair",children:" /"})]})]}),h.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/50 p-2 rounded-lg border border-slate-700 w-fit",children:[h.jsx("span",{className:"text-xs font-bold text-slate-400 px-2",children:":"}),h.jsxs("select",{value:me,onChange:O=>de(O.target.value),className:"bg-slate-800 text-white text-sm border border-slate-600 rounded px-3 py-1.5 focus:ring-2 focus:ring-blue-500 outline-none min-w-[150px]",children:[h.jsx("option",{value:"auto",children:"  "}),h.jsx("option",{value:"fast_exciting",children:" /"}),h.jsx("option",{value:"sad_sorrowful",children:" /"}),h.jsx("option",{value:"faint_hazy",children:" /"}),h.jsx("option",{value:"slow_mystery",children:" /"}),h.jsx("option",{value:"medium_story",children:" /"}),h.jsx("option",{value:"grand_epic",children:" /"})]})]})]})]}),h.jsxs("div",{className:"flex gap-2",children:[re&&h.jsx("button",{onClick:be,className:"bg-red-900/50 hover:bg-red-800 text-red-200 px-4 py-2.5 rounded-lg font-bold shadow-lg transition-all whitespace-nowrap border border-red-700/50",title:" ",children:h.jsx("i",{className:"fas fa-trash-alt"})}),h.jsxs("button",{onClick:Te,disabled:Ie,className:"bg-blue-600 hover:bg-blue-500 text-white px-5 py-2.5 rounded-lg font-bold shadow-lg flex items-center gap-2 transition-all whitespace-nowrap",children:[Ie?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-microphone-alt"}),re?"  ":"Suno  "]})]})]}),re&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-slate-950/50 rounded-lg p-6 border border-slate-800",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Song Title"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("input",{readOnly:!0,value:re.title,className:"bg-slate-900 text-white text-lg font-bold border border-slate-700 rounded px-3 py-2 w-full focus:ring-1 focus:ring-blue-500 outline-none"}),h.jsx("button",{onClick:()=>{navigator.clipboard.writeText(re.title),i("","success")},className:"bg-slate-800 hover:bg-slate-700 text-slate-300 p-3 rounded border border-slate-700",children:h.jsx("i",{className:"fas fa-copy"})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Style (English)"}),h.jsxs("div",{className:"relative",children:[h.jsx("textarea",{readOnly:!0,value:re.style_en,className:"bg-slate-900 text-blue-300 text-sm border border-slate-700 rounded p-3 w-full h-20 resize-none focus:ring-1 focus:ring-blue-500 outline-none"}),h.jsx("button",{onClick:()=>{navigator.clipboard.writeText(re.style_en),i("","success")},className:"absolute top-2 right-2 text-slate-500 hover:text-white bg-slate-800/80 p-1.5 rounded",children:h.jsx("i",{className:"fas fa-copy"})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Style (Korean)"}),h.jsxs("div",{className:"relative",children:[h.jsx("textarea",{readOnly:!0,value:re.style_ko,className:"bg-slate-900 text-green-300 text-sm border border-slate-700 rounded p-3 w-full h-20 resize-none focus:ring-1 focus:ring-green-500 outline-none"}),h.jsx("button",{onClick:()=>{navigator.clipboard.writeText(re.style_ko),i("","success")},className:"absolute top-2 right-2 text-slate-500 hover:text-white bg-slate-800/80 p-1.5 rounded",children:h.jsx("i",{className:"fas fa-copy"})})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase block mb-1",children:"Lyrics"}),h.jsxs("div",{className:"relative",children:[h.jsx("textarea",{readOnly:!0,value:re.lyrics,className:"bg-slate-900 text-slate-300 text-sm border border-slate-700 rounded p-3 w-full h-48 resize-none focus:ring-1 focus:ring-blue-500 outline-none font-mono leading-relaxed"}),h.jsx("button",{onClick:()=>{navigator.clipboard.writeText(re.lyrics),i("","success")},className:"absolute top-2 right-2 text-slate-500 hover:text-white bg-slate-800/80 p-1.5 rounded",children:h.jsx("i",{className:"fas fa-copy"})})]})]})]})]}),h.jsxs("div",{className:"border-t border-slate-700 pt-10 mt-10",children:[h.jsx("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-700 mb-10",children:h.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[h.jsxs("div",{className:"w-full md:w-1/4 space-y-4",children:[h.jsxs("h4",{className:"text-lg font-bold text-white flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-image text-purple-400"}),"  "]}),ee?h.jsxs("div",{className:"space-y-3 animate-fade-in",children:[h.jsxs("div",{className:"bg-slate-800 p-3 rounded border border-slate-600",children:[h.jsx("p",{className:"text-xs text-purple-300 font-bold mb-1",children:""}),h.jsx("p",{className:"text-white font-bold text-base leading-tight",children:ee.title})]}),h.jsxs("div",{className:"bg-slate-800 p-3 rounded border border-slate-600",children:[h.jsxs("div",{className:"flex justify-between items-center mb-1",children:[h.jsx("p",{className:"text-xs text-slate-400 font-bold",children:" "}),h.jsx("button",{onClick:()=>s({type:"textarea",title:"  ",message:"   .",defaultValue:ee.action,onConfirm:O=>st("action",O||""),confirmText:"",showCopyButton:!0}),className:"text-[10px] bg-slate-700 hover:bg-slate-600 text-slate-300 px-1.5 py-0.5 rounded border border-slate-600",children:""})]}),h.jsx("textarea",{className:"w-full bg-slate-900 text-slate-300 text-[11px] leading-relaxed p-2 rounded border border-slate-700 focus:border-purple-500 focus:outline-none resize-none h-20 scrollbar-thin scrollbar-thumb-slate-600",value:ee.action,onChange:O=>st("action",O.target.value)})]}),h.jsxs("div",{className:"bg-slate-800 p-3 rounded border border-slate-600",children:[h.jsx("p",{className:"text-xs text-indigo-400 font-bold uppercase mb-2",children:" (Composition)"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>le(O=>O?{...O,composition:"center"}:null),className:`flex-1 py-1 rounded text-xs border ${!ee.composition||ee.composition==="center"?"bg-indigo-600 text-white border-indigo-400":"bg-slate-700 text-slate-400 border-slate-600"}`,children:""}),h.jsx("button",{onClick:()=>le(O=>O?{...O,composition:"right"}:null),className:`flex-1 py-1 rounded text-xs border ${ee.composition==="right"?"bg-indigo-600 text-white border-indigo-400":"bg-slate-700 text-slate-400 border-slate-600"}`,children:""})]})]}),h.jsxs("div",{className:"bg-slate-800 p-3 rounded border border-slate-600 space-y-2",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("p",{className:"text-xs text-green-500 font-bold uppercase",children:" "}),h.jsxs("select",{className:"bg-slate-900 text-[10px] text-slate-300 border border-slate-600 rounded px-1 py-0.5 max-w-[80px]",onChange:O=>{O.target.value&&xt(O.target.value),O.target.value=""},children:[h.jsx("option",{value:"",children:"+ "}),e&&e.map(O=>h.jsx("option",{value:O.id,children:O.name},O.id))]})]}),h.jsx("div",{className:"space-y-1.5 max-h-[150px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-slate-700",children:ee.characters&&ee.characters.map((O,J)=>h.jsxs("div",{className:"bg-slate-900 p-2 rounded border border-slate-700 flex items-center justify-between",children:[h.jsx("span",{className:"text-xs font-bold text-white truncate mr-2",children:O.name}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:()=>dr(J),className:"text-indigo-400 hover:text-white p-1",children:h.jsx("i",{className:"fas fa-edit"})}),h.jsx("button",{onClick:()=>Ke(J),className:"text-slate-500 hover:text-red-400 p-1",children:h.jsx("i",{className:"fas fa-times"})})]})]},J))})]}),h.jsxs("div",{className:"flex gap-2 flex-wrap",children:[h.jsxs("button",{onClick:Os,disabled:te,className:"flex-1 bg-pink-600 hover:bg-pink-500 text-white px-3 py-2 rounded-lg font-bold shadow-lg flex items-center justify-center gap-1 text-sm min-w-[80px]",children:[te?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-paint-brush"}),""]}),h.jsx("button",{onClick:Au,className:"bg-slate-600 hover:bg-slate-500 text-white px-3 py-2 rounded-lg font-bold shadow-lg flex items-center justify-center gap-1 text-sm",title:" ",children:h.jsx("i",{className:"fas fa-upload"})}),h.jsx("button",{onClick:()=>{confirm("  ?")&&(le(null),Mi("bangtong-thumbnail-data"))},className:"bg-slate-700 hover:bg-slate-600 text-slate-300 px-3 py-2 rounded-lg text-sm",title:"",children:h.jsx("i",{className:"fas fa-trash-alt"})})]})]}):h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{className:"text-slate-400 text-sm",children:"     ."}),h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsxs("button",{onClick:()=>Ve(),disabled:te,className:"flex-1 bg-purple-600 hover:bg-purple-500 text-white px-4 py-3 rounded-lg font-bold shadow-lg flex items-center justify-center gap-2",children:[te?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-brain"}),"1. "]}),h.jsx("button",{onClick:Au,className:"bg-slate-600 hover:bg-slate-500 text-white px-3 py-3 rounded-lg font-bold shadow-lg flex items-center justify-center gap-2",title:" ",children:h.jsx("i",{className:"fas fa-upload"})})]})]})]}),h.jsxs("div",{className:"w-full md:w-3/4 flex flex-col gap-0 bg-slate-900 rounded-lg border border-slate-800 overflow-hidden",children:[h.jsx("div",{className:"w-full bg-slate-950 relative overflow-hidden group aspect-video border-2 border-slate-700 rounded-lg shadow-inner",style:{containerType:"size"},children:ee!=null&&ee.imageUrl?h.jsxs("div",{className:"relative w-full h-full flex items-center justify-center overflow-hidden",children:[h.jsx("img",{src:ee.imageUrl,alt:"Thumbnail",className:"w-full h-full object-contain"}),ee.enableGradient&&ee.gradientDirection&&h.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:ee.gradientDirection==="bottom-to-top"?`linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.7) ${(ee.gradientPosition||40)*.4}%, rgba(0,0,0,0) ${ee.gradientPosition||40}%)`:`linear-gradient(to right, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.7) ${(ee.gradientPosition||40)*.4}%, rgba(0,0,0,0) ${ee.gradientPosition||40}%)`}}),ee.textLines&&ee.textLines.map(O=>h.jsx("div",{className:"absolute cursor-move select-none whitespace-pre-wrap leading-tight drop-shadow-[0_4px_4px_rgba(0,0,0,0.8)] hover:ring-2 hover:ring-indigo-500/50 rounded p-1 transition-shadow",style:{left:`${O.x}%`,top:`${O.y}%`,color:O.color,fontSize:`${O.size/10}cqw`,fontFamily:O.fontFamily||"sans-serif",fontWeight:O.fontWeight||"900",maxWidth:"95%",WebkitTextStroke:`${O.size/10*((O.outlineWidth??8)/100)*(O.heightScale&&O.heightScale>=1?O.heightScale:1)}cqw ${O.outlineColor||"#000"}`,textShadow:O.enableShadow?"0.1em 0.1em 0.1em rgba(0,0,0,0.8)":"none",paintOrder:"stroke fill",transform:`translate(0, -50%) scaleY(${O.heightScale||1})`,transformOrigin:"center center",letterSpacing:`${(O.letterSpacing||0)/10}cqw`},draggable:!0,onDragEnd:J=>{},children:O.text},O.id)),h.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3 z-20 pointer-events-none",children:h.jsxs("div",{className:"pointer-events-auto flex gap-3",children:[h.jsx("button",{onClick:()=>k(ee.imageUrl),className:"bg-slate-700 hover:bg-slate-600 text-white p-3 rounded-full",children:h.jsx("i",{className:"fas fa-search-plus"})}),h.jsxs("button",{onClick:Vm,className:"bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-full font-bold shadow-lg",children:[h.jsx("i",{className:"fas fa-download"})," "]})]})})]}):h.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-slate-600",children:[h.jsx("i",{className:"fas fa-image text-4xl mb-2"}),h.jsx("p",{children:"  "})]})}),(ee==null?void 0:ee.imageUrl)&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"w-full bg-slate-900 border-t border-slate-800 p-3 space-y-2",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("span",{className:"text-xs font-bold text-orange-400 uppercase",children:[h.jsx("i",{className:"fas fa-adjust mr-1"}),"  "]}),h.jsxs("div",{className:"relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in",children:[h.jsx("input",{type:"checkbox",name:"toggle",id:"gradient-toggle",checked:!!ee.enableGradient,onChange:O=>le(J=>J?{...J,enableGradient:O.target.checked,gradientDirection:O.target.checked&&!J.gradientDirection?J.composition==="right"?"left-to-right":"bottom-to-top":J.gradientDirection}:null),className:"toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer",style:{right:ee.enableGradient?"0":"50%"}}),h.jsx("label",{htmlFor:"gradient-toggle",className:`toggle-label block overflow-hidden h-5 rounded-full cursor-pointer ${ee.enableGradient?"bg-orange-500":"bg-slate-700"}`})]})]}),ee.enableGradient&&h.jsxs("div",{className:"bg-slate-800 p-2 rounded border border-slate-700 animate-fade-in flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-[10px] text-slate-400",children:""}),h.jsxs("div",{className:"flex bg-slate-900 rounded border border-slate-600 p-0.5",children:[h.jsx("button",{onClick:()=>le(O=>O?{...O,gradientDirection:"left-to-right"}:null),className:`px-2 py-1 text-[10px] rounded ${ee.gradientDirection==="left-to-right"?"bg-orange-600 text-white":"text-slate-400"}`,children:""}),h.jsx("button",{onClick:()=>le(O=>O?{...O,gradientDirection:"bottom-to-top"}:null),className:`px-2 py-1 text-[10px] rounded ${ee.gradientDirection==="bottom-to-top"?"bg-orange-600 text-white":"text-slate-400"}`,children:""})]})]}),h.jsxs("div",{className:"flex items-center gap-2 flex-1 ml-4",children:[h.jsx("span",{className:"text-[10px] text-slate-400",children:""}),h.jsx("input",{type:"range",min:"0",max:"100",value:ee.gradientPosition||40,onChange:O=>le(J=>J?{...J,gradientPosition:parseInt(O.target.value)}:null),className:"flex-1 accent-orange-500 h-1 bg-slate-600 rounded-lg appearance-none cursor-pointer"}),h.jsxs("span",{className:"text-[10px] text-orange-400 w-6 text-right",children:[ee.gradientPosition||40,"%"]})]})]})]}),h.jsxs("div",{className:"w-full bg-slate-900 border-t border-slate-800 p-3 space-y-2",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("span",{className:"text-xs font-bold text-indigo-400 uppercase",children:[h.jsx("i",{className:"fas fa-layer-group mr-1"}),"  "]}),h.jsxs("button",{onClick:()=>le(O=>{var J;return O?{...O,textLines:[...O.textLines||[],{id:`line-${Date.now()}`,text:" ",color:"#FFFFFF",size:40,x:10,y:50+(((J=O.textLines)==null?void 0:J.length)||0)*10,fontFamily:"sans-serif"}]}:null}),className:"text-xs bg-indigo-600 hover:bg-indigo-500 text-white px-2 py-1 rounded",children:[h.jsx("i",{className:"fas fa-plus"}),"  "]})]}),h.jsx("div",{className:"space-y-2 max-h-[200px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-slate-700",children:(ku=ee.textLines)==null?void 0:ku.map((O,J)=>{var fe;return h.jsxs("div",{className:"bg-slate-800 p-2 rounded border border-slate-700 flex flex-col gap-2",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"text",value:O.text,onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],text:Q.target.value},{...j,textLines:pe}}),className:"bg-slate-900 border border-slate-600 rounded px-2 py-1 text-sm text-white flex-1"}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsxs("select",{value:O.fontWeight||"900",onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],fontWeight:Q.target.value},{...j,textLines:pe}}),className:"bg-slate-900 border border-slate-600 rounded px-1 py-1 text-xs text-white max-w-[60px]",children:[h.jsx("option",{value:"100",children:"Thin"}),h.jsx("option",{value:"400",children:"Regular"}),h.jsx("option",{value:"700",children:"Bold"}),h.jsx("option",{value:"900",children:"Black"})]}),h.jsxs("button",{onClick:()=>{Ee(J),he(!0)},className:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded text-xs border border-slate-600 flex items-center gap-1 min-w-[80px] justify-between",children:[h.jsx("span",{className:"truncate max-w-[60px]",children:((fe=Oe.find(Q=>Q.value===O.fontFamily))==null?void 0:fe.name)||""}),h.jsx("i",{className:"fas fa-chevron-down text-[10px] text-slate-400"})]})]}),h.jsx("input",{type:"color",value:O.color,onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],color:Q.target.value},{...j,textLines:pe}}),className:"w-8 h-8 rounded cursor-pointer bg-transparent border-0 shrink-0"}),h.jsx("button",{onClick:()=>le(Q=>{if(!(Q!=null&&Q.textLines))return Q;const j=Q.textLines.filter((pe,Pe)=>Pe!==J);return{...Q,textLines:j}}),className:"text-slate-500 hover:text-red-400 px-1",children:h.jsx("i",{className:"fas fa-times"})})]}),h.jsxs("div",{className:"flex items-center justify-between gap-2",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{className:"text-[10px] text-slate-400",children:""}),h.jsx("input",{type:"number",value:O.size,onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],size:parseInt(Q.target.value)},{...j,textLines:pe}}),className:"w-12 bg-slate-900 border border-slate-600 rounded px-1 py-0.5 text-xs text-white text-center"})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{className:"text-[10px] text-slate-400",children:""}),h.jsx("input",{type:"number",step:"0.1",min:"0.5",max:"3.0",value:O.heightScale??1,onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],heightScale:Q.target.value===""?void 0:parseFloat(Q.target.value)},{...j,textLines:pe}}),className:"w-12 bg-slate-900 border border-slate-600 rounded px-1 py-0.5 text-xs text-white text-center"})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{className:"text-[10px] text-slate-400",children:""}),h.jsx("input",{type:"number",value:O.letterSpacing??0,onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],letterSpacing:Q.target.value===""?void 0:parseInt(Q.target.value)},{...j,textLines:pe}}),className:"w-12 bg-slate-900 border border-slate-600 rounded px-1 py-0.5 text-xs text-white text-center"})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{className:"text-[10px] text-slate-400",children:""}),h.jsx("input",{type:"color",value:O.outlineColor||"#000000",onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],outlineColor:Q.target.value},{...j,textLines:pe}}),className:"w-4 h-4 rounded cursor-pointer bg-transparent border-0"})]}),h.jsxs("div",{className:"flex items-center gap-1 flex-1",children:[h.jsx("span",{className:"text-[10px] text-slate-400 whitespace-nowrap",children:""}),h.jsxs("div",{className:"flex items-center gap-1 flex-1",children:[h.jsx("input",{type:"range",min:"0",max:"50",value:O.outlineWidth??8,onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],outlineWidth:parseInt(Q.target.value)},{...j,textLines:pe}}),className:"flex-1 h-1 bg-slate-600 rounded-lg appearance-none cursor-pointer accent-indigo-500"}),h.jsx("input",{type:"number",value:O.outlineWidth??8,onChange:Q=>le(j=>{if(!(j!=null&&j.textLines))return j;const pe=[...j.textLines];return pe[J]={...pe[J],outlineWidth:Q.target.value===""?void 0:parseInt(Q.target.value)},{...j,textLines:pe}}),className:"w-10 bg-slate-900 border border-slate-600 rounded px-1 py-0.5 text-xs text-white text-center"})]})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{onClick:()=>le(Q=>{if(!(Q!=null&&Q.textLines))return Q;const j=[...Q.textLines];return j[J]={...j[J],y:j[J].y-2},{...Q,textLines:j}}),className:"bg-slate-700 w-5 h-5 rounded text-[10px] hover:bg-slate-600",children:h.jsx("i",{className:"fas fa-arrow-up"})}),h.jsx("button",{onClick:()=>le(Q=>{if(!(Q!=null&&Q.textLines))return Q;const j=[...Q.textLines];return j[J]={...j[J],y:j[J].y+2},{...Q,textLines:j}}),className:"bg-slate-700 w-5 h-5 rounded text-[10px] hover:bg-slate-600",children:h.jsx("i",{className:"fas fa-arrow-down"})}),h.jsx("button",{onClick:()=>le(Q=>{if(!(Q!=null&&Q.textLines))return Q;const j=[...Q.textLines];return j[J]={...j[J],x:j[J].x-2},{...Q,textLines:j}}),className:"bg-slate-700 w-5 h-5 rounded text-[10px] hover:bg-slate-600",children:h.jsx("i",{className:"fas fa-arrow-left"})}),h.jsx("button",{onClick:()=>le(Q=>{if(!(Q!=null&&Q.textLines))return Q;const j=[...Q.textLines];return j[J]={...j[J],x:j[J].x+2},{...Q,textLines:j}}),className:"bg-slate-700 w-5 h-5 rounded text-[10px] hover:bg-slate-600",children:h.jsx("i",{className:"fas fa-arrow-right"})})]})]})]},O.id)})})]}),ee.imageHistory&&ee.imageHistory.length>0&&h.jsxs("div",{className:"w-full bg-slate-950/50 border-t border-slate-800 p-2",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1 px-1",children:[h.jsx("i",{className:"fas fa-history text-slate-500 text-[10px]"}),h.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:""})]}),h.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-thin scrollbar-thumb-slate-700 px-1",children:ee.imageHistory.map((O,J)=>h.jsx("div",{onClick:()=>le(fe=>fe?{...fe,imageUrl:O}:null),className:`relative w-16 h-9 shrink-0 rounded overflow-hidden cursor-pointer border transition-all ${ee.imageUrl===O?"border-pink-500 opacity-100":"border-slate-700 opacity-60 hover:opacity-100"}`,children:h.jsx("img",{src:O,alt:`Thumb History ${J}`,className:"w-full h-full object-cover"})},J))})]})]})]})]})}),h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-bolt text-yellow-400"}),"    "]}),h.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"        50 ."}),U.length>0&&h.jsxs("p",{className:"text-green-400 text-sm font-bold mt-2",children:[h.jsx("i",{className:"fas fa-check-circle mr-1"})," ",U.length," "]})]}),h.jsxs("div",{className:"flex gap-2",children:[I.length>0&&h.jsxs(h.Fragment,{children:[h.jsxs("button",{onClick:jm,disabled:U.length===0,className:`px-4 py-3 rounded-full font-bold shadow-lg transition-all flex items-center gap-2 ${U.length>0?"bg-green-600 hover:bg-green-500 text-white":"bg-slate-700 text-slate-500 cursor-not-allowed"}`,children:[h.jsx("i",{className:"fas fa-file-download"}),"  "]}),h.jsx("button",{onClick:()=>{window.confirm("    ?")&&(N([]),X([]))},className:"bg-slate-700 hover:bg-slate-600 text-slate-300 px-4 py-3 rounded-full font-bold shadow-lg transition-all",children:h.jsx("i",{className:"fas fa-trash-alt"})})]}),h.jsxs("button",{onClick:zm,disabled:W,className:"bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white px-6 py-3 rounded-full font-bold shadow-lg flex items-center gap-2 transition-all",children:[W?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-list-ol"}),"   50 "]})]})]}),I.length>0&&h.jsx("div",{className:"bg-slate-900 rounded-xl p-6 border border-slate-700 max-h-[500px] overflow-y-auto",children:h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:I.map((O,J)=>{const fe=U.includes(O);return h.jsxs("div",{className:`p-3 rounded-lg border transition-all flex justify-between items-center group relative ${fe?"bg-green-900/30 border-green-500":"bg-slate-800 border-slate-700 hover:border-yellow-500 hover:bg-slate-700"}`,children:[h.jsxs("div",{className:"flex items-center gap-3 overflow-hidden flex-1 mr-2 cursor-pointer",onClick:()=>$m(O),children:[h.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center shrink-0 transition-colors ${fe?"bg-green-500 border-green-500":"border-slate-500 bg-transparent"}`,children:fe&&h.jsx("i",{className:"fas fa-check text-white text-xs"})}),h.jsx("span",{className:`font-medium break-all whitespace-normal ${fe?"text-green-200":"text-slate-200"}`,children:O})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsxs("button",{onClick:Q=>{Q.stopPropagation(),confirm(`"${O}"
   ?`)&&Ve(O)},className:"bg-purple-600 hover:bg-purple-500 text-white p-2 rounded z-10 text-xs flex items-center gap-1 shadow-lg",title:"   ",children:[h.jsx("i",{className:"fas fa-paint-brush"})," "]}),h.jsx("button",{onClick:Q=>{Q.stopPropagation(),Wm(O)},className:"text-slate-500 hover:text-white p-2 z-10",title:"",children:h.jsx("i",{className:"fas fa-copy"})})]})]},J)})})})]}),P&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/95 p-8 animate-fade-in backdrop-blur-sm",onClick:()=>k(null),children:h.jsxs("div",{className:"relative w-full max-w-7xl aspect-video mx-auto flex items-center justify-center bg-slate-950 border border-slate-700 rounded-xl shadow-2xl overflow-hidden ring-4 ring-slate-800/50",style:{containerType:"size"},onClick:O=>O.stopPropagation(),children:[h.jsx("img",{src:P,alt:"Preview",className:"w-full h-full object-contain"}),ee&&P===ee.imageUrl&&ee.textLines&&ee.textLines.map(O=>h.jsx("div",{className:"absolute select-none whitespace-pre-wrap leading-tight drop-shadow-[0_4px_4px_rgba(0,0,0,0.8)] pointer-events-none",style:{left:`${O.x}%`,top:`${O.y}%`,color:O.color,fontSize:`${O.size/10}cqw`,fontFamily:O.fontFamily||"sans-serif",fontWeight:O.fontWeight||"900",maxWidth:"95%",WebkitTextStroke:`${O.size/10*((O.outlineWidth??8)/100)*(O.heightScale&&O.heightScale>=1?O.heightScale:1)}cqw ${O.outlineColor||"#000"}`,textShadow:O.enableShadow?"0.1em 0.1em 0.1em rgba(0,0,0,0.8)":"none",paintOrder:"stroke fill",transform:`translate(0, -50%) scaleY(${O.heightScale||1})`,transformOrigin:"center center",letterSpacing:`${(O.letterSpacing||0)/10}cqw`},children:O.text},O.id)),h.jsx("button",{className:"absolute top-4 right-4 bg-black/50 hover:bg-black/80 text-white p-2 rounded-full transition-colors z-50",onClick:()=>k(null),children:h.jsx("i",{className:"fas fa-times text-xl"})})]})}),oe&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 animate-fade-in",children:h.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-700 shadow-2xl w-full max-w-lg max-h-[80vh] flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"p-4 border-b border-slate-700 flex justify-between items-center bg-slate-800",children:[h.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-font text-indigo-400"}),"  "]}),h.jsx("button",{onClick:()=>he(!1),className:"text-slate-400 hover:text-white",children:h.jsx("i",{className:"fas fa-times text-xl"})})]}),h.jsxs("div",{className:"p-4 bg-slate-850 space-y-3 border-b border-slate-700",children:[h.jsxs("button",{onClick:Bm,disabled:Ne,className:"w-full bg-slate-700 hover:bg-slate-600 text-white px-4 py-3 rounded-lg font-bold flex items-center justify-center gap-2 transition-colors border border-slate-600",children:[Ne?h.jsx("i",{className:"fas fa-spinner fa-spin"}):h.jsx("i",{className:"fas fa-laptop-code"}),"      "]}),h.jsx("p",{className:"text-xs text-slate-500 text-center",children:"* Chrome/Edge  ."}),h.jsxs("div",{className:"relative",children:[h.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),h.jsx("input",{type:"text",placeholder:"  ...",value:Be,onChange:O=>tn(O.target.value),className:"w-full bg-slate-800 text-white pl-10 pr-4 py-2 rounded-lg border border-slate-600 focus:border-indigo-500 outline-none"})]}),h.jsxs("div",{className:"pt-2 border-t border-slate-700",children:[h.jsxs("p",{className:"text-xs text-slate-400 mb-1",children:[h.jsx("i",{className:"fas fa-info-circle mr-1"}),"      ."]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"text",placeholder:": Yoon@ , ",value:Ze,onChange:O=>zt(O.target.value),onKeyDown:O=>O.key==="Enter"&&Ru(),className:"flex-1 bg-slate-800 text-white px-3 py-2 rounded-lg border border-slate-600 focus:border-indigo-500 outline-none text-sm"}),h.jsx("button",{onClick:Ru,disabled:!Ze.trim(),className:"bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-700 disabled:text-slate-500 text-white px-3 py-2 rounded-lg font-bold text-sm whitespace-nowrap",children:""})]})]})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:Oe.filter(O=>O.name.toLowerCase().includes(Be.toLowerCase())).sort((O,J)=>{const fe=Nt.includes(O.value),Q=Nt.includes(J.value);return fe&&!Q?-1:!fe&&Q?1:0}).map((O,J)=>{const fe=Nt.includes(O.value);return h.jsxs("div",{className:"flex gap-1 group",children:[h.jsx("button",{onClick:Q=>{Q.stopPropagation(),Hm(O.value)},className:`w-10 flex items-center justify-center rounded transition-colors ${fe?"text-yellow-400 hover:text-yellow-300":"text-slate-600 hover:text-slate-400"}`,title:fe?" ":" ",children:h.jsx("i",{className:`fas fa-star ${fe?"":"opacity-50 group-hover:opacity-100"}`})}),h.jsxs("button",{onClick:()=>{ie!==null&&le(Q=>{if(!Q||!Q.textLines)return Q;const j=[...Q.textLines];return j[ie]={...j[ie],fontFamily:O.value},{...Q,textLines:j}}),he(!1)},className:`flex-1 text-left px-4 py-3 rounded hover:bg-slate-800 text-white transition-colors flex justify-between items-center ${fe?"bg-slate-800/50 border border-slate-700":""}`,children:[h.jsx("span",{style:{fontFamily:O.value},className:"text-lg",children:O.name}),h.jsx("span",{className:"text-xs text-slate-500 group-hover:text-slate-300",children:""})]})]},J)})})]})})]})},a_=()=>{const{toast:t,closeToast:e}=Qt();if(!t)return null;const n={success:"bg-green-600",error:"bg-red-600",warning:"bg-yellow-600",info:"bg-blue-600"};return h.jsxs("div",{className:`fixed bottom-6 left-1/2 transform -translate-x-1/2 ${n[t.type]} text-white px-6 py-3 rounded-full shadow-2xl z-[100] flex items-center gap-3 animate-fade-in-up cursor-pointer`,onClick:e,children:[h.jsx("i",{className:`fas ${t.type==="success"?"fa-check-circle":t.type==="warning"?"fa-exclamation-triangle":t.type==="info"?"fa-info-circle":"fa-times-circle"}`}),h.jsx("span",{className:"font-medium",children:t.message})]})},l_=()=>{const{modalConfig:t,closeModal:e,showToast:n}=Qt(),[r,o]=ne.useState("");if(ne.useEffect(()=>{t&&o(t.defaultValue||"")},[t]),!t)return null;const i=()=>{t.onConfirm(r),e(),o("")},s=()=>{e(),o("")},a=async()=>{try{const u=typeof t.message=="string"?t.message:t.defaultValue||"";await navigator.clipboard.writeText(u),n(" .","success")}catch(u){console.error(u),n(" .","error")}};return h.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in",children:h.jsxs("div",{className:`bg-slate-800 border border-slate-600 rounded-xl shadow-2xl w-full p-6 relative ${t.type==="textarea"?"max-w-4xl":"max-w-lg"}`,children:[h.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:t.title}),h.jsx("div",{className:"text-slate-300 mb-4 whitespace-pre-wrap leading-relaxed text-sm max-h-[60vh] overflow-y-auto custom-scrollbar",children:t.message}),t.type==="prompt"&&h.jsx("input",{autoFocus:!0,type:"text",className:"w-full bg-slate-900 border border-slate-700 rounded p-3 text-white mb-6 focus:ring-2 focus:ring-indigo-500 placeholder-slate-500",placeholder:" ",value:r,onChange:u=>o(u.target.value),onKeyDown:u=>{u.key==="Enter"&&i()}}),t.type==="textarea"&&h.jsx("textarea",{autoFocus:!0,className:"w-full h-[60vh] bg-slate-900 border border-slate-700 rounded p-4 text-white mb-6 focus:ring-2 focus:ring-indigo-500 placeholder-slate-500 text-sm leading-relaxed custom-scrollbar font-mono",placeholder:"  ",value:r,onChange:u=>o(u.target.value)}),h.jsxs("div",{className:"flex justify-end gap-3 items-center",children:[t.showCopyButton&&h.jsxs("button",{onClick:a,className:"mr-auto px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-indigo-300 font-bold transition-colors border border-slate-600 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-copy"})," "]}),h.jsx("button",{onClick:s,className:"px-4 py-2 rounded-lg text-slate-300 hover:bg-slate-700 font-medium transition-colors",children:t.cancelText||""}),h.jsx("button",{onClick:i,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded-lg font-bold transition-all shadow-lg hover:shadow-indigo-500/30",children:t.confirmText||""})]})]})})},u_=({onOpenApiKey:t})=>{const{apiKey:e}=Qt();return h.jsxs("header",{className:"bg-slate-900 border-b border-slate-700 p-4 flex items-center justify-between sticky top-0 z-50 shadow-md",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center text-white text-xl font-bold shadow-lg",children:""}),h.jsxs("h1",{className:"text-2xl font-bold text-white tracking-wide",children:["  ",h.jsx("span",{className:"text-xs text-slate-500 font-normal ml-2",children:"Ver 2.0 (Joseon Ed.)"})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[e&&h.jsxs("div",{className:"hidden md:flex items-center gap-2 bg-slate-800 px-3 py-1.5 rounded-full border border-slate-600 mr-2",children:[h.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500 animate-pulse"}),h.jsx("span",{className:"text-xs text-slate-300 font-medium",children:""})]}),h.jsxs("button",{onClick:t,className:"bg-slate-800 hover:bg-slate-700 text-slate-200 px-4 py-2 rounded-lg border border-slate-600 flex items-center gap-2 transition-all text-sm font-medium",children:[h.jsx("i",{className:`fas fa-key ${e?"text-green-500":"text-yellow-500"}`}),e?"API  ":"API  "]})]})]})},pa=({active:t,label:e,icon:n,onClick:r,disabled:o})=>h.jsxs("button",{onClick:r,disabled:o,className:`flex-1 py-4 text-lg font-bold flex items-center justify-center gap-3 transition-all ${t?"bg-indigo-600 text-white shadow-inner border-b-4 border-indigo-800":"bg-slate-800 text-slate-400 hover:bg-slate-700 hover:text-white border-b-4 border-slate-900"} ${o?"opacity-50 cursor-not-allowed":""}`,children:[h.jsx("i",{className:`fas ${n} text-xl`}),e]}),c_=({isOpen:t,onClose:e})=>{const{apiKey:n,setApiKey:r,showToast:o}=Qt(),[i,s]=ne.useState(n);return t?h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[150] flex items-center justify-center p-4 animate-fade-in",children:h.jsxs("div",{className:"bg-slate-800 w-full max-w-md p-8 rounded-2xl border border-slate-600 shadow-2xl relative",children:[h.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-slate-400 hover:text-white",children:h.jsx("i",{className:"fas fa-times text-xl"})}),h.jsxs("h3",{className:"text-2xl font-bold text-white mb-4 flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-key text-yellow-500"})," API  "]}),h.jsx("p",{className:"text-slate-300 mb-6 text-sm",children:"Google AI Studio  Gemini API Key ."}),h.jsx("input",{type:"password",value:i,onChange:a=>s(a.target.value),placeholder:"AIzaSy...",className:"w-full bg-slate-900 border border-slate-700 rounded-lg p-4 text-white focus:ring-2 focus:ring-indigo-500 mb-6 font-mono"}),h.jsx("button",{onClick:()=>{i?(r(i),e(),o(".","success")):o(" .","warning")},className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg",children:"  "}),h.jsx("div",{className:"mt-6 pt-4 border-t border-slate-700 text-center",children:h.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noreferrer",className:"text-indigo-400 text-sm",children:"API  "})})]})}):null},d_=()=>{const{characters:t,props:e,referenceImages:n,showToast:r}=Qt(),[o,i]=ne.useState(!1),[s,a]=ne.useState("char"),u=Of.useMemo(()=>{const c=new Map;return n.forEach(f=>{c.set(f.name,{id:f.id,name:f.name,description:f.description,imageUrl:f.imageUrl,isRef:!0})}),t.forEach(f=>{c.has(f.name)||c.set(f.name,{id:f.id,name:f.name,description:f.description,imageUrl:null,isRef:!1})}),Array.from(c.values())},[t,n]);return h.jsxs("div",{className:`fixed right-0 top-32 bottom-0 z-[250] flex transition-transform duration-300 ${o?"translate-x-0":"translate-x-[320px]"}`,children:[h.jsx("button",{onClick:()=>i(!o),className:"h-14 w-8 bg-slate-800 border-l border-t border-b border-slate-600 rounded-l-lg flex items-center justify-center self-center shadow-lg hover:bg-slate-700 transition-colors",title:o?" ":" ",children:h.jsx("i",{className:`fas fa-chevron-${o?"right":"left"} text-slate-400`})}),h.jsxs("div",{className:"w-80 bg-slate-900 border-l border-slate-700 shadow-2xl p-4 flex flex-col h-full",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 shrink-0",children:[h.jsxs("button",{onClick:()=>a("char"),className:`flex-1 py-2 rounded text-xs font-bold ${s==="char"?"bg-indigo-600 text-white":"bg-slate-800 text-slate-400"}`,children:[h.jsx("i",{className:"fas fa-user mr-1"})," "]}),h.jsxs("button",{onClick:()=>a("prop"),className:`flex-1 py-2 rounded text-xs font-bold ${s==="prop"?"bg-amber-600 text-white":"bg-slate-800 text-slate-400"}`,children:[h.jsx("i",{className:"fas fa-cube mr-1"})," "]})]}),h.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar space-y-3",children:s==="char"?u.length===0?h.jsx("p",{className:"text-slate-500 text-center text-xs py-10",children:"  ."}):u.map(c=>h.jsxs("div",{className:"bg-slate-800 p-3 rounded border border-slate-700",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[c.imageUrl&&h.jsx("div",{className:"w-8 h-8 rounded bg-black overflow-hidden shrink-0",children:h.jsx("img",{src:c.imageUrl,alt:c.name,className:"w-full h-full object-cover"})}),h.jsx("span",{className:"text-white font-bold text-sm truncate",children:c.name})]}),h.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(c.description||""),r(`${c.name}  !`,"success")},className:"text-xs bg-slate-700 hover:bg-indigo-600 text-slate-300 hover:text-white px-2 py-1 rounded transition-colors shrink-0",children:[h.jsx("i",{className:"fas fa-copy mr-1"})," "]})]}),h.jsx("p",{className:"text-xs text-slate-400 line-clamp-3 leading-relaxed bg-slate-900 p-2 rounded",children:c.description||" "})]},c.id)):e.length===0?h.jsx("p",{className:"text-slate-500 text-center text-xs py-10",children:"  ."}):e.map(c=>h.jsxs("div",{className:"bg-slate-800 p-3 rounded border border-slate-700",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-8 h-8 rounded bg-black overflow-hidden shrink-0",children:h.jsx("img",{src:c.imageUrl,alt:c.name,className:"w-full h-full object-cover"})}),h.jsx("span",{className:"text-white font-bold text-sm",children:c.name})]}),h.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(c.description||""),r(`${c.name}  !`,"success")},className:"text-xs bg-slate-700 hover:bg-amber-600 text-slate-300 hover:text-white px-2 py-1 rounded transition-colors",children:[h.jsx("i",{className:"fas fa-copy mr-1"})," "]})]}),h.jsx("p",{className:"text-xs text-slate-400 line-clamp-3 leading-relaxed bg-slate-900 p-2 rounded",children:c.description||" "})]},c.id))})]})]})},f_=()=>{const{apiKey:t,script:e,scriptSegments:n,scenes:r,characters:o,setScenes:i,setCharacters:s,isContinuityMode:a,showToast:u,resetProject:c,openModal:f}=Qt(),[m,p]=ne.useState("script"),[g,E]=ne.useState(!1),[v,T]=ne.useState(!1),[y,x]=ne.useState(30),[w,_]=ne.useState(!1),b=async R=>{if(!t)return E(!0);if(!e.trim()&&n.length===0)return u(" !","warning");const F=R;if(F<1)return u("  1  .","warning");T(!0);try{let D=e,V=e;a?n.length>0&&(D=n[n.length-1].content,u(`  :  (${n[n.length-1].title})   .`,"success")):u("  :     .","success"),u(`1/2: (Scene)   ... (:  ${F})`,"success");const K=a?r:[],A=await zC(t,D,K,F,o),C=(a?A.slice(K.length):A).map((L,Z)=>({...L,id:`scene-${Date.now()}-${Z}`}));u("2/2:     ...","success");const ue=await $C(t,V,C,a?o:[]);let $=[...ue];if(a){const L=new Set(o.map(G=>G.name)),Z=[...o];ue.forEach(G=>{Z.some(B=>B.name===G.name)||Z.push(G)}),$=Z}const Y=C.map(L=>{const Z=L.characterNames||[],G=$.filter(B=>Z.some(me=>me.includes(B.name)||B.name.includes(me))).map(B=>B.id);return{...L,casting:{mainIds:G,subIds:[],propIds:[]}}});a?(i(Y),s(L=>{const Z=[...L];return ue.forEach(G=>{const B=Z.findIndex(me=>me.name===G.name);B===-1?Z.push(G):Z[B]={...Z[B],description:G.description,visualGuide:G.visualGuide,age:G.age,gender:G.gender}}),Z})):(i(Y),s(ue)),p("sintong"),u(` !  ${Y.length} .`,"success")}catch(D){u(D.message,"error")}finally{T(!1)}},M=()=>{f({type:"confirm",title:" ",message:`     ?
    .`,confirmText:"",cancelText:"",onConfirm:()=>c()})};return h.jsxs("div",{className:"min-h-screen bg-[#0f172a] text-slate-200 font-sans selection:bg-indigo-500 selection:text-white pb-20",children:[h.jsx(u_,{onOpenApiKey:()=>E(!0)}),h.jsxs("div",{className:"flex border-b border-slate-700 sticky top-[72px] z-40 bg-[#0f172a]",children:[h.jsx(pa,{active:m==="script",onClick:()=>p("script"),label:"1. /",icon:"fa-file-alt"}),h.jsx(pa,{active:m==="opening",onClick:()=>p("opening"),label:"2.  ()",icon:"fa-film"}),h.jsx(pa,{active:m==="sintong",onClick:()=>p("sintong"),label:"3.  ( )",icon:"fa-layer-group"})]}),h.jsxs("main",{className:"max-w-6xl mx-auto p-6 min-h-[calc(100vh-140px)]",children:[m==="script"&&h.jsx(r_,{onAnalyze:b,isAnalyzing:v}),m==="opening"&&h.jsx(s_,{}),m==="sintong"&&h.jsx(i_,{onNext:()=>{},isNextLoading:!1})]}),h.jsx(d_,{}),h.jsx("div",{className:"fixed bottom-6 right-6 z-40",children:h.jsxs("button",{onClick:M,className:"bg-red-900/80 hover:bg-red-900 text-red-200 px-4 py-2 rounded-full text-xs border border-red-700 backdrop-blur",children:[h.jsx("i",{className:"fas fa-trash mr-1"}),"  "]})}),h.jsx(l_,{}),h.jsx(a_,{}),h.jsx(c_,{isOpen:g,onClose:()=>E(!1)})]})},h_=()=>h.jsx(Iy,{children:h.jsx(f_,{})}),Fm=document.getElementById("root");if(!Fm)throw new Error("Could not find root element to mount to");const p_=ma.createRoot(Fm);p_.render(h.jsx(Of.StrictMode,{children:h.jsx(h_,{})}));
