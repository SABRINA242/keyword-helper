<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´í…Œê³ ë¦¬ë³„ RSS í‚¤ì›Œë“œ ë„ìš°ë¯¸</title>
    <style>
        /* style.css íŒŒì¼ì˜ ë‚´ìš© ì‹œì‘ */
        body {
            font-family: sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5; /* ì•½ê°„ ë‹¤ë¥¸ ë°°ê²½ìƒ‰ */
            color: #333;
        }
        .container {
            max-width: 950px; /* ë„ˆë¹„ ì•½ê°„ ì¦ê°€ */
            margin: auto;
            background: #fff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #1a73e8; /* í¬ì¸íŠ¸ ìƒ‰ìƒ ë³€ê²½ */
            margin-bottom: 30px;
            font-size: 2em;
        }
        .controls {
            margin-bottom: 25px;
            padding: 20px;
            background-color: #e9ecef; /* ì»¨íŠ¸ë¡¤ ì˜ì—­ ë°°ê²½ìƒ‰ */
            border-radius: 6px;
            text-align: center;
            border: 1px solid #dee2e6;
        }
        .controls label {
            font-weight: bold;
            margin-right: 8px;
        }
        .controls input[type="url"] {
            width: 380px;
            padding: 10px;
            margin-right: 12px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 0.95em;
        }
        .controls button {
            display: inline-block;
            padding: 10px 22px;
            background-color: #1a73e8; /* ë²„íŠ¼ ìƒ‰ìƒ í†µì¼ */
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 0;
            font-size: 1em;
            transition: background-color 0.2s ease;
        }
        .controls button:hover {
            background-color: #1558b0; /* í˜¸ë²„ ìƒ‰ìƒ */
        }

        #results {
            margin-top: 25px;
        }
        .category-section {
            background-color: #ffffff; /* ì„¹ì…˜ ë°°ê²½ìƒ‰ */
            border: 1px solid #e0e0e0; /* í…Œë‘ë¦¬ ìƒ‰ìƒ ë³€ê²½ */
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 6px;
        }
        .category-header { /* ì œëª©ê³¼ ì„¤ëª… ë¬¶ìŒ */
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            border-bottom: 2px solid #1a73e8;
            padding-bottom: 8px;
        }
        .category-title {
            font-size: 1.6em;
            font-weight: bold;
            color: #1a73e8;
        }
        .rss-url { display: none; }

        .section-content { /* ì œëª© ë¦¬ìŠ¤íŠ¸ì™€ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ë¥¼ ë‹´ì„ ì»¨í…Œì´ë„ˆ */
            display: flex; /* ê°€ë¡œ ì •ë ¬ */
            gap: 20px; /* ì‚¬ì´ ê°„ê²© */
        }

        .titles-area, .keywords-area {
            flex: 1; /* ê³µê°„ì„ ë°˜ë°˜ì”© ì°¨ì§€ */
            padding: 10px;
            border: 1px dashed #ced4da;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        .titles-area h4, .keywords-area h4 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #333;
            /* --- ìˆ˜ì •ëœ ë¶€ë¶„ --- */
            font-size: 1.2em; /* ê¸°ì¡´ 1.1emì—ì„œ ì•½ê°„ í¬ê²Œ */
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        
        .rss-data-container {
            max-height: 220px;
            overflow-y: auto;
            min-height: 30px;
        }
        .rss-data-container ul, .keywords-list ul {
            list-style-type: none;
            padding: 0; margin: 0;
        }
        .rss-data-container li {
            padding: 7px 4px;
            border-bottom: 1px dotted #e0e0e0;
        }
        .rss-data-container li:last-child { border-bottom: none; }
        .rss-data-container li a {
            text-decoration: none;
            color: #212529;
            font-size: 0.9em;
        }
        .rss-data-container li a:hover {
            text-decoration: underline;
            color: #007bff;
        }

        .keywords-list {
             max-height: 220px; /* ì œëª© ëª©ë¡ê³¼ ë†’ì´ ë§ì¶¤ */
             overflow-y: auto;
        }
        .keywords-list li {
            background-color: #e9f5ff; /* í‚¤ì›Œë“œ ë°°ê²½ìƒ‰ */
            /* --- ìˆ˜ì •ëœ ë¶€ë¶„ --- */
            padding: 8px 14px;     /* ê¸°ì¡´ 6px 10px ì—ì„œ ì•½ê°„ í¬ê²Œ */
            margin-bottom: 8px;    /* ê¸°ì¡´ 6px ì—ì„œ ì•½ê°„ í¬ê²Œ */
            font-size: 0.95em;     /* ê¸°ì¡´ 0.85em ì—ì„œ ì•½ê°„ í¬ê²Œ */
            /* --- ì•„ë˜ëŠ” ê¸°ì¡´ê³¼ ë™ì¼ --- */
            border-radius: 18px; /* ë‘¥ê·¼ ì•Œì•½ ëª¨ì–‘, ì¡°ê¸ˆ ë” ë‘¥ê¸€ê²Œ */
            color: #0056b3;
            cursor: pointer; 
            transition: background-color 0.2s ease;
            display: inline-block; 
            margin-right: 8px;     /* ê¸°ì¡´ 6px ì—ì„œ ì•½ê°„ í¬ê²Œ */
        }
        .keywords-list li:hover {
            background-color: #cce7ff; /* í˜¸ë²„ ì‹œ ë°°ê²½ìƒ‰ */
        }
        .keywords-list .keyword-count {
            /* --- ìˆ˜ì •ëœ ë¶€ë¶„ --- */
            font-size: 0.9em;      /* ê¸°ì¡´ 0.8em ì—ì„œ ì•½ê°„ í¬ê²Œ (liì˜ font-size ê¸°ì¤€) */
            /* --- ì•„ë˜ëŠ” ê¸°ì¡´ê³¼ ë™ì¼ --- */
            color: #555;
            margin-left: 2px; /* í‚¤ì›Œë“œì™€ ê°„ê²© */
        }
        .keyword-rationale { /* í‚¤ì›Œë“œ ì„ ì • ì´ìœ  ì„¤ëª… */
            /* --- ìˆ˜ì •ëœ ë¶€ë¶„ --- */
            font-size: 0.9em;      /* ê¸°ì¡´ 0.8em ì—ì„œ ì•½ê°„ í¬ê²Œ */
            /* --- ì•„ë˜ëŠ” ê¸°ì¡´ê³¼ ë™ì¼ --- */
            color: #6c757d;
            margin-top: 10px;      /* ê¸°ì¡´ 8px ì—ì„œ ì•½ê°„ í¬ê²Œ */
            text-align: right;
        }

        .loading-message, .error-message, .no-data-message {
            padding: 12px;
            text-align: center;
            color: #6c757d; /* ë©”ì‹œì§€ ìƒ‰ìƒ ë³€ê²½ */
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ì¹´í…Œê³ ë¦¬ë³„ ìµœì‹  ì •ë³´ & í‚¤ì›Œë“œ ë„ìš°ë¯¸</h1>

        <div class="controls">
            <label for="corsProxyInput">CORS í”„ë¡ì‹œ URL:</label>
            <input type="url" id="corsProxyInput" value="https://api.allorigins.win/raw?url=">
            <button id="fetchAllButton">ëª¨ë“  ì •ë³´ ì—…ë°ì´íŠ¸</button>
        </div>

        <div id="results" class="results">
            <div id="travelSection" class="category-section">
                <div class="category-header">
                    <div class="category-title">ğŸ–ï¸ ì—¬í–‰ ì •ë³´</div>
                </div>
                <div class="rss-url">https://www.google.com/alerts/feeds/17606266067575828344/4177095888204012688</div>
                <div class="section-content">
                    <div class="titles-area">
                        <h4>ìµœì‹  ì†Œì‹ ì œëª©</h4>
                        <div id="travelData" class="rss-data-container"><div class="loading-message">ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì„¸ìš”.</div></div>
                    </div>
                    <div class="keywords-area">
                        <h4>ì£¼ìš” í‚¤ì›Œë“œ</h4>
                        <div id="travelKeywords" class="keywords-list"></div>
                        <div class="keyword-rationale">ì œëª© ë¹ˆë„ìˆ˜ ê¸°ë°˜ ì¶”ì¶œ</div>
                    </div>
                </div>
            </div>
            
            <div id="festivalSection" class="category-section">
                <div class="category-header">
                     <div class="category-title">ğŸª ì¶•ì œ</div>  </div>
                <div class="rss-url">https://www.google.co.kr/alerts/feeds/17606266067575828344/2724755524646139218</div> <div class="section-content">
                    <div class="titles-area">
                        <h4>ìµœì‹  ì†Œì‹ ì œëª©</h4>
                        <div id="festivalData" class="rss-data-container"><div class="loading-message">ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì„¸ìš”.</div></div>
                    </div>
                    <div class="keywords-area">
                        <h4>ì£¼ìš” í‚¤ì›Œë“œ</h4>
                        <div id="festivalKeywords" class="keywords-list"></div>
                         <div class="keyword-rationale">ì œëª© ë¹ˆë„ìˆ˜ ê¸°ë°˜ ì¶”ì¶œ</div>
                    </div>
                </div>
            </div>
            
            <div id="ticketSection" class="category-section">
                <div class="category-header">
                   <div class="category-title">ğŸ« ì¢…í•© ì˜ˆë§¤ ì •ë³´</div>  </div>
               <div class="rss-url">https://www.google.co.kr/alerts/feeds/17606266067575828344/5566450803298381407</div> <div class="section-content">
                   <div class="titles-area">
                       <h4>ìµœì‹  ì†Œì‹ ì œëª©</h4>
                       <div id="ticketData" class="rss-data-container"><div class="loading-message">ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì„¸ìš”.</div></div>
                   </div>
                   <div class="keywords-area">
                       <h4>ì£¼ìš” í‚¤ì›Œë“œ</h4>
                       <div id="ticketKeywords" class="keywords-list"></div>
                        <div class="keyword-rationale">ì œëª© ë¹ˆë„ìˆ˜ ê¸°ë°˜ ì¶”ì¶œ</div>
                   </div>
               </div>
           </div>
            
            <div id="restaurantSection" class="category-section">
                <div class="category-header">
                    <div class="category-title">ğŸ½ï¸ ë§›ì§‘ ì •ë³´</div>
                </div>
                <div class="rss-url">https://www.google.com/alerts/feeds/17606266067575828344/17230442263613006018</div>
                <div class="section-content">
                    <div class="titles-area">
                        <h4>ìµœì‹  ì†Œì‹ ì œëª©</h4>
                        <div id="restaurantData" class="rss-data-container"><div class="loading-message">ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì„¸ìš”.</div></div>
                    </div>
                    <div class="keywords-area">
                        <h4>ì£¼ìš” í‚¤ì›Œë“œ</h4>
                        <div id="restaurantKeywords" class="keywords-list"></div>
                         <div class="keyword-rationale">ì œëª© ë¹ˆë„ìˆ˜ ê¸°ë°˜ ì¶”ì¶œ</div>
                    </div>
                </div>
            </div>
            
            <div id="welfareSection" class="category-section">
                 <div class="category-header">
                    <div class="category-title">ğŸ’° ë³µì§€ ì •ë³´</div>
                </div>
                <div class="rss-url">https://www.google.com/alerts/feeds/17606266067575828344/4177095888204010041</div>
                 <div class="section-content">
                    <div class="titles-area">
                        <h4>ìµœì‹  ì†Œì‹ ì œëª©</h4>
                        <div id="welfareData" class="rss-data-container"><div class="loading-message">ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ì„¸ìš”.</div></div>
                    </div>
                    <div class="keywords-area">
                        <h4>ì£¼ìš” í‚¤ì›Œë“œ</h4>
                        <div id="welfareKeywords" class="keywords-list"></div>
                         <div class="keyword-rationale">ì œëª© ë¹ˆë„ìˆ˜ ê¸°ë°˜ ì¶”ì¶œ</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const corsProxyInput = document.getElementById('corsProxyInput');
        const fetchAllButton = document.getElementById('fetchAllButton');

        fetchAllButton.addEventListener('click', () => {
            const sections = document.querySelectorAll('.category-section');
            const corsProxy = corsProxyInput.value.trim();

            if (!corsProxy.includes('?url=')) {
                alert('CORS í”„ë¡ì‹œ URL í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. ì£¼ì†Œì— "?url="ì´ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            
            sections.forEach(section => {
                const rssUrlDiv = section.querySelector('.rss-url');
                const targetDataContainer = section.querySelector('.rss-data-container'); // ì œëª© í‘œì‹œë  ê³³
                const targetKeywordsContainer = section.querySelector('.keywords-list'); // í‚¤ì›Œë“œ í‘œì‹œë  ê³³
                
                if (rssUrlDiv && targetDataContainer && targetKeywordsContainer) {
                    const rssUrl = rssUrlDiv.textContent.trim();
                    // ê° ì„¹ì…˜ì˜ ì œëª©ê³¼ í‚¤ì›Œë“œë¥¼ ê°€ì ¸ì™€ì„œ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œ
                    fetchDisplayTitlesAndKeywords(rssUrl, targetDataContainer, targetKeywordsContainer, corsProxy, section.id);
                }
            });
        });

        async function fetchDisplayTitlesAndKeywords(rssUrl, titlesElement, keywordsElement, corsProxy, sectionId) {
            titlesElement.innerHTML = '<div class="loading-message">ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>';
            keywordsElement.innerHTML = ''; // ì´ì „ í‚¤ì›Œë“œ ì´ˆê¸°í™”

            let sectionSpecificTitlesText = ""; // ì´ ì„¹ì…˜ì˜ ì œëª©ë“¤ë§Œ ëª¨ì„ ë³€ìˆ˜

            try {
                const response = await fetch(corsProxy + encodeURIComponent(rssUrl));
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} for ${rssUrl}`);
                }
                const str = await response.text();
                const data = new window.DOMParser().parseFromString(str, "text/xml");

                let items = data.querySelectorAll("item");
                if (items.length === 0 && data.querySelectorAll("entry").length > 0) {
                    items = data.querySelectorAll("entry");
                }

                if (items.length === 0) {
                    titlesElement.innerHTML = '<div class="no-data-message">í‘œì‹œí•  ë‚´ìš©ì´ ì—†ê±°ë‚˜ í”¼ë“œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
                    keywordsElement.innerHTML = '<div class="no-data-message">-</div>';
                    return;
                }

                let titlesHtml = '<ul>';
                items.forEach(item => {
                    const titleElement = item.querySelector("title");
                    const linkElement = item.querySelector("link");
                    const linkHref = linkElement ? (linkElement.getAttribute('href') || linkElement.textContent) : '#';

                    if (titleElement) {
                        const title = titleElement.textContent;
                        titlesHtml += `<li><a href="${linkHref}" target="_blank" rel="noopener noreferrer">${title}</a></li>`;
                        sectionSpecificTitlesText += title + " "; // ì´ ì„¹ì…˜ì˜ ì œëª©ë§Œ ì¶”ê°€
                    }
                });
                titlesHtml += '</ul>';
                titlesElement.innerHTML = titlesHtml;

                // ì´ ì„¹ì…˜ì˜ ì œëª©ë“¤ë¡œ í‚¤ì›Œë“œ ì¶”ì¶œ
                if (sectionSpecificTitlesText.trim()) {
                    const keywords = extractKeywordsFromText(sectionSpecificTitlesText, 7); // ì„¹ì…˜ë³„ 7ê°œ í‚¤ì›Œë“œ
                    if (keywords.length > 0) {
                        let keywordsHtmlList = '<ul>';
                        keywords.forEach(kw => {
                            // ë‚˜ì¤‘ì— í‚¤ì›Œë“œ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ìœ„í•´ data-keyword ì†ì„± ì¶”ê°€ ê³ ë ¤
                            keywordsHtmlList += `<li data-keyword="${kw.keyword.replace(/"/g, '&quot;')}">${kw.keyword} <span class="keyword-count">(${kw.count})</span></li>`;
                        });
                        keywordsHtmlList += '</ul>';
                        keywordsElement.innerHTML = keywordsHtmlList;
                    } else {
                        keywordsElement.innerHTML = '<div class="no-data-message">í‚¤ì›Œë“œ ì—†ìŒ</div>';
                    }
                } else {
                     keywordsElement.innerHTML = '<div class="no-data-message">í‚¤ì›Œë“œ ë¶„ì„ìš© ì œëª© ì—†ìŒ</div>';
                }


            } catch (error) {
                console.error(`Error fetching or parsing RSS feed for ${sectionId} (${rssUrl}):`, error);
                titlesElement.innerHTML = `<div class="error-message">ì˜¤ë¥˜: ${error.message}</div>`;
                keywordsElement.innerHTML = `<div class="error-message">ì˜¤ë¥˜</div>`;
            }
        }

        // --- í‚¤ì›Œë“œ ì¶”ì¶œ í•¨ìˆ˜ (extractKeywordsFromText) ---
        function extractKeywordsFromText(text, topN = 10) {
            const cleanedText = text.toLowerCase()
                .replace(/[!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/g, ' ') 
                .replace(/\s+/g, ' ') 
                .trim();
            let words = cleanedText.split(/\s+/);
            const stopwords = [ // ë¶ˆìš©ì–´ ëª©ë¡ (ê³„ì† ê°œì„  í•„ìš”)
                'ì´', 'ê°€', 'ì„', 'ë¥¼', 'ì€', 'ëŠ”', 'ì—', 'ì—ì„œ', 'ì—ê²Œ', 'ì˜', 'ê³¼', 'ì™€', 'ë„', 'ìœ¼ë¡œ', 'í•˜ë‹¤', 'ì´ë‹¤', 'ë˜ë‹¤', 'ê·¸', 'ì €', 'ê²ƒ', 'ìˆ˜', 'ë“±', 'ë°', 'ì œ', 'ë”',
                'ì…ë‹ˆë‹¤', 'ìŠµë‹ˆë‹¤', 'í•©ë‹ˆë‹¤', 'í•˜ëŠ”', 'í•˜ê³ ', 'í•œ', 'ìš”', 'ê·¸ë¦¬ê³ ', 'ê·¸ëŸ¬ë‚˜', 'í•˜ì§€ë§Œ', 'ê·¸ë˜ì„œ', 'ê·¸ëŸ¬ë¯€ë¡œ', 'ë˜ëŠ”', 'ë‹¤ë¥¸', 'ìœ„í•´', 'ìœ„í•œ', 'ì†', 'ì•', 'ë’¤',
                'ê·¸ê²ƒ', 'ì´ê²ƒ', 'ì €ê²ƒ', 'ì—¬ê¸°', 'ì €ê¸°', 'ê±°ê¸°', 'ë•Œë¬¸', 'ì •ë„', 'ê´€ë ¨', 'í†µí•´', 'ë°”ë¡œ', 'ì§€ê¸ˆ', 'í˜„ì¬', 'ì˜¤ëŠ˜', 'ë‚´ì¼', 'ì–´ì œ', 'ì˜¤ì „', 'ì˜¤í›„', 'ë§Œì—',
                'ë…„', 'ì›”', 'ì¼', 'ì‹œ', 'ë¶„', 'ì´ˆ', 'ë§¤ì¼', 'í•­ìƒ', 'ë³´í†µ', 'ìì£¼', 'ê°€ë”', 'ê±°ì˜', 'ë§¤ìš°', 'ì•„ì£¼', 'ë„ˆë¬´', 'ë”', 'ëœ', 'ê°€ì¥', 'ì¢€', 'ì˜', 'ëª»', 'ê¼­', 'ìˆ˜ë„',
                'ìš°ë¦¬', 'ë„ˆí¬', 'ê·¸ë“¤', 'ë‚˜', 'ë„ˆ', 'ê·¸ë…€', 'ë‰´ìŠ¤', 'ì†ë³´', 'í—¤ë“œë¼ì¸', 'ì¢…í•©', 'ì‚¬ì§„', 'ë‹¨ë…', 'íŠ¹ì§•', 'ê¸°ì', 'ì˜ìƒ', 'ì˜¤ëŠ˜ì˜', 'ë‚´ì¼ì˜', 'ë°œí‘œ', 'ê³µê°œ', 'ê²°ì •', 'ê³µì‹', 'ì•ˆë‚´',
                'a', 'an', 'the', 'is', 'are', 'be', 'and', 'of', 'to', 'in', 'it', 'for', 'on', 'with', 'as', 'by', 'new', 'news', 'update', ' KOR', 'kr', 'co', 'com',
                /^\d+$/, // ìˆ«ìë§Œ
                /^[a-zA-Z]{1,2}$/, // ì˜ì–´ 1~2ê¸€ì
                /^[ã„±-ã…ã…-ã…£ê°€-í£]{1}$/ // í•œê¸€ 1ê¸€ì
            ];
            const wordFrequencies = {};
            words.forEach(word => {
                if (word.length < 2) return; 
                let isStopword = false;
                for (const stop of stopwords) {
                    if (typeof stop === 'string' && word === stop) { isStopword = true; break; }
                    if (stop instanceof RegExp && stop.test(word)) { isStopword = true; break; }
                }
                if (!isStopword) { wordFrequencies[word] = (wordFrequencies[word] || 0) + 1; }
            });
            const sortedKeywords = Object.entries(wordFrequencies)
                .map(([keyword, count]) => ({ keyword, count }))
                .sort((a, b) => b.count - a.count);
            return sortedKeywords.slice(0, topN);
        }
    </script>
</body>
</html>